import{e as u,b as d,J as h,N as x,X as w,v as D,Z as _,a9 as C,A as M,p as y,a4 as P,ad as b,ac as I,G as R}from"./index-AM_KDpRB.js";var k=R("<video style=w-full src=testvid.webm controls>");const A={config:{supports_line_thickness:!1},sidePanel(){const{state:o,setState:n}=u(_),t=()=>o().modes.img_disp;return d(P,{collapsible:"Text to Tap",get children(){return[d(C,{}),(()=>{var e=k();return M(s=>{t().video_el=s,y(()=>{t().video_el===s&&(t().video_el=void 0)})},e),e})()]}})},dockPanel(){const{state:o,setState:n}=u(_),t=()=>o().modes.img_disp;let e;return d(I,{vertical:!0,get children(){return d(b,{get dr_tools_active(){return t().tool==="define_rect"},setDrToolsActive:s=>{if(s){const i=t().tool;i!=="define_rect"&&(e=i),t().tool="define_rect"}else t().tool=e;n()}})}})},render(o){const{state:n,imev:t,frame:e}=o,s=n.modes.img_disp;h(n,e,t,{enable_resize:s.tool==="define_rect"})},previewer(o){const n=o.modes.img_disp,t=x(o),e=[100,100];n.canvasel==null&&(n.canvasel=new OffscreenCanvas(e[0],e[1]));let s=[],i=[];if(n.video_el!=null){const p=[];for(let l=0;l<t.max_pts;l++){const c=t.ptCenter(l),a=w(o.define_rect,{grid:t},c);a[0]<0||a[1]<0||a[0]>1||a[1]>1||p.push({pos:a,index:l})}const m=n.canvasel.getContext("2d");m.drawImage(n.video_el,0,0,e[0],e[1]);const r=m.getImageData(0,0,e[0],e[1]);for(const{pos:l,index:c}of p){const a=D.mul(l,e),v=Math.max(0,Math.min(r.width,Math.round(a[0]))),g=(Math.max(0,Math.min(r.height,Math.round(a[1])))*r.width+v)*4,f=r.data[g+0];f!=null&&(f>128?s.push(c):i.push(c))}}return s.length<i.length?s:i}};export{A as default};
