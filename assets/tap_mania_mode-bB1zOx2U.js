import{t as Br,w as Ui,e as xn,b as yt,aU as Gi,y as Vi,J as ji,v as Wi,N as Mn,aF as Hi,Z as In,ad as Zi,ac as Yi,a5 as Tn,A as Xi,p as Ki,D as qi,ae as Qi,z as dr,F as Ln,b4 as Ji,V as Ci,a9 as $i,a4 as ea,G as jt}from"./index-AM_KDpRB.js";function xr(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Hn={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,r){(function(n){t.exports=n()})(function(){return function n(i,a,o){function l(v,S){if(!a[v]){if(!i[v]){var p=typeof xr=="function"&&xr;if(!S&&p)return p(v,!0);if(s)return s(v,!0);var E=new Error("Cannot find module '"+v+"'");throw E.code="MODULE_NOT_FOUND",E}var m=a[v]={exports:{}};i[v][0].call(m.exports,function(w){var h=i[v][1][w];return l(h||w)},m,m.exports,n,i,a,o)}return a[v].exports}for(var s=typeof xr=="function"&&xr,f=0;f<o.length;f++)l(o[f]);return l}({1:[function(n,i,a){var o=n("./utils"),l=n("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(f){for(var v,S,p,E,m,w,h,b=[],_=0,y=f.length,T=y,D=o.getTypeOf(f)!=="string";_<f.length;)T=y-_,p=D?(v=f[_++],S=_<y?f[_++]:0,_<y?f[_++]:0):(v=f.charCodeAt(_++),S=_<y?f.charCodeAt(_++):0,_<y?f.charCodeAt(_++):0),E=v>>2,m=(3&v)<<4|S>>4,w=1<T?(15&S)<<2|p>>6:64,h=2<T?63&p:64,b.push(s.charAt(E)+s.charAt(m)+s.charAt(w)+s.charAt(h));return b.join("")},a.decode=function(f){var v,S,p,E,m,w,h=0,b=0,_="data:";if(f.substr(0,_.length)===_)throw new Error("Invalid base64 input, it looks like a data url.");var y,T=3*(f=f.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(f.charAt(f.length-1)===s.charAt(64)&&T--,f.charAt(f.length-2)===s.charAt(64)&&T--,T%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=l.uint8array?new Uint8Array(0|T):new Array(0|T);h<f.length;)v=s.indexOf(f.charAt(h++))<<2|(E=s.indexOf(f.charAt(h++)))>>4,S=(15&E)<<4|(m=s.indexOf(f.charAt(h++)))>>2,p=(3&m)<<6|(w=s.indexOf(f.charAt(h++))),y[b++]=v,m!==64&&(y[b++]=S),w!==64&&(y[b++]=p);return y}},{"./support":30,"./utils":32}],2:[function(n,i,a){var o=n("./external"),l=n("./stream/DataWorker"),s=n("./stream/Crc32Probe"),f=n("./stream/DataLengthProbe");function v(S,p,E,m,w){this.compressedSize=S,this.uncompressedSize=p,this.crc32=E,this.compression=m,this.compressedContent=w}v.prototype={getContentWorker:function(){var S=new l(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new f("data_length")),p=this;return S.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),S},getCompressedWorker:function(){return new l(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},v.createWorkerFrom=function(S,p,E){return S.pipe(new s).pipe(new f("uncompressedSize")).pipe(p.compressWorker(E)).pipe(new f("compressedSize")).withStreamInfo("compression",p)},i.exports=v},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,i,a){var o=n("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},a.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,i,a){var o=n("./utils"),l=function(){for(var s,f=[],v=0;v<256;v++){s=v;for(var S=0;S<8;S++)s=1&s?3988292384^s>>>1:s>>>1;f[v]=s}return f}();i.exports=function(s,f){return s!==void 0&&s.length?o.getTypeOf(s)!=="string"?function(v,S,p,E){var m=l,w=E+p;v^=-1;for(var h=E;h<w;h++)v=v>>>8^m[255&(v^S[h])];return-1^v}(0|f,s,s.length,0):function(v,S,p,E){var m=l,w=E+p;v^=-1;for(var h=E;h<w;h++)v=v>>>8^m[255&(v^S.charCodeAt(h))];return-1^v}(0|f,s,s.length,0):0}},{"./utils":32}],5:[function(n,i,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(n,i,a){var o=null;o=typeof Promise<"u"?Promise:n("lie"),i.exports={Promise:o}},{lie:37}],7:[function(n,i,a){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=n("pako"),s=n("./utils"),f=n("./stream/GenericWorker"),v=o?"uint8array":"array";function S(p,E){f.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=E,this.meta={}}a.magic="\b\0",s.inherits(S,f),S.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(v,p.data),!1)},S.prototype.flush=function(){f.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},S.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this._pako=null},S.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(E){p.push({data:E,meta:p.meta})}},a.compressWorker=function(p){return new S("Deflate",p)},a.uncompressWorker=function(){return new S("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,i,a){function o(m,w){var h,b="";for(h=0;h<w;h++)b+=String.fromCharCode(255&m),m>>>=8;return b}function l(m,w,h,b,_,y){var T,D,A=m.file,H=m.compression,U=y!==v.utf8encode,K=s.transformTo("string",y(A.name)),R=s.transformTo("string",v.utf8encode(A.name)),Q=A.comment,ae=s.transformTo("string",y(Q)),M=s.transformTo("string",v.utf8encode(Q)),V=R.length!==A.name.length,d=M.length!==Q.length,W="",de="",q="",me=A.dir,C=A.date,he={crc32:0,compressedSize:0,uncompressedSize:0};w&&!h||(he.crc32=m.crc32,he.compressedSize=m.compressedSize,he.uncompressedSize=m.uncompressedSize);var z=0;w&&(z|=8),U||!V&&!d||(z|=2048);var O=0,ie=0;me&&(O|=16),_==="UNIX"?(ie=798,O|=function(ee,Re){var Ze=ee;return ee||(Ze=Re?16893:33204),(65535&Ze)<<16}(A.unixPermissions,me)):(ie=20,O|=function(ee){return 63&(ee||0)}(A.dosPermissions)),T=C.getUTCHours(),T<<=6,T|=C.getUTCMinutes(),T<<=5,T|=C.getUTCSeconds()/2,D=C.getUTCFullYear()-1980,D<<=4,D|=C.getUTCMonth()+1,D<<=5,D|=C.getUTCDate(),V&&(de=o(1,1)+o(S(K),4)+R,W+="up"+o(de.length,2)+de),d&&(q=o(1,1)+o(S(ae),4)+M,W+="uc"+o(q.length,2)+q);var te="";return te+=`
\0`,te+=o(z,2),te+=H.magic,te+=o(T,2),te+=o(D,2),te+=o(he.crc32,4),te+=o(he.compressedSize,4),te+=o(he.uncompressedSize,4),te+=o(K.length,2),te+=o(W.length,2),{fileRecord:p.LOCAL_FILE_HEADER+te+K+W,dirRecord:p.CENTRAL_FILE_HEADER+o(ie,2)+te+o(ae.length,2)+"\0\0\0\0"+o(O,4)+o(b,4)+K+W+ae}}var s=n("../utils"),f=n("../stream/GenericWorker"),v=n("../utf8"),S=n("../crc32"),p=n("../signature");function E(m,w,h,b){f.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=h,this.encodeFileName=b,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(E,f),E.prototype.push=function(m){var w=m.meta.percent||0,h=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,f.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:h?(w+100*(h-b-1))/h:100}}))},E.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var w=this.streamFiles&&!m.file.dir;if(w){var h=l(m,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:h.fileRecord,meta:{percent:0}})}else this.accumulate=!0},E.prototype.closedSource=function(m){this.accumulate=!1;var w=this.streamFiles&&!m.file.dir,h=l(m,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(h.dirRecord),w)this.push({data:function(b){return p.DATA_DESCRIPTOR+o(b.crc32,4)+o(b.compressedSize,4)+o(b.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:h.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},E.prototype.flush=function(){for(var m=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var h=this.bytesWritten-m,b=function(_,y,T,D,A){var H=s.transformTo("string",A(D));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(_,2)+o(_,2)+o(y,4)+o(T,4)+o(H.length,2)+H}(this.dirRecords.length,h,m,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},E.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},E.prototype.registerPrevious=function(m){this._sources.push(m);var w=this;return m.on("data",function(h){w.processChunk(h)}),m.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),m.on("error",function(h){w.error(h)}),this},E.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},E.prototype.error=function(m){var w=this._sources;if(!f.prototype.error.call(this,m))return!1;for(var h=0;h<w.length;h++)try{w[h].error(m)}catch{}return!0},E.prototype.lock=function(){f.prototype.lock.call(this);for(var m=this._sources,w=0;w<m.length;w++)m[w].lock()},i.exports=E},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,i,a){var o=n("../compressions"),l=n("./ZipFileWorker");a.generateWorker=function(s,f,v){var S=new l(f.streamFiles,v,f.platform,f.encodeFileName),p=0;try{s.forEach(function(E,m){p++;var w=function(y,T){var D=y||T,A=o[D];if(!A)throw new Error(D+" is not a valid compression method !");return A}(m.options.compression,f.compression),h=m.options.compressionOptions||f.compressionOptions||{},b=m.dir,_=m.date;m._compressWorker(w,h).withStreamInfo("file",{name:E,dir:b,date:_,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(S)}),S.entriesCount=p}catch(E){S.error(E)}return S}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,i,a){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new o;for(var s in this)typeof this[s]!="function"&&(l[s]=this[s]);return l}}(o.prototype=n("./object")).loadAsync=n("./load"),o.support=n("./support"),o.defaults=n("./defaults"),o.version="3.10.1",o.loadAsync=function(l,s){return new o().loadAsync(l,s)},o.external=n("./external"),i.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,i,a){var o=n("./utils"),l=n("./external"),s=n("./utf8"),f=n("./zipEntries"),v=n("./stream/Crc32Probe"),S=n("./nodejsUtils");function p(E){return new l.Promise(function(m,w){var h=E.decompressed.getContentWorker().pipe(new v);h.on("error",function(b){w(b)}).on("end",function(){h.streamInfo.crc32!==E.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}i.exports=function(E,m){var w=this;return m=o.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),S.isNode&&S.isStream(E)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",E,!0,m.optimizedBinaryString,m.base64).then(function(h){var b=new f(m);return b.load(h),b}).then(function(h){var b=[l.Promise.resolve(h)],_=h.files;if(m.checkCRC32)for(var y=0;y<_.length;y++)b.push(p(_[y]));return l.Promise.all(b)}).then(function(h){for(var b=h.shift(),_=b.files,y=0;y<_.length;y++){var T=_[y],D=T.fileNameStr,A=o.resolve(T.fileNameStr);w.file(A,T.decompressed,{binary:!0,optimizedBinaryString:!0,date:T.date,dir:T.dir,comment:T.fileCommentStr.length?T.fileCommentStr:null,unixPermissions:T.unixPermissions,dosPermissions:T.dosPermissions,createFolders:m.createFolders}),T.dir||(w.file(A).unsafeOriginalName=D)}return b.zipComment.length&&(w.comment=b.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,i,a){var o=n("../utils"),l=n("../stream/GenericWorker");function s(f,v){l.call(this,"Nodejs stream input adapter for "+f),this._upstreamEnded=!1,this._bindStream(v)}o.inherits(s,l),s.prototype._bindStream=function(f){var v=this;(this._stream=f).pause(),f.on("data",function(S){v.push({data:S,meta:{percent:0}})}).on("error",function(S){v.isPaused?this.generatedError=S:v.error(S)}).on("end",function(){v.isPaused?v._upstreamEnded=!0:v.end()})},s.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,i,a){var o=n("readable-stream").Readable;function l(s,f,v){o.call(this,f),this._helper=s;var S=this;s.on("data",function(p,E){S.push(p)||S._helper.pause(),v&&v(E)}).on("error",function(p){S.emit("error",p)}).on("end",function(){S.push(null)})}n("../utils").inherits(l,o),l.prototype._read=function(){this._helper.resume()},i.exports=l},{"../utils":32,"readable-stream":16}],14:[function(n,i,a){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,l);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,l)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var l=new Buffer(o);return l.fill(0),l},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(n,i,a){function o(A,H,U){var K,R=s.getTypeOf(H),Q=s.extend(U||{},S);Q.date=Q.date||new Date,Q.compression!==null&&(Q.compression=Q.compression.toUpperCase()),typeof Q.unixPermissions=="string"&&(Q.unixPermissions=parseInt(Q.unixPermissions,8)),Q.unixPermissions&&16384&Q.unixPermissions&&(Q.dir=!0),Q.dosPermissions&&16&Q.dosPermissions&&(Q.dir=!0),Q.dir&&(A=_(A)),Q.createFolders&&(K=b(A))&&y.call(this,K,!0);var ae=R==="string"&&Q.binary===!1&&Q.base64===!1;U&&U.binary!==void 0||(Q.binary=!ae),(H instanceof p&&H.uncompressedSize===0||Q.dir||!H||H.length===0)&&(Q.base64=!1,Q.binary=!0,H="",Q.compression="STORE",R="string");var M=null;M=H instanceof p||H instanceof f?H:w.isNode&&w.isStream(H)?new h(A,H):s.prepareContent(A,H,Q.binary,Q.optimizedBinaryString,Q.base64);var V=new E(A,M,Q);this.files[A]=V}var l=n("./utf8"),s=n("./utils"),f=n("./stream/GenericWorker"),v=n("./stream/StreamHelper"),S=n("./defaults"),p=n("./compressedObject"),E=n("./zipObject"),m=n("./generate"),w=n("./nodejsUtils"),h=n("./nodejs/NodejsStreamInputAdapter"),b=function(A){A.slice(-1)==="/"&&(A=A.substring(0,A.length-1));var H=A.lastIndexOf("/");return 0<H?A.substring(0,H):""},_=function(A){return A.slice(-1)!=="/"&&(A+="/"),A},y=function(A,H){return H=H!==void 0?H:S.createFolders,A=_(A),this.files[A]||o.call(this,A,null,{dir:!0,createFolders:H}),this.files[A]};function T(A){return Object.prototype.toString.call(A)==="[object RegExp]"}var D={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var H,U,K;for(H in this.files)K=this.files[H],(U=H.slice(this.root.length,H.length))&&H.slice(0,this.root.length)===this.root&&A(U,K)},filter:function(A){var H=[];return this.forEach(function(U,K){A(U,K)&&H.push(K)}),H},file:function(A,H,U){if(arguments.length!==1)return A=this.root+A,o.call(this,A,H,U),this;if(T(A)){var K=A;return this.filter(function(Q,ae){return!ae.dir&&K.test(Q)})}var R=this.files[this.root+A];return R&&!R.dir?R:null},folder:function(A){if(!A)return this;if(T(A))return this.filter(function(R,Q){return Q.dir&&A.test(R)});var H=this.root+A,U=y.call(this,H),K=this.clone();return K.root=U.name,K},remove:function(A){A=this.root+A;var H=this.files[A];if(H||(A.slice(-1)!=="/"&&(A+="/"),H=this.files[A]),H&&!H.dir)delete this.files[A];else for(var U=this.filter(function(R,Q){return Q.name.slice(0,A.length)===A}),K=0;K<U.length;K++)delete this.files[U[K].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var H,U={};try{if((U=s.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=U.type.toLowerCase(),U.compression=U.compression.toUpperCase(),U.type==="binarystring"&&(U.type="string"),!U.type)throw new Error("No output type specified.");s.checkSupport(U.type),U.platform!=="darwin"&&U.platform!=="freebsd"&&U.platform!=="linux"&&U.platform!=="sunos"||(U.platform="UNIX"),U.platform==="win32"&&(U.platform="DOS");var K=U.comment||this.comment||"";H=m.generateWorker(this,U,K)}catch(R){(H=new f("error")).error(R)}return new v(H,U.type||"string",U.mimeType)},generateAsync:function(A,H){return this.generateInternalStream(A).accumulate(H)},generateNodeStream:function(A,H){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(H)}};i.exports=D},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,i,a){i.exports=n("stream")},{stream:void 0}],17:[function(n,i,a){var o=n("./DataReader");function l(s){o.call(this,s);for(var f=0;f<this.data.length;f++)s[f]=255&s[f]}n("../utils").inherits(l,o),l.prototype.byteAt=function(s){return this.data[this.zero+s]},l.prototype.lastIndexOfSignature=function(s){for(var f=s.charCodeAt(0),v=s.charCodeAt(1),S=s.charCodeAt(2),p=s.charCodeAt(3),E=this.length-4;0<=E;--E)if(this.data[E]===f&&this.data[E+1]===v&&this.data[E+2]===S&&this.data[E+3]===p)return E-this.zero;return-1},l.prototype.readAndCheckSignature=function(s){var f=s.charCodeAt(0),v=s.charCodeAt(1),S=s.charCodeAt(2),p=s.charCodeAt(3),E=this.readData(4);return f===E[0]&&v===E[1]&&S===E[2]&&p===E[3]},l.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var f=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,f},i.exports=l},{"../utils":32,"./DataReader":18}],18:[function(n,i,a){var o=n("../utils");function l(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var f,v=0;for(this.checkOffset(s),f=this.index+s-1;f>=this.index;f--)v=(v<<8)+this.byteAt(f);return this.index+=s,v},readString:function(s){return o.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},i.exports=l},{"../utils":32}],19:[function(n,i,a){var o=n("./Uint8ArrayReader");function l(s){o.call(this,s)}n("../utils").inherits(l,o),l.prototype.readData=function(s){this.checkOffset(s);var f=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,f},i.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,i,a){var o=n("./DataReader");function l(s){o.call(this,s)}n("../utils").inherits(l,o),l.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},l.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},l.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},l.prototype.readData=function(s){this.checkOffset(s);var f=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,f},i.exports=l},{"../utils":32,"./DataReader":18}],21:[function(n,i,a){var o=n("./ArrayReader");function l(s){o.call(this,s)}n("../utils").inherits(l,o),l.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var f=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,f},i.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(n,i,a){var o=n("../utils"),l=n("../support"),s=n("./ArrayReader"),f=n("./StringReader"),v=n("./NodeBufferReader"),S=n("./Uint8ArrayReader");i.exports=function(p){var E=o.getTypeOf(p);return o.checkSupport(E),E!=="string"||l.uint8array?E==="nodebuffer"?new v(p):l.uint8array?new S(o.transformTo("uint8array",p)):new s(o.transformTo("array",p)):new f(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,i,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,i,a){var o=n("./GenericWorker"),l=n("../utils");function s(f){o.call(this,"ConvertWorker to "+f),this.destType=f}l.inherits(s,o),s.prototype.processChunk=function(f){this.push({data:l.transformTo(this.destType,f.data),meta:f.meta})},i.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(n,i,a){var o=n("./GenericWorker"),l=n("../crc32");function s(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(s,o),s.prototype.processChunk=function(f){this.streamInfo.crc32=l(f.data,this.streamInfo.crc32||0),this.push(f)},i.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,i,a){var o=n("../utils"),l=n("./GenericWorker");function s(f){l.call(this,"DataLengthProbe for "+f),this.propName=f,this.withStreamInfo(f,0)}o.inherits(s,l),s.prototype.processChunk=function(f){if(f){var v=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=v+f.data.length}l.prototype.processChunk.call(this,f)},i.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(n,i,a){var o=n("../utils"),l=n("./GenericWorker");function s(f){l.call(this,"DataWorker");var v=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,f.then(function(S){v.dataIsReady=!0,v.data=S,v.max=S&&S.length||0,v.type=o.getTypeOf(S),v.isPaused||v._tickAndRepeat()},function(S){v.error(S)})}o.inherits(s,l),s.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var f=null,v=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":f=this.data.substring(this.index,v);break;case"uint8array":f=this.data.subarray(this.index,v);break;case"array":case"nodebuffer":f=this.data.slice(this.index,v)}return this.index=v,this.push({data:f,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(n,i,a){function o(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,s){return this._listeners[l].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,s){if(this._listeners[l])for(var f=0;f<this._listeners[l].length;f++)this._listeners[l][f].call(this,s)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var s=this;return l.on("data",function(f){s.processChunk(f)}),l.on("end",function(){s.end()}),l.on("error",function(f){s.error(f)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,s){return this.extraStreamInfo[l]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},i.exports=o},{}],29:[function(n,i,a){var o=n("../utils"),l=n("./ConvertWorker"),s=n("./GenericWorker"),f=n("../base64"),v=n("../support"),S=n("../external"),p=null;if(v.nodestream)try{p=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function E(w,h){return new S.Promise(function(b,_){var y=[],T=w._internalType,D=w._outputType,A=w._mimeType;w.on("data",function(H,U){y.push(H),h&&h(U)}).on("error",function(H){y=[],_(H)}).on("end",function(){try{var H=function(U,K,R){switch(U){case"blob":return o.newBlob(o.transformTo("arraybuffer",K),R);case"base64":return f.encode(K);default:return o.transformTo(U,K)}}(D,function(U,K){var R,Q=0,ae=null,M=0;for(R=0;R<K.length;R++)M+=K[R].length;switch(U){case"string":return K.join("");case"array":return Array.prototype.concat.apply([],K);case"uint8array":for(ae=new Uint8Array(M),R=0;R<K.length;R++)ae.set(K[R],Q),Q+=K[R].length;return ae;case"nodebuffer":return Buffer.concat(K);default:throw new Error("concat : unsupported type '"+U+"'")}}(T,y),A);b(H)}catch(U){_(U)}y=[]}).resume()})}function m(w,h,b){var _=h;switch(h){case"blob":case"arraybuffer":_="uint8array";break;case"base64":_="string"}try{this._internalType=_,this._outputType=h,this._mimeType=b,o.checkSupport(_),this._worker=w.pipe(new l(_)),w.lock()}catch(y){this._worker=new s("error"),this._worker.error(y)}}m.prototype={accumulate:function(w){return E(this,w)},on:function(w,h){var b=this;return w==="data"?this._worker.on(w,function(_){h.call(b,_.data,_.meta)}):this._worker.on(w,function(){o.delay(h,arguments,b)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},w)}},i.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,i,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var o=new ArrayBuffer(0);try{a.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(o),a.blob=l.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!n("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(n,i,a){for(var o=n("./utils"),l=n("./support"),s=n("./nodejsUtils"),f=n("./stream/GenericWorker"),v=new Array(256),S=0;S<256;S++)v[S]=252<=S?6:248<=S?5:240<=S?4:224<=S?3:192<=S?2:1;v[254]=v[254]=1;function p(){f.call(this,"utf-8 decode"),this.leftOver=null}function E(){f.call(this,"utf-8 encode")}a.utf8encode=function(m){return l.nodebuffer?s.newBufferFrom(m,"utf-8"):function(w){var h,b,_,y,T,D=w.length,A=0;for(y=0;y<D;y++)(64512&(b=w.charCodeAt(y)))==55296&&y+1<D&&(64512&(_=w.charCodeAt(y+1)))==56320&&(b=65536+(b-55296<<10)+(_-56320),y++),A+=b<128?1:b<2048?2:b<65536?3:4;for(h=l.uint8array?new Uint8Array(A):new Array(A),y=T=0;T<A;y++)(64512&(b=w.charCodeAt(y)))==55296&&y+1<D&&(64512&(_=w.charCodeAt(y+1)))==56320&&(b=65536+(b-55296<<10)+(_-56320),y++),b<128?h[T++]=b:(b<2048?h[T++]=192|b>>>6:(b<65536?h[T++]=224|b>>>12:(h[T++]=240|b>>>18,h[T++]=128|b>>>12&63),h[T++]=128|b>>>6&63),h[T++]=128|63&b);return h}(m)},a.utf8decode=function(m){return l.nodebuffer?o.transformTo("nodebuffer",m).toString("utf-8"):function(w){var h,b,_,y,T=w.length,D=new Array(2*T);for(h=b=0;h<T;)if((_=w[h++])<128)D[b++]=_;else if(4<(y=v[_]))D[b++]=65533,h+=y-1;else{for(_&=y===2?31:y===3?15:7;1<y&&h<T;)_=_<<6|63&w[h++],y--;1<y?D[b++]=65533:_<65536?D[b++]=_:(_-=65536,D[b++]=55296|_>>10&1023,D[b++]=56320|1023&_)}return D.length!==b&&(D.subarray?D=D.subarray(0,b):D.length=b),o.applyFromCharCode(D)}(m=o.transformTo(l.uint8array?"uint8array":"array",m))},o.inherits(p,f),p.prototype.processChunk=function(m){var w=o.transformTo(l.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var h=w;(w=new Uint8Array(h.length+this.leftOver.length)).set(this.leftOver,0),w.set(h,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var b=function(y,T){var D;for((T=T||y.length)>y.length&&(T=y.length),D=T-1;0<=D&&(192&y[D])==128;)D--;return D<0||D===0?T:D+v[y[D]]>T?D:T}(w),_=w;b!==w.length&&(l.uint8array?(_=w.subarray(0,b),this.leftOver=w.subarray(b,w.length)):(_=w.slice(0,b),this.leftOver=w.slice(b,w.length))),this.push({data:a.utf8decode(_),meta:m.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=p,o.inherits(E,f),E.prototype.processChunk=function(m){this.push({data:a.utf8encode(m.data),meta:m.meta})},a.Utf8EncodeWorker=E},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,i,a){var o=n("./support"),l=n("./base64"),s=n("./nodejsUtils"),f=n("./external");function v(h){return h}function S(h,b){for(var _=0;_<h.length;++_)b[_]=255&h.charCodeAt(_);return b}n("setimmediate"),a.newBlob=function(h,b){a.checkSupport("blob");try{return new Blob([h],{type:b})}catch{try{var _=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return _.append(h),_.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(h,b,_){var y=[],T=0,D=h.length;if(D<=_)return String.fromCharCode.apply(null,h);for(;T<D;)b==="array"||b==="nodebuffer"?y.push(String.fromCharCode.apply(null,h.slice(T,Math.min(T+_,D)))):y.push(String.fromCharCode.apply(null,h.subarray(T,Math.min(T+_,D)))),T+=_;return y.join("")},stringifyByChar:function(h){for(var b="",_=0;_<h.length;_++)b+=String.fromCharCode(h[_]);return b},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function E(h){var b=65536,_=a.getTypeOf(h),y=!0;if(_==="uint8array"?y=p.applyCanBeUsed.uint8array:_==="nodebuffer"&&(y=p.applyCanBeUsed.nodebuffer),y)for(;1<b;)try{return p.stringifyByChunk(h,_,b)}catch{b=Math.floor(b/2)}return p.stringifyByChar(h)}function m(h,b){for(var _=0;_<h.length;_++)b[_]=h[_];return b}a.applyFromCharCode=E;var w={};w.string={string:v,array:function(h){return S(h,new Array(h.length))},arraybuffer:function(h){return w.string.uint8array(h).buffer},uint8array:function(h){return S(h,new Uint8Array(h.length))},nodebuffer:function(h){return S(h,s.allocBuffer(h.length))}},w.array={string:E,array:v,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return s.newBufferFrom(h)}},w.arraybuffer={string:function(h){return E(new Uint8Array(h))},array:function(h){return m(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:v,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return s.newBufferFrom(new Uint8Array(h))}},w.uint8array={string:E,array:function(h){return m(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:v,nodebuffer:function(h){return s.newBufferFrom(h)}},w.nodebuffer={string:E,array:function(h){return m(h,new Array(h.length))},arraybuffer:function(h){return w.nodebuffer.uint8array(h).buffer},uint8array:function(h){return m(h,new Uint8Array(h.length))},nodebuffer:v},a.transformTo=function(h,b){if(b=b||"",!h)return b;a.checkSupport(h);var _=a.getTypeOf(b);return w[_][h](b)},a.resolve=function(h){for(var b=h.split("/"),_=[],y=0;y<b.length;y++){var T=b[y];T==="."||T===""&&y!==0&&y!==b.length-1||(T===".."?_.pop():_.push(T))}return _.join("/")},a.getTypeOf=function(h){return typeof h=="string"?"string":Object.prototype.toString.call(h)==="[object Array]"?"array":o.nodebuffer&&s.isBuffer(h)?"nodebuffer":o.uint8array&&h instanceof Uint8Array?"uint8array":o.arraybuffer&&h instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(h){if(!o[h.toLowerCase()])throw new Error(h+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(h){var b,_,y="";for(_=0;_<(h||"").length;_++)y+="\\x"+((b=h.charCodeAt(_))<16?"0":"")+b.toString(16).toUpperCase();return y},a.delay=function(h,b,_){setImmediate(function(){h.apply(_||null,b||[])})},a.inherits=function(h,b){function _(){}_.prototype=b.prototype,h.prototype=new _},a.extend=function(){var h,b,_={};for(h=0;h<arguments.length;h++)for(b in arguments[h])Object.prototype.hasOwnProperty.call(arguments[h],b)&&_[b]===void 0&&(_[b]=arguments[h][b]);return _},a.prepareContent=function(h,b,_,y,T){return f.Promise.resolve(b).then(function(D){return o.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1)&&typeof FileReader<"u"?new f.Promise(function(A,H){var U=new FileReader;U.onload=function(K){A(K.target.result)},U.onerror=function(K){H(K.target.error)},U.readAsArrayBuffer(D)}):D}).then(function(D){var A=a.getTypeOf(D);return A?(A==="arraybuffer"?D=a.transformTo("uint8array",D):A==="string"&&(T?D=l.decode(D):_&&y!==!0&&(D=function(H){return S(H,o.uint8array?new Uint8Array(H.length):new Array(H.length))}(D))),D):f.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,i,a){var o=n("./reader/readerFor"),l=n("./utils"),s=n("./signature"),f=n("./zipEntry"),v=n("./support");function S(p){this.files=[],this.loadOptions=p}S.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var E=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(E)+", expected "+l.pretty(p)+")")}},isSignature:function(p,E){var m=this.reader.index;this.reader.setIndex(p);var w=this.reader.readString(4)===E;return this.reader.setIndex(m),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),E=v.uint8array?"uint8array":"array",m=l.transformTo(E,p);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,E,m,w=this.zip64EndOfCentralSize-44;0<w;)p=this.reader.readInt(2),E=this.reader.readInt(4),m=this.reader.readData(E),this.zip64ExtensibleData[p]={id:p,length:E,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,E;for(p=0;p<this.files.length;p++)E=this.files[p],this.reader.setIndex(E.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),E.readLocalPart(this.reader),E.handleUTF8(),E.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(p=new f({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var E=p;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var w=E-m;if(0<w)this.isSignature(E,s.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(p){this.reader=o(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=S},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,i,a){var o=n("./reader/readerFor"),l=n("./utils"),s=n("./compressedObject"),f=n("./crc32"),v=n("./utf8"),S=n("./compressions"),p=n("./support");function E(m,w){this.options=m,this.loadOptions=w}E.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var w,h;if(m.skip(22),this.fileNameLength=m.readInt(2),h=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(h),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=function(b){for(var _ in S)if(Object.prototype.hasOwnProperty.call(S,_)&&S[_].magic===b)return S[_];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,w,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var w=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(w),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=o(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var w,h,b,_=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<_;)w=m.readInt(2),h=m.readInt(2),b=m.readData(h),this.extraFields[w]={id:w,length:h,value:b};m.setIndex(_)},handleUTF8:function(){var m=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=v.utf8decode(this.fileName),this.fileCommentStr=v.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var h=l.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(h)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var _=l.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(_)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var w=o(m.value);return w.readInt(1)!==1||f(this.fileName)!==w.readInt(4)?null:v.utf8decode(w.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var w=o(m.value);return w.readInt(1)!==1||f(this.fileComment)!==w.readInt(4)?null:v.utf8decode(w.readData(m.length-5))}return null}},i.exports=E},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,i,a){function o(w,h,b){this.name=w,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=h,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var l=n("./stream/StreamHelper"),s=n("./stream/DataWorker"),f=n("./utf8"),v=n("./compressedObject"),S=n("./stream/GenericWorker");o.prototype={internalStream:function(w){var h=null,b="string";try{if(!w)throw new Error("No output type specified.");var _=(b=w.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),h=this._decompressWorker();var y=!this._dataBinary;y&&!_&&(h=h.pipe(new f.Utf8EncodeWorker)),!y&&_&&(h=h.pipe(new f.Utf8DecodeWorker))}catch(T){(h=new S("error")).error(T)}return new l(h,b,"")},async:function(w,h){return this.internalStream(w).accumulate(h)},nodeStream:function(w,h){return this.internalStream(w||"nodebuffer").toNodejsStream(h)},_compressWorker:function(w,h){if(this._data instanceof v&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new f.Utf8EncodeWorker)),v.createWorkerFrom(b,w,h)},_decompressWorker:function(){return this._data instanceof v?this._data.getContentWorker():this._data instanceof S?this._data:new s(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],E=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<p.length;m++)o.prototype[p[m]]=E;i.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,i,a){(function(o){var l,s,f=o.MutationObserver||o.WebKitMutationObserver;if(f){var v=0,S=new f(w),p=o.document.createTextNode("");S.observe(p,{characterData:!0}),l=function(){p.data=v=++v%2}}else if(o.setImmediate||o.MessageChannel===void 0)l="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var h=o.document.createElement("script");h.onreadystatechange=function(){w(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},o.document.documentElement.appendChild(h)}:function(){setTimeout(w,0)};else{var E=new o.MessageChannel;E.port1.onmessage=w,l=function(){E.port2.postMessage(0)}}var m=[];function w(){var h,b;s=!0;for(var _=m.length;_;){for(b=m,m=[],h=-1;++h<_;)b[h]();_=m.length}s=!1}i.exports=function(h){m.push(h)!==1||s||l()}}).call(this,typeof Br<"u"?Br:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,i,a){var o=n("immediate");function l(){}var s={},f=["REJECTED"],v=["FULFILLED"],S=["PENDING"];function p(_){if(typeof _!="function")throw new TypeError("resolver must be a function");this.state=S,this.queue=[],this.outcome=void 0,_!==l&&h(this,_)}function E(_,y,T){this.promise=_,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}function m(_,y,T){o(function(){var D;try{D=y(T)}catch(A){return s.reject(_,A)}D===_?s.reject(_,new TypeError("Cannot resolve promise with itself")):s.resolve(_,D)})}function w(_){var y=_&&_.then;if(_&&(typeof _=="object"||typeof _=="function")&&typeof y=="function")return function(){y.apply(_,arguments)}}function h(_,y){var T=!1;function D(U){T||(T=!0,s.reject(_,U))}function A(U){T||(T=!0,s.resolve(_,U))}var H=b(function(){y(A,D)});H.status==="error"&&D(H.value)}function b(_,y){var T={};try{T.value=_(y),T.status="success"}catch(D){T.status="error",T.value=D}return T}(i.exports=p).prototype.finally=function(_){if(typeof _!="function")return this;var y=this.constructor;return this.then(function(T){return y.resolve(_()).then(function(){return T})},function(T){return y.resolve(_()).then(function(){throw T})})},p.prototype.catch=function(_){return this.then(null,_)},p.prototype.then=function(_,y){if(typeof _!="function"&&this.state===v||typeof y!="function"&&this.state===f)return this;var T=new this.constructor(l);return this.state!==S?m(T,this.state===v?_:y,this.outcome):this.queue.push(new E(T,_,y)),T},E.prototype.callFulfilled=function(_){s.resolve(this.promise,_)},E.prototype.otherCallFulfilled=function(_){m(this.promise,this.onFulfilled,_)},E.prototype.callRejected=function(_){s.reject(this.promise,_)},E.prototype.otherCallRejected=function(_){m(this.promise,this.onRejected,_)},s.resolve=function(_,y){var T=b(w,y);if(T.status==="error")return s.reject(_,T.value);var D=T.value;if(D)h(_,D);else{_.state=v,_.outcome=y;for(var A=-1,H=_.queue.length;++A<H;)_.queue[A].callFulfilled(y)}return _},s.reject=function(_,y){_.state=f,_.outcome=y;for(var T=-1,D=_.queue.length;++T<D;)_.queue[T].callRejected(y);return _},p.resolve=function(_){return _ instanceof this?_:s.resolve(new this(l),_)},p.reject=function(_){var y=new this(l);return s.reject(y,_)},p.all=function(_){var y=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=_.length,D=!1;if(!T)return this.resolve([]);for(var A=new Array(T),H=0,U=-1,K=new this(l);++U<T;)R(_[U],U);return K;function R(Q,ae){y.resolve(Q).then(function(M){A[ae]=M,++H!==T||D||(D=!0,s.resolve(K,A))},function(M){D||(D=!0,s.reject(K,M))})}},p.race=function(_){var y=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=_.length,D=!1;if(!T)return this.resolve([]);for(var A=-1,H=new this(l);++A<T;)U=_[A],y.resolve(U).then(function(K){D||(D=!0,s.resolve(H,K))},function(K){D||(D=!0,s.reject(H,K))});var U;return H}},{immediate:36}],38:[function(n,i,a){var o={};(0,n("./lib/utils/common").assign)(o,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),i.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,i,a){var o=n("./zlib/deflate"),l=n("./utils/common"),s=n("./utils/strings"),f=n("./zlib/messages"),v=n("./zlib/zstream"),S=Object.prototype.toString,p=0,E=-1,m=0,w=8;function h(_){if(!(this instanceof h))return new h(_);this.options=l.assign({level:E,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},_||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var T=o.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(T!==p)throw new Error(f[T]);if(y.header&&o.deflateSetHeader(this.strm,y.header),y.dictionary){var D;if(D=typeof y.dictionary=="string"?s.string2buf(y.dictionary):S.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(T=o.deflateSetDictionary(this.strm,D))!==p)throw new Error(f[T]);this._dict_set=!0}}function b(_,y){var T=new h(y);if(T.push(_,!0),T.err)throw T.msg||f[T.err];return T.result}h.prototype.push=function(_,y){var T,D,A=this.strm,H=this.options.chunkSize;if(this.ended)return!1;D=y===~~y?y:y===!0?4:0,typeof _=="string"?A.input=s.string2buf(_):S.call(_)==="[object ArrayBuffer]"?A.input=new Uint8Array(_):A.input=_,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new l.Buf8(H),A.next_out=0,A.avail_out=H),(T=o.deflate(A,D))!==1&&T!==p)return this.onEnd(T),!(this.ended=!0);A.avail_out!==0&&(A.avail_in!==0||D!==4&&D!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(l.shrinkBuf(A.output,A.next_out))):this.onData(l.shrinkBuf(A.output,A.next_out)))}while((0<A.avail_in||A.avail_out===0)&&T!==1);return D===4?(T=o.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===p):D!==2||(this.onEnd(p),!(A.avail_out=0))},h.prototype.onData=function(_){this.chunks.push(_)},h.prototype.onEnd=function(_){_===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},a.Deflate=h,a.deflate=b,a.deflateRaw=function(_,y){return(y=y||{}).raw=!0,b(_,y)},a.gzip=function(_,y){return(y=y||{}).gzip=!0,b(_,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,i,a){var o=n("./zlib/inflate"),l=n("./utils/common"),s=n("./utils/strings"),f=n("./zlib/constants"),v=n("./zlib/messages"),S=n("./zlib/zstream"),p=n("./zlib/gzheader"),E=Object.prototype.toString;function m(h){if(!(this instanceof m))return new m(h);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},h||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||h&&h.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&!(15&b.windowBits)&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new S,this.strm.avail_out=0;var _=o.inflateInit2(this.strm,b.windowBits);if(_!==f.Z_OK)throw new Error(v[_]);this.header=new p,o.inflateGetHeader(this.strm,this.header)}function w(h,b){var _=new m(b);if(_.push(h,!0),_.err)throw _.msg||v[_.err];return _.result}m.prototype.push=function(h,b){var _,y,T,D,A,H,U=this.strm,K=this.options.chunkSize,R=this.options.dictionary,Q=!1;if(this.ended)return!1;y=b===~~b?b:b===!0?f.Z_FINISH:f.Z_NO_FLUSH,typeof h=="string"?U.input=s.binstring2buf(h):E.call(h)==="[object ArrayBuffer]"?U.input=new Uint8Array(h):U.input=h,U.next_in=0,U.avail_in=U.input.length;do{if(U.avail_out===0&&(U.output=new l.Buf8(K),U.next_out=0,U.avail_out=K),(_=o.inflate(U,f.Z_NO_FLUSH))===f.Z_NEED_DICT&&R&&(H=typeof R=="string"?s.string2buf(R):E.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,_=o.inflateSetDictionary(this.strm,H)),_===f.Z_BUF_ERROR&&Q===!0&&(_=f.Z_OK,Q=!1),_!==f.Z_STREAM_END&&_!==f.Z_OK)return this.onEnd(_),!(this.ended=!0);U.next_out&&(U.avail_out!==0&&_!==f.Z_STREAM_END&&(U.avail_in!==0||y!==f.Z_FINISH&&y!==f.Z_SYNC_FLUSH)||(this.options.to==="string"?(T=s.utf8border(U.output,U.next_out),D=U.next_out-T,A=s.buf2string(U.output,T),U.next_out=D,U.avail_out=K-D,D&&l.arraySet(U.output,U.output,T,D,0),this.onData(A)):this.onData(l.shrinkBuf(U.output,U.next_out)))),U.avail_in===0&&U.avail_out===0&&(Q=!0)}while((0<U.avail_in||U.avail_out===0)&&_!==f.Z_STREAM_END);return _===f.Z_STREAM_END&&(y=f.Z_FINISH),y===f.Z_FINISH?(_=o.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===f.Z_OK):y!==f.Z_SYNC_FLUSH||(this.onEnd(f.Z_OK),!(U.avail_out=0))},m.prototype.onData=function(h){this.chunks.push(h)},m.prototype.onEnd=function(h){h===f.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},a.Inflate=m,a.inflate=w,a.inflateRaw=function(h,b){return(b=b||{}).raw=!0,w(h,b)},a.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,i,a){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(f){for(var v=Array.prototype.slice.call(arguments,1);v.length;){var S=v.shift();if(S){if(typeof S!="object")throw new TypeError(S+"must be non-object");for(var p in S)S.hasOwnProperty(p)&&(f[p]=S[p])}}return f},a.shrinkBuf=function(f,v){return f.length===v?f:f.subarray?f.subarray(0,v):(f.length=v,f)};var l={arraySet:function(f,v,S,p,E){if(v.subarray&&f.subarray)f.set(v.subarray(S,S+p),E);else for(var m=0;m<p;m++)f[E+m]=v[S+m]},flattenChunks:function(f){var v,S,p,E,m,w;for(v=p=0,S=f.length;v<S;v++)p+=f[v].length;for(w=new Uint8Array(p),v=E=0,S=f.length;v<S;v++)m=f[v],w.set(m,E),E+=m.length;return w}},s={arraySet:function(f,v,S,p,E){for(var m=0;m<p;m++)f[E+m]=v[S+m]},flattenChunks:function(f){return[].concat.apply([],f)}};a.setTyped=function(f){f?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,l)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,s))},a.setTyped(o)},{}],42:[function(n,i,a){var o=n("./common"),l=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var f=new o.Buf8(256),v=0;v<256;v++)f[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;function S(p,E){if(E<65537&&(p.subarray&&s||!p.subarray&&l))return String.fromCharCode.apply(null,o.shrinkBuf(p,E));for(var m="",w=0;w<E;w++)m+=String.fromCharCode(p[w]);return m}f[254]=f[254]=1,a.string2buf=function(p){var E,m,w,h,b,_=p.length,y=0;for(h=0;h<_;h++)(64512&(m=p.charCodeAt(h)))==55296&&h+1<_&&(64512&(w=p.charCodeAt(h+1)))==56320&&(m=65536+(m-55296<<10)+(w-56320),h++),y+=m<128?1:m<2048?2:m<65536?3:4;for(E=new o.Buf8(y),h=b=0;b<y;h++)(64512&(m=p.charCodeAt(h)))==55296&&h+1<_&&(64512&(w=p.charCodeAt(h+1)))==56320&&(m=65536+(m-55296<<10)+(w-56320),h++),m<128?E[b++]=m:(m<2048?E[b++]=192|m>>>6:(m<65536?E[b++]=224|m>>>12:(E[b++]=240|m>>>18,E[b++]=128|m>>>12&63),E[b++]=128|m>>>6&63),E[b++]=128|63&m);return E},a.buf2binstring=function(p){return S(p,p.length)},a.binstring2buf=function(p){for(var E=new o.Buf8(p.length),m=0,w=E.length;m<w;m++)E[m]=p.charCodeAt(m);return E},a.buf2string=function(p,E){var m,w,h,b,_=E||p.length,y=new Array(2*_);for(m=w=0;m<_;)if((h=p[m++])<128)y[w++]=h;else if(4<(b=f[h]))y[w++]=65533,m+=b-1;else{for(h&=b===2?31:b===3?15:7;1<b&&m<_;)h=h<<6|63&p[m++],b--;1<b?y[w++]=65533:h<65536?y[w++]=h:(h-=65536,y[w++]=55296|h>>10&1023,y[w++]=56320|1023&h)}return S(y,w)},a.utf8border=function(p,E){var m;for((E=E||p.length)>p.length&&(E=p.length),m=E-1;0<=m&&(192&p[m])==128;)m--;return m<0||m===0?E:m+f[p[m]]>E?m:E}},{"./common":41}],43:[function(n,i,a){i.exports=function(o,l,s,f){for(var v=65535&o|0,S=o>>>16&65535|0,p=0;s!==0;){for(s-=p=2e3<s?2e3:s;S=S+(v=v+l[f++]|0)|0,--p;);v%=65521,S%=65521}return v|S<<16|0}},{}],44:[function(n,i,a){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,i,a){var o=function(){for(var l,s=[],f=0;f<256;f++){l=f;for(var v=0;v<8;v++)l=1&l?3988292384^l>>>1:l>>>1;s[f]=l}return s}();i.exports=function(l,s,f,v){var S=o,p=v+f;l^=-1;for(var E=v;E<p;E++)l=l>>>8^S[255&(l^s[E])];return-1^l}},{}],46:[function(n,i,a){var o,l=n("../utils/common"),s=n("./trees"),f=n("./adler32"),v=n("./crc32"),S=n("./messages"),p=0,E=4,m=0,w=-2,h=-1,b=4,_=2,y=8,T=9,D=286,A=30,H=19,U=2*D+1,K=15,R=3,Q=258,ae=Q+R+1,M=42,V=113,d=1,W=2,de=3,q=4;function me(c,j){return c.msg=S[j],j}function C(c){return(c<<1)-(4<c?9:0)}function he(c){for(var j=c.length;0<=--j;)c[j]=0}function z(c){var j=c.state,N=j.pending;N>c.avail_out&&(N=c.avail_out),N!==0&&(l.arraySet(c.output,j.pending_buf,j.pending_out,N,c.next_out),c.next_out+=N,j.pending_out+=N,c.total_out+=N,c.avail_out-=N,j.pending-=N,j.pending===0&&(j.pending_out=0))}function O(c,j){s._tr_flush_block(c,0<=c.block_start?c.block_start:-1,c.strstart-c.block_start,j),c.block_start=c.strstart,z(c.strm)}function ie(c,j){c.pending_buf[c.pending++]=j}function te(c,j){c.pending_buf[c.pending++]=j>>>8&255,c.pending_buf[c.pending++]=255&j}function ee(c,j){var N,B,P=c.max_chain_length,L=c.strstart,Z=c.prev_length,Y=c.nice_match,F=c.strstart>c.w_size-ae?c.strstart-(c.w_size-ae):0,$=c.window,ne=c.w_mask,J=c.prev,ce=c.strstart+Q,Te=$[L+Z-1],pe=$[L+Z];c.prev_length>=c.good_match&&(P>>=2),Y>c.lookahead&&(Y=c.lookahead);do if($[(N=j)+Z]===pe&&$[N+Z-1]===Te&&$[N]===$[L]&&$[++N]===$[L+1]){L+=2,N++;do;while($[++L]===$[++N]&&$[++L]===$[++N]&&$[++L]===$[++N]&&$[++L]===$[++N]&&$[++L]===$[++N]&&$[++L]===$[++N]&&$[++L]===$[++N]&&$[++L]===$[++N]&&L<ce);if(B=Q-(ce-L),L=ce-Q,Z<B){if(c.match_start=j,Y<=(Z=B))break;Te=$[L+Z-1],pe=$[L+Z]}}while((j=J[j&ne])>F&&--P!=0);return Z<=c.lookahead?Z:c.lookahead}function Re(c){var j,N,B,P,L,Z,Y,F,$,ne,J=c.w_size;do{if(P=c.window_size-c.lookahead-c.strstart,c.strstart>=J+(J-ae)){for(l.arraySet(c.window,c.window,J,J,0),c.match_start-=J,c.strstart-=J,c.block_start-=J,j=N=c.hash_size;B=c.head[--j],c.head[j]=J<=B?B-J:0,--N;);for(j=N=J;B=c.prev[--j],c.prev[j]=J<=B?B-J:0,--N;);P+=J}if(c.strm.avail_in===0)break;if(Z=c.strm,Y=c.window,F=c.strstart+c.lookahead,$=P,ne=void 0,ne=Z.avail_in,$<ne&&(ne=$),N=ne===0?0:(Z.avail_in-=ne,l.arraySet(Y,Z.input,Z.next_in,ne,F),Z.state.wrap===1?Z.adler=f(Z.adler,Y,ne,F):Z.state.wrap===2&&(Z.adler=v(Z.adler,Y,ne,F)),Z.next_in+=ne,Z.total_in+=ne,ne),c.lookahead+=N,c.lookahead+c.insert>=R)for(L=c.strstart-c.insert,c.ins_h=c.window[L],c.ins_h=(c.ins_h<<c.hash_shift^c.window[L+1])&c.hash_mask;c.insert&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[L+R-1])&c.hash_mask,c.prev[L&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=L,L++,c.insert--,!(c.lookahead+c.insert<R)););}while(c.lookahead<ae&&c.strm.avail_in!==0)}function Ze(c,j){for(var N,B;;){if(c.lookahead<ae){if(Re(c),c.lookahead<ae&&j===p)return d;if(c.lookahead===0)break}if(N=0,c.lookahead>=R&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+R-1])&c.hash_mask,N=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),N!==0&&c.strstart-N<=c.w_size-ae&&(c.match_length=ee(c,N)),c.match_length>=R)if(B=s._tr_tally(c,c.strstart-c.match_start,c.match_length-R),c.lookahead-=c.match_length,c.match_length<=c.max_lazy_match&&c.lookahead>=R){for(c.match_length--;c.strstart++,c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+R-1])&c.hash_mask,N=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart,--c.match_length!=0;);c.strstart++}else c.strstart+=c.match_length,c.match_length=0,c.ins_h=c.window[c.strstart],c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+1])&c.hash_mask;else B=s._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++;if(B&&(O(c,!1),c.strm.avail_out===0))return d}return c.insert=c.strstart<R-1?c.strstart:R-1,j===E?(O(c,!0),c.strm.avail_out===0?de:q):c.last_lit&&(O(c,!1),c.strm.avail_out===0)?d:W}function ve(c,j){for(var N,B,P;;){if(c.lookahead<ae){if(Re(c),c.lookahead<ae&&j===p)return d;if(c.lookahead===0)break}if(N=0,c.lookahead>=R&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+R-1])&c.hash_mask,N=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),c.prev_length=c.match_length,c.prev_match=c.match_start,c.match_length=R-1,N!==0&&c.prev_length<c.max_lazy_match&&c.strstart-N<=c.w_size-ae&&(c.match_length=ee(c,N),c.match_length<=5&&(c.strategy===1||c.match_length===R&&4096<c.strstart-c.match_start)&&(c.match_length=R-1)),c.prev_length>=R&&c.match_length<=c.prev_length){for(P=c.strstart+c.lookahead-R,B=s._tr_tally(c,c.strstart-1-c.prev_match,c.prev_length-R),c.lookahead-=c.prev_length-1,c.prev_length-=2;++c.strstart<=P&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+R-1])&c.hash_mask,N=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),--c.prev_length!=0;);if(c.match_available=0,c.match_length=R-1,c.strstart++,B&&(O(c,!1),c.strm.avail_out===0))return d}else if(c.match_available){if((B=s._tr_tally(c,0,c.window[c.strstart-1]))&&O(c,!1),c.strstart++,c.lookahead--,c.strm.avail_out===0)return d}else c.match_available=1,c.strstart++,c.lookahead--}return c.match_available&&(B=s._tr_tally(c,0,c.window[c.strstart-1]),c.match_available=0),c.insert=c.strstart<R-1?c.strstart:R-1,j===E?(O(c,!0),c.strm.avail_out===0?de:q):c.last_lit&&(O(c,!1),c.strm.avail_out===0)?d:W}function Se(c,j,N,B,P){this.good_length=c,this.max_lazy=j,this.nice_length=N,this.max_chain=B,this.func=P}function ze(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*U),this.dyn_dtree=new l.Buf16(2*(2*A+1)),this.bl_tree=new l.Buf16(2*(2*H+1)),he(this.dyn_ltree),he(this.dyn_dtree),he(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(K+1),this.heap=new l.Buf16(2*D+1),he(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*D+1),he(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ne(c){var j;return c&&c.state?(c.total_in=c.total_out=0,c.data_type=_,(j=c.state).pending=0,j.pending_out=0,j.wrap<0&&(j.wrap=-j.wrap),j.status=j.wrap?M:V,c.adler=j.wrap===2?0:1,j.last_flush=p,s._tr_init(j),m):me(c,w)}function st(c){var j=Ne(c);return j===m&&function(N){N.window_size=2*N.w_size,he(N.head),N.max_lazy_match=o[N.level].max_lazy,N.good_match=o[N.level].good_length,N.nice_match=o[N.level].nice_length,N.max_chain_length=o[N.level].max_chain,N.strstart=0,N.block_start=0,N.lookahead=0,N.insert=0,N.match_length=N.prev_length=R-1,N.match_available=0,N.ins_h=0}(c.state),j}function it(c,j,N,B,P,L){if(!c)return w;var Z=1;if(j===h&&(j=6),B<0?(Z=0,B=-B):15<B&&(Z=2,B-=16),P<1||T<P||N!==y||B<8||15<B||j<0||9<j||L<0||b<L)return me(c,w);B===8&&(B=9);var Y=new ze;return(c.state=Y).strm=c,Y.wrap=Z,Y.gzhead=null,Y.w_bits=B,Y.w_size=1<<Y.w_bits,Y.w_mask=Y.w_size-1,Y.hash_bits=P+7,Y.hash_size=1<<Y.hash_bits,Y.hash_mask=Y.hash_size-1,Y.hash_shift=~~((Y.hash_bits+R-1)/R),Y.window=new l.Buf8(2*Y.w_size),Y.head=new l.Buf16(Y.hash_size),Y.prev=new l.Buf16(Y.w_size),Y.lit_bufsize=1<<P+6,Y.pending_buf_size=4*Y.lit_bufsize,Y.pending_buf=new l.Buf8(Y.pending_buf_size),Y.d_buf=1*Y.lit_bufsize,Y.l_buf=3*Y.lit_bufsize,Y.level=j,Y.strategy=L,Y.method=N,st(c)}o=[new Se(0,0,0,0,function(c,j){var N=65535;for(N>c.pending_buf_size-5&&(N=c.pending_buf_size-5);;){if(c.lookahead<=1){if(Re(c),c.lookahead===0&&j===p)return d;if(c.lookahead===0)break}c.strstart+=c.lookahead,c.lookahead=0;var B=c.block_start+N;if((c.strstart===0||c.strstart>=B)&&(c.lookahead=c.strstart-B,c.strstart=B,O(c,!1),c.strm.avail_out===0)||c.strstart-c.block_start>=c.w_size-ae&&(O(c,!1),c.strm.avail_out===0))return d}return c.insert=0,j===E?(O(c,!0),c.strm.avail_out===0?de:q):(c.strstart>c.block_start&&(O(c,!1),c.strm.avail_out),d)}),new Se(4,4,8,4,Ze),new Se(4,5,16,8,Ze),new Se(4,6,32,32,Ze),new Se(4,4,16,16,ve),new Se(8,16,32,32,ve),new Se(8,16,128,128,ve),new Se(8,32,128,256,ve),new Se(32,128,258,1024,ve),new Se(32,258,258,4096,ve)],a.deflateInit=function(c,j){return it(c,j,y,15,8,0)},a.deflateInit2=it,a.deflateReset=st,a.deflateResetKeep=Ne,a.deflateSetHeader=function(c,j){return c&&c.state?c.state.wrap!==2?w:(c.state.gzhead=j,m):w},a.deflate=function(c,j){var N,B,P,L;if(!c||!c.state||5<j||j<0)return c?me(c,w):w;if(B=c.state,!c.output||!c.input&&c.avail_in!==0||B.status===666&&j!==E)return me(c,c.avail_out===0?-5:w);if(B.strm=c,N=B.last_flush,B.last_flush=j,B.status===M)if(B.wrap===2)c.adler=0,ie(B,31),ie(B,139),ie(B,8),B.gzhead?(ie(B,(B.gzhead.text?1:0)+(B.gzhead.hcrc?2:0)+(B.gzhead.extra?4:0)+(B.gzhead.name?8:0)+(B.gzhead.comment?16:0)),ie(B,255&B.gzhead.time),ie(B,B.gzhead.time>>8&255),ie(B,B.gzhead.time>>16&255),ie(B,B.gzhead.time>>24&255),ie(B,B.level===9?2:2<=B.strategy||B.level<2?4:0),ie(B,255&B.gzhead.os),B.gzhead.extra&&B.gzhead.extra.length&&(ie(B,255&B.gzhead.extra.length),ie(B,B.gzhead.extra.length>>8&255)),B.gzhead.hcrc&&(c.adler=v(c.adler,B.pending_buf,B.pending,0)),B.gzindex=0,B.status=69):(ie(B,0),ie(B,0),ie(B,0),ie(B,0),ie(B,0),ie(B,B.level===9?2:2<=B.strategy||B.level<2?4:0),ie(B,3),B.status=V);else{var Z=y+(B.w_bits-8<<4)<<8;Z|=(2<=B.strategy||B.level<2?0:B.level<6?1:B.level===6?2:3)<<6,B.strstart!==0&&(Z|=32),Z+=31-Z%31,B.status=V,te(B,Z),B.strstart!==0&&(te(B,c.adler>>>16),te(B,65535&c.adler)),c.adler=1}if(B.status===69)if(B.gzhead.extra){for(P=B.pending;B.gzindex<(65535&B.gzhead.extra.length)&&(B.pending!==B.pending_buf_size||(B.gzhead.hcrc&&B.pending>P&&(c.adler=v(c.adler,B.pending_buf,B.pending-P,P)),z(c),P=B.pending,B.pending!==B.pending_buf_size));)ie(B,255&B.gzhead.extra[B.gzindex]),B.gzindex++;B.gzhead.hcrc&&B.pending>P&&(c.adler=v(c.adler,B.pending_buf,B.pending-P,P)),B.gzindex===B.gzhead.extra.length&&(B.gzindex=0,B.status=73)}else B.status=73;if(B.status===73)if(B.gzhead.name){P=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>P&&(c.adler=v(c.adler,B.pending_buf,B.pending-P,P)),z(c),P=B.pending,B.pending===B.pending_buf_size)){L=1;break}L=B.gzindex<B.gzhead.name.length?255&B.gzhead.name.charCodeAt(B.gzindex++):0,ie(B,L)}while(L!==0);B.gzhead.hcrc&&B.pending>P&&(c.adler=v(c.adler,B.pending_buf,B.pending-P,P)),L===0&&(B.gzindex=0,B.status=91)}else B.status=91;if(B.status===91)if(B.gzhead.comment){P=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>P&&(c.adler=v(c.adler,B.pending_buf,B.pending-P,P)),z(c),P=B.pending,B.pending===B.pending_buf_size)){L=1;break}L=B.gzindex<B.gzhead.comment.length?255&B.gzhead.comment.charCodeAt(B.gzindex++):0,ie(B,L)}while(L!==0);B.gzhead.hcrc&&B.pending>P&&(c.adler=v(c.adler,B.pending_buf,B.pending-P,P)),L===0&&(B.status=103)}else B.status=103;if(B.status===103&&(B.gzhead.hcrc?(B.pending+2>B.pending_buf_size&&z(c),B.pending+2<=B.pending_buf_size&&(ie(B,255&c.adler),ie(B,c.adler>>8&255),c.adler=0,B.status=V)):B.status=V),B.pending!==0){if(z(c),c.avail_out===0)return B.last_flush=-1,m}else if(c.avail_in===0&&C(j)<=C(N)&&j!==E)return me(c,-5);if(B.status===666&&c.avail_in!==0)return me(c,-5);if(c.avail_in!==0||B.lookahead!==0||j!==p&&B.status!==666){var Y=B.strategy===2?function(F,$){for(var ne;;){if(F.lookahead===0&&(Re(F),F.lookahead===0)){if($===p)return d;break}if(F.match_length=0,ne=s._tr_tally(F,0,F.window[F.strstart]),F.lookahead--,F.strstart++,ne&&(O(F,!1),F.strm.avail_out===0))return d}return F.insert=0,$===E?(O(F,!0),F.strm.avail_out===0?de:q):F.last_lit&&(O(F,!1),F.strm.avail_out===0)?d:W}(B,j):B.strategy===3?function(F,$){for(var ne,J,ce,Te,pe=F.window;;){if(F.lookahead<=Q){if(Re(F),F.lookahead<=Q&&$===p)return d;if(F.lookahead===0)break}if(F.match_length=0,F.lookahead>=R&&0<F.strstart&&(J=pe[ce=F.strstart-1])===pe[++ce]&&J===pe[++ce]&&J===pe[++ce]){Te=F.strstart+Q;do;while(J===pe[++ce]&&J===pe[++ce]&&J===pe[++ce]&&J===pe[++ce]&&J===pe[++ce]&&J===pe[++ce]&&J===pe[++ce]&&J===pe[++ce]&&ce<Te);F.match_length=Q-(Te-ce),F.match_length>F.lookahead&&(F.match_length=F.lookahead)}if(F.match_length>=R?(ne=s._tr_tally(F,1,F.match_length-R),F.lookahead-=F.match_length,F.strstart+=F.match_length,F.match_length=0):(ne=s._tr_tally(F,0,F.window[F.strstart]),F.lookahead--,F.strstart++),ne&&(O(F,!1),F.strm.avail_out===0))return d}return F.insert=0,$===E?(O(F,!0),F.strm.avail_out===0?de:q):F.last_lit&&(O(F,!1),F.strm.avail_out===0)?d:W}(B,j):o[B.level].func(B,j);if(Y!==de&&Y!==q||(B.status=666),Y===d||Y===de)return c.avail_out===0&&(B.last_flush=-1),m;if(Y===W&&(j===1?s._tr_align(B):j!==5&&(s._tr_stored_block(B,0,0,!1),j===3&&(he(B.head),B.lookahead===0&&(B.strstart=0,B.block_start=0,B.insert=0))),z(c),c.avail_out===0))return B.last_flush=-1,m}return j!==E?m:B.wrap<=0?1:(B.wrap===2?(ie(B,255&c.adler),ie(B,c.adler>>8&255),ie(B,c.adler>>16&255),ie(B,c.adler>>24&255),ie(B,255&c.total_in),ie(B,c.total_in>>8&255),ie(B,c.total_in>>16&255),ie(B,c.total_in>>24&255)):(te(B,c.adler>>>16),te(B,65535&c.adler)),z(c),0<B.wrap&&(B.wrap=-B.wrap),B.pending!==0?m:1)},a.deflateEnd=function(c){var j;return c&&c.state?(j=c.state.status)!==M&&j!==69&&j!==73&&j!==91&&j!==103&&j!==V&&j!==666?me(c,w):(c.state=null,j===V?me(c,-3):m):w},a.deflateSetDictionary=function(c,j){var N,B,P,L,Z,Y,F,$,ne=j.length;if(!c||!c.state||(L=(N=c.state).wrap)===2||L===1&&N.status!==M||N.lookahead)return w;for(L===1&&(c.adler=f(c.adler,j,ne,0)),N.wrap=0,ne>=N.w_size&&(L===0&&(he(N.head),N.strstart=0,N.block_start=0,N.insert=0),$=new l.Buf8(N.w_size),l.arraySet($,j,ne-N.w_size,N.w_size,0),j=$,ne=N.w_size),Z=c.avail_in,Y=c.next_in,F=c.input,c.avail_in=ne,c.next_in=0,c.input=j,Re(N);N.lookahead>=R;){for(B=N.strstart,P=N.lookahead-(R-1);N.ins_h=(N.ins_h<<N.hash_shift^N.window[B+R-1])&N.hash_mask,N.prev[B&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=B,B++,--P;);N.strstart=B,N.lookahead=R-1,Re(N)}return N.strstart+=N.lookahead,N.block_start=N.strstart,N.insert=N.lookahead,N.lookahead=0,N.match_length=N.prev_length=R-1,N.match_available=0,c.next_in=Y,c.input=F,c.avail_in=Z,N.wrap=L,m},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,i,a){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,i,a){i.exports=function(o,l){var s,f,v,S,p,E,m,w,h,b,_,y,T,D,A,H,U,K,R,Q,ae,M,V,d,W;s=o.state,f=o.next_in,d=o.input,v=f+(o.avail_in-5),S=o.next_out,W=o.output,p=S-(l-o.avail_out),E=S+(o.avail_out-257),m=s.dmax,w=s.wsize,h=s.whave,b=s.wnext,_=s.window,y=s.hold,T=s.bits,D=s.lencode,A=s.distcode,H=(1<<s.lenbits)-1,U=(1<<s.distbits)-1;e:do{T<15&&(y+=d[f++]<<T,T+=8,y+=d[f++]<<T,T+=8),K=D[y&H];t:for(;;){if(y>>>=R=K>>>24,T-=R,(R=K>>>16&255)===0)W[S++]=65535&K;else{if(!(16&R)){if(!(64&R)){K=D[(65535&K)+(y&(1<<R)-1)];continue t}if(32&R){s.mode=12;break e}o.msg="invalid literal/length code",s.mode=30;break e}Q=65535&K,(R&=15)&&(T<R&&(y+=d[f++]<<T,T+=8),Q+=y&(1<<R)-1,y>>>=R,T-=R),T<15&&(y+=d[f++]<<T,T+=8,y+=d[f++]<<T,T+=8),K=A[y&U];r:for(;;){if(y>>>=R=K>>>24,T-=R,!(16&(R=K>>>16&255))){if(!(64&R)){K=A[(65535&K)+(y&(1<<R)-1)];continue r}o.msg="invalid distance code",s.mode=30;break e}if(ae=65535&K,T<(R&=15)&&(y+=d[f++]<<T,(T+=8)<R&&(y+=d[f++]<<T,T+=8)),m<(ae+=y&(1<<R)-1)){o.msg="invalid distance too far back",s.mode=30;break e}if(y>>>=R,T-=R,(R=S-p)<ae){if(h<(R=ae-R)&&s.sane){o.msg="invalid distance too far back",s.mode=30;break e}if(V=_,(M=0)===b){if(M+=w-R,R<Q){for(Q-=R;W[S++]=_[M++],--R;);M=S-ae,V=W}}else if(b<R){if(M+=w+b-R,(R-=b)<Q){for(Q-=R;W[S++]=_[M++],--R;);if(M=0,b<Q){for(Q-=R=b;W[S++]=_[M++],--R;);M=S-ae,V=W}}}else if(M+=b-R,R<Q){for(Q-=R;W[S++]=_[M++],--R;);M=S-ae,V=W}for(;2<Q;)W[S++]=V[M++],W[S++]=V[M++],W[S++]=V[M++],Q-=3;Q&&(W[S++]=V[M++],1<Q&&(W[S++]=V[M++]))}else{for(M=S-ae;W[S++]=W[M++],W[S++]=W[M++],W[S++]=W[M++],2<(Q-=3););Q&&(W[S++]=W[M++],1<Q&&(W[S++]=W[M++]))}break}}break}}while(f<v&&S<E);f-=Q=T>>3,y&=(1<<(T-=Q<<3))-1,o.next_in=f,o.next_out=S,o.avail_in=f<v?v-f+5:5-(f-v),o.avail_out=S<E?E-S+257:257-(S-E),s.hold=y,s.bits=T}},{}],49:[function(n,i,a){var o=n("../utils/common"),l=n("./adler32"),s=n("./crc32"),f=n("./inffast"),v=n("./inftrees"),S=1,p=2,E=0,m=-2,w=1,h=852,b=592;function _(M){return(M>>>24&255)+(M>>>8&65280)+((65280&M)<<8)+((255&M)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function T(M){var V;return M&&M.state?(V=M.state,M.total_in=M.total_out=V.total=0,M.msg="",V.wrap&&(M.adler=1&V.wrap),V.mode=w,V.last=0,V.havedict=0,V.dmax=32768,V.head=null,V.hold=0,V.bits=0,V.lencode=V.lendyn=new o.Buf32(h),V.distcode=V.distdyn=new o.Buf32(b),V.sane=1,V.back=-1,E):m}function D(M){var V;return M&&M.state?((V=M.state).wsize=0,V.whave=0,V.wnext=0,T(M)):m}function A(M,V){var d,W;return M&&M.state?(W=M.state,V<0?(d=0,V=-V):(d=1+(V>>4),V<48&&(V&=15)),V&&(V<8||15<V)?m:(W.window!==null&&W.wbits!==V&&(W.window=null),W.wrap=d,W.wbits=V,D(M))):m}function H(M,V){var d,W;return M?(W=new y,(M.state=W).window=null,(d=A(M,V))!==E&&(M.state=null),d):m}var U,K,R=!0;function Q(M){if(R){var V;for(U=new o.Buf32(512),K=new o.Buf32(32),V=0;V<144;)M.lens[V++]=8;for(;V<256;)M.lens[V++]=9;for(;V<280;)M.lens[V++]=7;for(;V<288;)M.lens[V++]=8;for(v(S,M.lens,0,288,U,0,M.work,{bits:9}),V=0;V<32;)M.lens[V++]=5;v(p,M.lens,0,32,K,0,M.work,{bits:5}),R=!1}M.lencode=U,M.lenbits=9,M.distcode=K,M.distbits=5}function ae(M,V,d,W){var de,q=M.state;return q.window===null&&(q.wsize=1<<q.wbits,q.wnext=0,q.whave=0,q.window=new o.Buf8(q.wsize)),W>=q.wsize?(o.arraySet(q.window,V,d-q.wsize,q.wsize,0),q.wnext=0,q.whave=q.wsize):(W<(de=q.wsize-q.wnext)&&(de=W),o.arraySet(q.window,V,d-W,de,q.wnext),(W-=de)?(o.arraySet(q.window,V,d-W,W,0),q.wnext=W,q.whave=q.wsize):(q.wnext+=de,q.wnext===q.wsize&&(q.wnext=0),q.whave<q.wsize&&(q.whave+=de))),0}a.inflateReset=D,a.inflateReset2=A,a.inflateResetKeep=T,a.inflateInit=function(M){return H(M,15)},a.inflateInit2=H,a.inflate=function(M,V){var d,W,de,q,me,C,he,z,O,ie,te,ee,Re,Ze,ve,Se,ze,Ne,st,it,c,j,N,B,P=0,L=new o.Buf8(4),Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!M||!M.state||!M.output||!M.input&&M.avail_in!==0)return m;(d=M.state).mode===12&&(d.mode=13),me=M.next_out,de=M.output,he=M.avail_out,q=M.next_in,W=M.input,C=M.avail_in,z=d.hold,O=d.bits,ie=C,te=he,j=E;e:for(;;)switch(d.mode){case w:if(d.wrap===0){d.mode=13;break}for(;O<16;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}if(2&d.wrap&&z===35615){L[d.check=0]=255&z,L[1]=z>>>8&255,d.check=s(d.check,L,2,0),O=z=0,d.mode=2;break}if(d.flags=0,d.head&&(d.head.done=!1),!(1&d.wrap)||(((255&z)<<8)+(z>>8))%31){M.msg="incorrect header check",d.mode=30;break}if((15&z)!=8){M.msg="unknown compression method",d.mode=30;break}if(O-=4,c=8+(15&(z>>>=4)),d.wbits===0)d.wbits=c;else if(c>d.wbits){M.msg="invalid window size",d.mode=30;break}d.dmax=1<<c,M.adler=d.check=1,d.mode=512&z?10:12,O=z=0;break;case 2:for(;O<16;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}if(d.flags=z,(255&d.flags)!=8){M.msg="unknown compression method",d.mode=30;break}if(57344&d.flags){M.msg="unknown header flags set",d.mode=30;break}d.head&&(d.head.text=z>>8&1),512&d.flags&&(L[0]=255&z,L[1]=z>>>8&255,d.check=s(d.check,L,2,0)),O=z=0,d.mode=3;case 3:for(;O<32;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}d.head&&(d.head.time=z),512&d.flags&&(L[0]=255&z,L[1]=z>>>8&255,L[2]=z>>>16&255,L[3]=z>>>24&255,d.check=s(d.check,L,4,0)),O=z=0,d.mode=4;case 4:for(;O<16;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}d.head&&(d.head.xflags=255&z,d.head.os=z>>8),512&d.flags&&(L[0]=255&z,L[1]=z>>>8&255,d.check=s(d.check,L,2,0)),O=z=0,d.mode=5;case 5:if(1024&d.flags){for(;O<16;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}d.length=z,d.head&&(d.head.extra_len=z),512&d.flags&&(L[0]=255&z,L[1]=z>>>8&255,d.check=s(d.check,L,2,0)),O=z=0}else d.head&&(d.head.extra=null);d.mode=6;case 6:if(1024&d.flags&&(C<(ee=d.length)&&(ee=C),ee&&(d.head&&(c=d.head.extra_len-d.length,d.head.extra||(d.head.extra=new Array(d.head.extra_len)),o.arraySet(d.head.extra,W,q,ee,c)),512&d.flags&&(d.check=s(d.check,W,ee,q)),C-=ee,q+=ee,d.length-=ee),d.length))break e;d.length=0,d.mode=7;case 7:if(2048&d.flags){if(C===0)break e;for(ee=0;c=W[q+ee++],d.head&&c&&d.length<65536&&(d.head.name+=String.fromCharCode(c)),c&&ee<C;);if(512&d.flags&&(d.check=s(d.check,W,ee,q)),C-=ee,q+=ee,c)break e}else d.head&&(d.head.name=null);d.length=0,d.mode=8;case 8:if(4096&d.flags){if(C===0)break e;for(ee=0;c=W[q+ee++],d.head&&c&&d.length<65536&&(d.head.comment+=String.fromCharCode(c)),c&&ee<C;);if(512&d.flags&&(d.check=s(d.check,W,ee,q)),C-=ee,q+=ee,c)break e}else d.head&&(d.head.comment=null);d.mode=9;case 9:if(512&d.flags){for(;O<16;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}if(z!==(65535&d.check)){M.msg="header crc mismatch",d.mode=30;break}O=z=0}d.head&&(d.head.hcrc=d.flags>>9&1,d.head.done=!0),M.adler=d.check=0,d.mode=12;break;case 10:for(;O<32;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}M.adler=d.check=_(z),O=z=0,d.mode=11;case 11:if(d.havedict===0)return M.next_out=me,M.avail_out=he,M.next_in=q,M.avail_in=C,d.hold=z,d.bits=O,2;M.adler=d.check=1,d.mode=12;case 12:if(V===5||V===6)break e;case 13:if(d.last){z>>>=7&O,O-=7&O,d.mode=27;break}for(;O<3;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}switch(d.last=1&z,O-=1,3&(z>>>=1)){case 0:d.mode=14;break;case 1:if(Q(d),d.mode=20,V!==6)break;z>>>=2,O-=2;break e;case 2:d.mode=17;break;case 3:M.msg="invalid block type",d.mode=30}z>>>=2,O-=2;break;case 14:for(z>>>=7&O,O-=7&O;O<32;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}if((65535&z)!=(z>>>16^65535)){M.msg="invalid stored block lengths",d.mode=30;break}if(d.length=65535&z,O=z=0,d.mode=15,V===6)break e;case 15:d.mode=16;case 16:if(ee=d.length){if(C<ee&&(ee=C),he<ee&&(ee=he),ee===0)break e;o.arraySet(de,W,q,ee,me),C-=ee,q+=ee,he-=ee,me+=ee,d.length-=ee;break}d.mode=12;break;case 17:for(;O<14;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}if(d.nlen=257+(31&z),z>>>=5,O-=5,d.ndist=1+(31&z),z>>>=5,O-=5,d.ncode=4+(15&z),z>>>=4,O-=4,286<d.nlen||30<d.ndist){M.msg="too many length or distance symbols",d.mode=30;break}d.have=0,d.mode=18;case 18:for(;d.have<d.ncode;){for(;O<3;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}d.lens[Z[d.have++]]=7&z,z>>>=3,O-=3}for(;d.have<19;)d.lens[Z[d.have++]]=0;if(d.lencode=d.lendyn,d.lenbits=7,N={bits:d.lenbits},j=v(0,d.lens,0,19,d.lencode,0,d.work,N),d.lenbits=N.bits,j){M.msg="invalid code lengths set",d.mode=30;break}d.have=0,d.mode=19;case 19:for(;d.have<d.nlen+d.ndist;){for(;Se=(P=d.lencode[z&(1<<d.lenbits)-1])>>>16&255,ze=65535&P,!((ve=P>>>24)<=O);){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}if(ze<16)z>>>=ve,O-=ve,d.lens[d.have++]=ze;else{if(ze===16){for(B=ve+2;O<B;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}if(z>>>=ve,O-=ve,d.have===0){M.msg="invalid bit length repeat",d.mode=30;break}c=d.lens[d.have-1],ee=3+(3&z),z>>>=2,O-=2}else if(ze===17){for(B=ve+3;O<B;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}O-=ve,c=0,ee=3+(7&(z>>>=ve)),z>>>=3,O-=3}else{for(B=ve+7;O<B;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}O-=ve,c=0,ee=11+(127&(z>>>=ve)),z>>>=7,O-=7}if(d.have+ee>d.nlen+d.ndist){M.msg="invalid bit length repeat",d.mode=30;break}for(;ee--;)d.lens[d.have++]=c}}if(d.mode===30)break;if(d.lens[256]===0){M.msg="invalid code -- missing end-of-block",d.mode=30;break}if(d.lenbits=9,N={bits:d.lenbits},j=v(S,d.lens,0,d.nlen,d.lencode,0,d.work,N),d.lenbits=N.bits,j){M.msg="invalid literal/lengths set",d.mode=30;break}if(d.distbits=6,d.distcode=d.distdyn,N={bits:d.distbits},j=v(p,d.lens,d.nlen,d.ndist,d.distcode,0,d.work,N),d.distbits=N.bits,j){M.msg="invalid distances set",d.mode=30;break}if(d.mode=20,V===6)break e;case 20:d.mode=21;case 21:if(6<=C&&258<=he){M.next_out=me,M.avail_out=he,M.next_in=q,M.avail_in=C,d.hold=z,d.bits=O,f(M,te),me=M.next_out,de=M.output,he=M.avail_out,q=M.next_in,W=M.input,C=M.avail_in,z=d.hold,O=d.bits,d.mode===12&&(d.back=-1);break}for(d.back=0;Se=(P=d.lencode[z&(1<<d.lenbits)-1])>>>16&255,ze=65535&P,!((ve=P>>>24)<=O);){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}if(Se&&!(240&Se)){for(Ne=ve,st=Se,it=ze;Se=(P=d.lencode[it+((z&(1<<Ne+st)-1)>>Ne)])>>>16&255,ze=65535&P,!(Ne+(ve=P>>>24)<=O);){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}z>>>=Ne,O-=Ne,d.back+=Ne}if(z>>>=ve,O-=ve,d.back+=ve,d.length=ze,Se===0){d.mode=26;break}if(32&Se){d.back=-1,d.mode=12;break}if(64&Se){M.msg="invalid literal/length code",d.mode=30;break}d.extra=15&Se,d.mode=22;case 22:if(d.extra){for(B=d.extra;O<B;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}d.length+=z&(1<<d.extra)-1,z>>>=d.extra,O-=d.extra,d.back+=d.extra}d.was=d.length,d.mode=23;case 23:for(;Se=(P=d.distcode[z&(1<<d.distbits)-1])>>>16&255,ze=65535&P,!((ve=P>>>24)<=O);){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}if(!(240&Se)){for(Ne=ve,st=Se,it=ze;Se=(P=d.distcode[it+((z&(1<<Ne+st)-1)>>Ne)])>>>16&255,ze=65535&P,!(Ne+(ve=P>>>24)<=O);){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}z>>>=Ne,O-=Ne,d.back+=Ne}if(z>>>=ve,O-=ve,d.back+=ve,64&Se){M.msg="invalid distance code",d.mode=30;break}d.offset=ze,d.extra=15&Se,d.mode=24;case 24:if(d.extra){for(B=d.extra;O<B;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}d.offset+=z&(1<<d.extra)-1,z>>>=d.extra,O-=d.extra,d.back+=d.extra}if(d.offset>d.dmax){M.msg="invalid distance too far back",d.mode=30;break}d.mode=25;case 25:if(he===0)break e;if(ee=te-he,d.offset>ee){if((ee=d.offset-ee)>d.whave&&d.sane){M.msg="invalid distance too far back",d.mode=30;break}Re=ee>d.wnext?(ee-=d.wnext,d.wsize-ee):d.wnext-ee,ee>d.length&&(ee=d.length),Ze=d.window}else Ze=de,Re=me-d.offset,ee=d.length;for(he<ee&&(ee=he),he-=ee,d.length-=ee;de[me++]=Ze[Re++],--ee;);d.length===0&&(d.mode=21);break;case 26:if(he===0)break e;de[me++]=d.length,he--,d.mode=21;break;case 27:if(d.wrap){for(;O<32;){if(C===0)break e;C--,z|=W[q++]<<O,O+=8}if(te-=he,M.total_out+=te,d.total+=te,te&&(M.adler=d.check=d.flags?s(d.check,de,te,me-te):l(d.check,de,te,me-te)),te=he,(d.flags?z:_(z))!==d.check){M.msg="incorrect data check",d.mode=30;break}O=z=0}d.mode=28;case 28:if(d.wrap&&d.flags){for(;O<32;){if(C===0)break e;C--,z+=W[q++]<<O,O+=8}if(z!==(4294967295&d.total)){M.msg="incorrect length check",d.mode=30;break}O=z=0}d.mode=29;case 29:j=1;break e;case 30:j=-3;break e;case 31:return-4;case 32:default:return m}return M.next_out=me,M.avail_out=he,M.next_in=q,M.avail_in=C,d.hold=z,d.bits=O,(d.wsize||te!==M.avail_out&&d.mode<30&&(d.mode<27||V!==4))&&ae(M,M.output,M.next_out,te-M.avail_out)?(d.mode=31,-4):(ie-=M.avail_in,te-=M.avail_out,M.total_in+=ie,M.total_out+=te,d.total+=te,d.wrap&&te&&(M.adler=d.check=d.flags?s(d.check,de,te,M.next_out-te):l(d.check,de,te,M.next_out-te)),M.data_type=d.bits+(d.last?64:0)+(d.mode===12?128:0)+(d.mode===20||d.mode===15?256:0),(ie==0&&te===0||V===4)&&j===E&&(j=-5),j)},a.inflateEnd=function(M){if(!M||!M.state)return m;var V=M.state;return V.window&&(V.window=null),M.state=null,E},a.inflateGetHeader=function(M,V){var d;return M&&M.state&&2&(d=M.state).wrap?((d.head=V).done=!1,E):m},a.inflateSetDictionary=function(M,V){var d,W=V.length;return M&&M.state?(d=M.state).wrap!==0&&d.mode!==11?m:d.mode===11&&l(1,V,W,0)!==d.check?-3:ae(M,V,W,W)?(d.mode=31,-4):(d.havedict=1,E):m},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,i,a){var o=n("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],v=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(S,p,E,m,w,h,b,_){var y,T,D,A,H,U,K,R,Q,ae=_.bits,M=0,V=0,d=0,W=0,de=0,q=0,me=0,C=0,he=0,z=0,O=null,ie=0,te=new o.Buf16(16),ee=new o.Buf16(16),Re=null,Ze=0;for(M=0;M<=15;M++)te[M]=0;for(V=0;V<m;V++)te[p[E+V]]++;for(de=ae,W=15;1<=W&&te[W]===0;W--);if(W<de&&(de=W),W===0)return w[h++]=20971520,w[h++]=20971520,_.bits=1,0;for(d=1;d<W&&te[d]===0;d++);for(de<d&&(de=d),M=C=1;M<=15;M++)if(C<<=1,(C-=te[M])<0)return-1;if(0<C&&(S===0||W!==1))return-1;for(ee[1]=0,M=1;M<15;M++)ee[M+1]=ee[M]+te[M];for(V=0;V<m;V++)p[E+V]!==0&&(b[ee[p[E+V]]++]=V);if(U=S===0?(O=Re=b,19):S===1?(O=l,ie-=257,Re=s,Ze-=257,256):(O=f,Re=v,-1),M=d,H=h,me=V=z=0,D=-1,A=(he=1<<(q=de))-1,S===1&&852<he||S===2&&592<he)return 1;for(;;){for(K=M-me,Q=b[V]<U?(R=0,b[V]):b[V]>U?(R=Re[Ze+b[V]],O[ie+b[V]]):(R=96,0),y=1<<M-me,d=T=1<<q;w[H+(z>>me)+(T-=y)]=K<<24|R<<16|Q|0,T!==0;);for(y=1<<M-1;z&y;)y>>=1;if(y!==0?(z&=y-1,z+=y):z=0,V++,--te[M]==0){if(M===W)break;M=p[E+b[V]]}if(de<M&&(z&A)!==D){for(me===0&&(me=de),H+=d,C=1<<(q=M-me);q+me<W&&!((C-=te[q+me])<=0);)q++,C<<=1;if(he+=1<<q,S===1&&852<he||S===2&&592<he)return 1;w[D=z&A]=de<<24|q<<16|H-h|0}}return z!==0&&(w[H+z]=M-me<<24|64<<16|0),_.bits=de,0}},{"../utils/common":41}],51:[function(n,i,a){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,i,a){var o=n("../utils/common"),l=0,s=1;function f(P){for(var L=P.length;0<=--L;)P[L]=0}var v=0,S=29,p=256,E=p+1+S,m=30,w=19,h=2*E+1,b=15,_=16,y=7,T=256,D=16,A=17,H=18,U=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],K=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=new Array(2*(E+2));f(ae);var M=new Array(2*m);f(M);var V=new Array(512);f(V);var d=new Array(256);f(d);var W=new Array(S);f(W);var de,q,me,C=new Array(m);function he(P,L,Z,Y,F){this.static_tree=P,this.extra_bits=L,this.extra_base=Z,this.elems=Y,this.max_length=F,this.has_stree=P&&P.length}function z(P,L){this.dyn_tree=P,this.max_code=0,this.stat_desc=L}function O(P){return P<256?V[P]:V[256+(P>>>7)]}function ie(P,L){P.pending_buf[P.pending++]=255&L,P.pending_buf[P.pending++]=L>>>8&255}function te(P,L,Z){P.bi_valid>_-Z?(P.bi_buf|=L<<P.bi_valid&65535,ie(P,P.bi_buf),P.bi_buf=L>>_-P.bi_valid,P.bi_valid+=Z-_):(P.bi_buf|=L<<P.bi_valid&65535,P.bi_valid+=Z)}function ee(P,L,Z){te(P,Z[2*L],Z[2*L+1])}function Re(P,L){for(var Z=0;Z|=1&P,P>>>=1,Z<<=1,0<--L;);return Z>>>1}function Ze(P,L,Z){var Y,F,$=new Array(b+1),ne=0;for(Y=1;Y<=b;Y++)$[Y]=ne=ne+Z[Y-1]<<1;for(F=0;F<=L;F++){var J=P[2*F+1];J!==0&&(P[2*F]=Re($[J]++,J))}}function ve(P){var L;for(L=0;L<E;L++)P.dyn_ltree[2*L]=0;for(L=0;L<m;L++)P.dyn_dtree[2*L]=0;for(L=0;L<w;L++)P.bl_tree[2*L]=0;P.dyn_ltree[2*T]=1,P.opt_len=P.static_len=0,P.last_lit=P.matches=0}function Se(P){8<P.bi_valid?ie(P,P.bi_buf):0<P.bi_valid&&(P.pending_buf[P.pending++]=P.bi_buf),P.bi_buf=0,P.bi_valid=0}function ze(P,L,Z,Y){var F=2*L,$=2*Z;return P[F]<P[$]||P[F]===P[$]&&Y[L]<=Y[Z]}function Ne(P,L,Z){for(var Y=P.heap[Z],F=Z<<1;F<=P.heap_len&&(F<P.heap_len&&ze(L,P.heap[F+1],P.heap[F],P.depth)&&F++,!ze(L,Y,P.heap[F],P.depth));)P.heap[Z]=P.heap[F],Z=F,F<<=1;P.heap[Z]=Y}function st(P,L,Z){var Y,F,$,ne,J=0;if(P.last_lit!==0)for(;Y=P.pending_buf[P.d_buf+2*J]<<8|P.pending_buf[P.d_buf+2*J+1],F=P.pending_buf[P.l_buf+J],J++,Y===0?ee(P,F,L):(ee(P,($=d[F])+p+1,L),(ne=U[$])!==0&&te(P,F-=W[$],ne),ee(P,$=O(--Y),Z),(ne=K[$])!==0&&te(P,Y-=C[$],ne)),J<P.last_lit;);ee(P,T,L)}function it(P,L){var Z,Y,F,$=L.dyn_tree,ne=L.stat_desc.static_tree,J=L.stat_desc.has_stree,ce=L.stat_desc.elems,Te=-1;for(P.heap_len=0,P.heap_max=h,Z=0;Z<ce;Z++)$[2*Z]!==0?(P.heap[++P.heap_len]=Te=Z,P.depth[Z]=0):$[2*Z+1]=0;for(;P.heap_len<2;)$[2*(F=P.heap[++P.heap_len]=Te<2?++Te:0)]=1,P.depth[F]=0,P.opt_len--,J&&(P.static_len-=ne[2*F+1]);for(L.max_code=Te,Z=P.heap_len>>1;1<=Z;Z--)Ne(P,$,Z);for(F=ce;Z=P.heap[1],P.heap[1]=P.heap[P.heap_len--],Ne(P,$,1),Y=P.heap[1],P.heap[--P.heap_max]=Z,P.heap[--P.heap_max]=Y,$[2*F]=$[2*Z]+$[2*Y],P.depth[F]=(P.depth[Z]>=P.depth[Y]?P.depth[Z]:P.depth[Y])+1,$[2*Z+1]=$[2*Y+1]=F,P.heap[1]=F++,Ne(P,$,1),2<=P.heap_len;);P.heap[--P.heap_max]=P.heap[1],function(pe,tt){var Dt,lt,Ft,Ue,Wt,ir,dt=tt.dyn_tree,gr=tt.max_code,vr=tt.stat_desc.static_tree,br=tt.stat_desc.has_stree,wr=tt.stat_desc.extra_bits,ar=tt.stat_desc.extra_base,Ot=tt.stat_desc.max_length,Ht=0;for(Ue=0;Ue<=b;Ue++)pe.bl_count[Ue]=0;for(dt[2*pe.heap[pe.heap_max]+1]=0,Dt=pe.heap_max+1;Dt<h;Dt++)Ot<(Ue=dt[2*dt[2*(lt=pe.heap[Dt])+1]+1]+1)&&(Ue=Ot,Ht++),dt[2*lt+1]=Ue,gr<lt||(pe.bl_count[Ue]++,Wt=0,ar<=lt&&(Wt=wr[lt-ar]),ir=dt[2*lt],pe.opt_len+=ir*(Ue+Wt),br&&(pe.static_len+=ir*(vr[2*lt+1]+Wt)));if(Ht!==0){do{for(Ue=Ot-1;pe.bl_count[Ue]===0;)Ue--;pe.bl_count[Ue]--,pe.bl_count[Ue+1]+=2,pe.bl_count[Ot]--,Ht-=2}while(0<Ht);for(Ue=Ot;Ue!==0;Ue--)for(lt=pe.bl_count[Ue];lt!==0;)gr<(Ft=pe.heap[--Dt])||(dt[2*Ft+1]!==Ue&&(pe.opt_len+=(Ue-dt[2*Ft+1])*dt[2*Ft],dt[2*Ft+1]=Ue),lt--)}}(P,L),Ze($,Te,P.bl_count)}function c(P,L,Z){var Y,F,$=-1,ne=L[1],J=0,ce=7,Te=4;for(ne===0&&(ce=138,Te=3),L[2*(Z+1)+1]=65535,Y=0;Y<=Z;Y++)F=ne,ne=L[2*(Y+1)+1],++J<ce&&F===ne||(J<Te?P.bl_tree[2*F]+=J:F!==0?(F!==$&&P.bl_tree[2*F]++,P.bl_tree[2*D]++):J<=10?P.bl_tree[2*A]++:P.bl_tree[2*H]++,$=F,Te=(J=0)===ne?(ce=138,3):F===ne?(ce=6,3):(ce=7,4))}function j(P,L,Z){var Y,F,$=-1,ne=L[1],J=0,ce=7,Te=4;for(ne===0&&(ce=138,Te=3),Y=0;Y<=Z;Y++)if(F=ne,ne=L[2*(Y+1)+1],!(++J<ce&&F===ne)){if(J<Te)for(;ee(P,F,P.bl_tree),--J!=0;);else F!==0?(F!==$&&(ee(P,F,P.bl_tree),J--),ee(P,D,P.bl_tree),te(P,J-3,2)):J<=10?(ee(P,A,P.bl_tree),te(P,J-3,3)):(ee(P,H,P.bl_tree),te(P,J-11,7));$=F,Te=(J=0)===ne?(ce=138,3):F===ne?(ce=6,3):(ce=7,4)}}f(C);var N=!1;function B(P,L,Z,Y){te(P,(v<<1)+(Y?1:0),3),function(F,$,ne,J){Se(F),J&&(ie(F,ne),ie(F,~ne)),o.arraySet(F.pending_buf,F.window,$,ne,F.pending),F.pending+=ne}(P,L,Z,!0)}a._tr_init=function(P){N||(function(){var L,Z,Y,F,$,ne=new Array(b+1);for(F=Y=0;F<S-1;F++)for(W[F]=Y,L=0;L<1<<U[F];L++)d[Y++]=F;for(d[Y-1]=F,F=$=0;F<16;F++)for(C[F]=$,L=0;L<1<<K[F];L++)V[$++]=F;for($>>=7;F<m;F++)for(C[F]=$<<7,L=0;L<1<<K[F]-7;L++)V[256+$++]=F;for(Z=0;Z<=b;Z++)ne[Z]=0;for(L=0;L<=143;)ae[2*L+1]=8,L++,ne[8]++;for(;L<=255;)ae[2*L+1]=9,L++,ne[9]++;for(;L<=279;)ae[2*L+1]=7,L++,ne[7]++;for(;L<=287;)ae[2*L+1]=8,L++,ne[8]++;for(Ze(ae,E+1,ne),L=0;L<m;L++)M[2*L+1]=5,M[2*L]=Re(L,5);de=new he(ae,U,p+1,E,b),q=new he(M,K,0,m,b),me=new he(new Array(0),R,0,w,y)}(),N=!0),P.l_desc=new z(P.dyn_ltree,de),P.d_desc=new z(P.dyn_dtree,q),P.bl_desc=new z(P.bl_tree,me),P.bi_buf=0,P.bi_valid=0,ve(P)},a._tr_stored_block=B,a._tr_flush_block=function(P,L,Z,Y){var F,$,ne=0;0<P.level?(P.strm.data_type===2&&(P.strm.data_type=function(J){var ce,Te=4093624447;for(ce=0;ce<=31;ce++,Te>>>=1)if(1&Te&&J.dyn_ltree[2*ce]!==0)return l;if(J.dyn_ltree[18]!==0||J.dyn_ltree[20]!==0||J.dyn_ltree[26]!==0)return s;for(ce=32;ce<p;ce++)if(J.dyn_ltree[2*ce]!==0)return s;return l}(P)),it(P,P.l_desc),it(P,P.d_desc),ne=function(J){var ce;for(c(J,J.dyn_ltree,J.l_desc.max_code),c(J,J.dyn_dtree,J.d_desc.max_code),it(J,J.bl_desc),ce=w-1;3<=ce&&J.bl_tree[2*Q[ce]+1]===0;ce--);return J.opt_len+=3*(ce+1)+5+5+4,ce}(P),F=P.opt_len+3+7>>>3,($=P.static_len+3+7>>>3)<=F&&(F=$)):F=$=Z+5,Z+4<=F&&L!==-1?B(P,L,Z,Y):P.strategy===4||$===F?(te(P,2+(Y?1:0),3),st(P,ae,M)):(te(P,4+(Y?1:0),3),function(J,ce,Te,pe){var tt;for(te(J,ce-257,5),te(J,Te-1,5),te(J,pe-4,4),tt=0;tt<pe;tt++)te(J,J.bl_tree[2*Q[tt]+1],3);j(J,J.dyn_ltree,ce-1),j(J,J.dyn_dtree,Te-1)}(P,P.l_desc.max_code+1,P.d_desc.max_code+1,ne+1),st(P,P.dyn_ltree,P.dyn_dtree)),ve(P),Y&&Se(P)},a._tr_tally=function(P,L,Z){return P.pending_buf[P.d_buf+2*P.last_lit]=L>>>8&255,P.pending_buf[P.d_buf+2*P.last_lit+1]=255&L,P.pending_buf[P.l_buf+P.last_lit]=255&Z,P.last_lit++,L===0?P.dyn_ltree[2*Z]++:(P.matches++,L--,P.dyn_ltree[2*(d[Z]+p+1)]++,P.dyn_dtree[2*O(L)]++),P.last_lit===P.lit_bufsize-1},a._tr_align=function(P){te(P,2,3),ee(P,T,ae),function(L){L.bi_valid===16?(ie(L,L.bi_buf),L.bi_buf=0,L.bi_valid=0):8<=L.bi_valid&&(L.pending_buf[L.pending++]=255&L.bi_buf,L.bi_buf>>=8,L.bi_valid-=8)}(P)}},{"../utils/common":41}],53:[function(n,i,a){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,i,a){(function(o){(function(l,s){if(!l.setImmediate){var f,v,S,p,E=1,m={},w=!1,h=l.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(l);b=b&&b.setTimeout?b:l,f={}.toString.call(l.process)==="[object process]"?function(D){process.nextTick(function(){y(D)})}:function(){if(l.postMessage&&!l.importScripts){var D=!0,A=l.onmessage;return l.onmessage=function(){D=!1},l.postMessage("","*"),l.onmessage=A,D}}()?(p="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",T,!1):l.attachEvent("onmessage",T),function(D){l.postMessage(p+D,"*")}):l.MessageChannel?((S=new MessageChannel).port1.onmessage=function(D){y(D.data)},function(D){S.port2.postMessage(D)}):h&&"onreadystatechange"in h.createElement("script")?(v=h.documentElement,function(D){var A=h.createElement("script");A.onreadystatechange=function(){y(D),A.onreadystatechange=null,v.removeChild(A),A=null},v.appendChild(A)}):function(D){setTimeout(y,0,D)},b.setImmediate=function(D){typeof D!="function"&&(D=new Function(""+D));for(var A=new Array(arguments.length-1),H=0;H<A.length;H++)A[H]=arguments[H+1];var U={callback:D,args:A};return m[E]=U,f(E),E++},b.clearImmediate=_}function _(D){delete m[D]}function y(D){if(w)setTimeout(y,0,D);else{var A=m[D];if(A){w=!0;try{(function(H){var U=H.callback,K=H.args;switch(K.length){case 0:U();break;case 1:U(K[0]);break;case 2:U(K[0],K[1]);break;case 3:U(K[0],K[1],K[2]);break;default:U.apply(s,K)}})(A)}finally{_(D),w=!1}}}}function T(D){D.source===l&&typeof D.data=="string"&&D.data.indexOf(p)===0&&y(+D.data.slice(p.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof Br<"u"?Br:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Hn);var ta=Hn.exports;const ra=Ui(ta);class Tr{constructor(){this.comboColors=[]}clone(){const r=new Tr;return r.comboColors=this.comboColors.map(n=>n.clone()),this.sliderTrackColor&&(r.sliderTrackColor=this.sliderTrackColor),this.sliderBorderColor&&(r.sliderBorderColor=this.sliderBorderColor),r}}class Vt{constructor(){this._CS=Vt.BASE_DIFFICULTY,this._HP=Vt.BASE_DIFFICULTY,this._OD=Vt.BASE_DIFFICULTY,this._multiplier=1,this._tickRate=1,this._rate=1}get circleSize(){return Math.fround(this._CS)}set circleSize(r){this._CS=r}get drainRate(){return Math.fround(this._HP)}set drainRate(r){this._HP=r}get overallDifficulty(){return Math.fround(this._OD)}set overallDifficulty(r){this._OD=r}get approachRate(){let r;return Math.fround((r=this._AR)!==null&&r!==void 0?r:this._OD)}set approachRate(r){this._AR=r}get sliderMultiplier(){return this._multiplier}set sliderMultiplier(r){this._multiplier=r}get sliderTickRate(){return this._tickRate}set sliderTickRate(r){this._tickRate=r}get clockRate(){return this._rate}set clockRate(r){this._rate=r}clone(){const r=new Vt;return r.circleSize=this._CS,r.drainRate=this._HP,r.overallDifficulty=this._OD,typeof this._AR=="number"&&(r.approachRate=this._AR),r.sliderMultiplier=this._multiplier,r.sliderTickRate=this._tickRate,r.clockRate=this._rate,r}static range(r,n,i,a){return r>5?i+(a-i)*(r-5)/5:r<5?i-(i-n)*(5-r)/5:i}}Vt.BASE_DIFFICULTY=5;class Yr{constructor(){this.bookmarks=[],this.distanceSpacing=1,this.beatDivisor=4,this.gridSize=1,this.timelineZoom=2}clone(){const r=new Yr;return r.bookmarks=this.bookmarks.slice(),r.distanceSpacing=this.distanceSpacing,r.beatDivisor=this.beatDivisor,r.gridSize=this.gridSize,r.timelineZoom=this.timelineZoom,r}}let An;(function(t){t[t.AdditiveBlending=0]="AdditiveBlending",t[t.AlphaBlending=1]="AlphaBlending"})(An||(An={}));class He{constructor(r){this.source=r.source||0,this.destination=r.destination||0,this.sourceAlpha=r.sourceAlpha||0,this.destinationAlpha=r.destinationAlpha||0,this.rgbEquation=r.rgbEquation||0,this.alphaEquation=r.alphaEquation||0}copyFromParent(r){this.source===0&&(this.source=r.source),this.destination===0&&(this.destination=r.destination),this.sourceAlpha===0&&(this.sourceAlpha=r.sourceAlpha),this.destinationAlpha===0&&(this.destinationAlpha=r.destinationAlpha),this.rgbEquation===0&&(this.rgbEquation=r.rgbEquation),this.alphaEquation===0&&(this.alphaEquation=r.alphaEquation)}applyDefaultToInherited(){this.source===0&&(this.source=12),this.destination===0&&(this.destination=10),this.sourceAlpha===0&&(this.sourceAlpha=5),this.destinationAlpha===0&&(this.destinationAlpha=5),this.rgbEquation===0&&(this.rgbEquation=1),this.alphaEquation===0&&(this.alphaEquation=1)}equals(r){return r.source===this.source&&r.destination===this.destination&&r.sourceAlpha===this.sourceAlpha&&r.destinationAlpha===this.destinationAlpha&&r.rgbEquation===this.rgbEquation&&r.alphaEquation===this.alphaEquation}get isDisabled(){return this.source===5&&this.destination===15&&this.sourceAlpha===5&&this.destinationAlpha===15&&this.rgbEquation===1&&this.alphaEquation===1}get rgbEquationMode(){return He._translateEquation(this.rgbEquation)}get alphaEquationMode(){return He._translateEquation(this.alphaEquation)}get sourceBlendingFactor(){return He._translateBlendingFactorSrc(this.source)}get destinationBlendingFactor(){return He._translateBlendingFactorDest(this.destination)}get sourceAlphaBlendingFactor(){return He._translateBlendingFactorSrc(this.sourceAlpha)}get destinationAlphaBlendingFactor(){return He._translateBlendingFactorDest(this.destinationAlpha)}static _translateBlendingFactorSrc(r){switch(r){case 1:return 32771;case 2:return 32769;case 3:return 772;case 4:return 774;case 5:return 1;case 6:return 32772;case 7:return 32770;case 8:return 773;case 9:return 775;case 10:return 769;case 12:return 770;case 13:return 776;case 14:return 768;default:case 15:return 0}}static _translateBlendingFactorDest(r){switch(r){case 1:return 32771;case 2:return 32769;case 3:return 772;case 4:return 774;case 5:return 1;case 6:return 32772;case 7:return 32770;case 8:return 773;case 9:return 775;case 10:return 771;case 11:return 769;case 12:return 770;case 13:return 776;case 14:return 768;default:case 15:return 0}}static _translateEquation(r){switch(r){default:case 0:case 1:return 32774;case 2:return 32775;case 3:return 32776;case 4:return 32778;case 5:return 32779}}}He.None=new He({source:5,destination:15,sourceAlpha:5,destinationAlpha:15,rgbEquation:1,alphaEquation:1});He.Inherit=new He({source:0,destination:0,sourceAlpha:0,destinationAlpha:0,rgbEquation:0,alphaEquation:0});He.Mixture=new He({source:12,destination:10,sourceAlpha:5,destinationAlpha:5,rgbEquation:1,alphaEquation:1});He.Additive=new He({source:12,destination:5,sourceAlpha:5,destinationAlpha:5,rgbEquation:1,alphaEquation:1});let ot;(function(t){t[t.y0=1]="y0",t[t.y1=2]="y1",t[t.y2=4]="y2",t[t.x0=8]="x0",t[t.x1=16]="x1",t[t.x2=32]="x2",t[t.Custom=64]="Custom",t[t.TopLeft=9]="TopLeft",t[t.TopCentre=17]="TopCentre",t[t.TopRight=33]="TopRight",t[t.CentreLeft=10]="CentreLeft",t[t.Centre=18]="Centre",t[t.CentreRight=34]="CentreRight",t[t.BottomLeft=12]="BottomLeft",t[t.BottomCentre=20]="BottomCentre",t[t.BottomRight=36]="BottomRight"})(ot||(ot={}));let xe;(function(t){t.None="",t.Movement="M",t.MovementX="MX",t.MovementY="MY",t.Fade="F",t.Scale="S",t.VectorScale="V",t.Rotation="R",t.Color="C",t.Parameter="P"})(xe||(xe={}));let $t;(function(t){t.None="",t.Loop="L",t.Trigger="T"})($t||($t={}));let qe;(function(t){t[t.Background=0]="Background",t[t.Video=1]="Video",t[t.Break=2]="Break",t[t.Colour=3]="Colour",t[t.Sprite=4]="Sprite",t[t.Sample=5]="Sample",t[t.Animation=6]="Animation",t[t.StoryboardCommand=7]="StoryboardCommand"})(qe||(qe={}));let ut;(function(t){t[t.Background=0]="Background",t[t.Fail=1]="Fail",t[t.Pass=2]="Pass",t[t.Foreground=3]="Foreground",t[t.Overlay=4]="Overlay",t[t.Video=5]="Video"})(ut||(ut={}));let hr;(function(t){t[t.LoopForever=0]="LoopForever",t[t.LoopOnce=1]="LoopOnce"})(hr||(hr={}));let $e;(function(t){t[t.TopLeft=0]="TopLeft",t[t.Centre=1]="Centre",t[t.CentreLeft=2]="CentreLeft",t[t.TopRight=3]="TopRight",t[t.BottomCentre=4]="BottomCentre",t[t.TopCentre=5]="TopCentre",t[t.Custom=6]="Custom",t[t.CentreRight=7]="CentreRight",t[t.BottomLeft=8]="BottomLeft",t[t.BottomRight=9]="BottomRight"})($e||($e={}));let xt;(function(t){t.None="",t.HorizontalFlip="H",t.VerticalFlip="V",t.BlendingMode="A"})(xt||(xt={}));class Lt{constructor(r,n,i,a){this.red=r??255,this.green=n??255,this.blue=i??255,this.alpha=a??1}get hex(){const r=Math.round(this.alpha*255);return"#"+this.red.toString(16).padStart(2,"0")+this.green.toString(16).padStart(2,"0")+this.blue.toString(16).padStart(2,"0")+r.toString(16).padStart(2,"0")}equals(r){return this.red===r.red&&this.green===r.green&&this.blue===r.blue&&this.alpha===r.alpha}clone(){return new Lt(this.red,this.green,this.blue,this.alpha)}toString(){return`${this.red},${this.green},${this.blue},${this.alpha}`}}class Me{constructor(r,n){this.x=r,this.y=isFinite(n)?n:r}get floatX(){return Math.fround(this.x)}get floatY(){return Math.fround(this.y)}add(r){return new Me(this.x+r.x,this.y+r.y)}fadd(r){return new Me(Math.fround(this.floatX+r.floatX),Math.fround(this.floatY+r.floatY))}subtract(r){return new Me(this.x-r.x,this.y-r.y)}fsubtract(r){return new Me(Math.fround(this.floatX-r.floatX),Math.fround(this.floatY-r.floatY))}scale(r){return new Me(this.x*r,this.y*r)}fscale(r){const n=Math.fround(r);return new Me(Math.fround(this.floatX*n),Math.fround(this.floatY*n))}divide(r){return new Me(this.x/r,this.y/r)}fdivide(r){const n=Math.fround(r);return new Me(Math.fround(this.floatX/n),Math.fround(this.floatY/n))}dot(r){return this.x*r.x+this.y*r.y}fdot(r){return Math.fround(Math.fround(Math.fround(this.floatX*r.floatX)+Math.fround(this.floatY*r.floatY)))}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}flength(){return Math.fround(Math.sqrt(Math.fround(Math.fround(this.floatX*this.floatX)+Math.fround(this.floatY*this.floatY))))}distance(r){const n=this.x-r.x,i=this.y-r.y;return Math.sqrt(n*n+i*i)}fdistance(r){const n=Math.fround(this.floatX-r.floatX),i=Math.fround(this.floatY-r.floatY);return Math.fround(Math.sqrt(Math.fround(Math.fround(n*n)+Math.fround(i*i))))}normalize(){const r=1/this.length();return new Me(this.x*r,this.y*r)}fnormalize(){const r=Math.fround(1/this.flength());return new Me(Math.fround(this.floatX*r),Math.fround(this.floatY*r))}equals(r){return this.x===r.x&&this.y===r.y}clone(){return new Me(this.x,this.y)}toString(){return`${this.x},${this.y}`}}function Lr(t,r,n){return Math.max(r,Math.min(n,t))}function Zn(t){return Lr(t,0,1)}function na(t,r,n,i,a){return t<r?i:t>=n?a:(t-r)/(n-r)*(a-i)+i}function ia(t,r,n){return na(t,r,n,0,1)}let ge;(function(t){t[t.None=0]="None",t[t.Out=1]="Out",t[t.In=2]="In",t[t.InQuad=3]="InQuad",t[t.OutQuad=4]="OutQuad",t[t.InOutQuad=5]="InOutQuad",t[t.InCubic=6]="InCubic",t[t.OutCubic=7]="OutCubic",t[t.InOutCubic=8]="InOutCubic",t[t.InQuart=9]="InQuart",t[t.OutQuart=10]="OutQuart",t[t.InOutQuart=11]="InOutQuart",t[t.InQuint=12]="InQuint",t[t.OutQuint=13]="OutQuint",t[t.InOutQuint=14]="InOutQuint",t[t.InSine=15]="InSine",t[t.OutSine=16]="OutSine",t[t.InOutSine=17]="InOutSine",t[t.InExpo=18]="InExpo",t[t.OutExpo=19]="OutExpo",t[t.InOutExpo=20]="InOutExpo",t[t.InCirc=21]="InCirc",t[t.OutCirc=22]="OutCirc",t[t.InOutCirc=23]="InOutCirc",t[t.InElastic=24]="InElastic",t[t.OutElastic=25]="OutElastic",t[t.OutElasticHalf=26]="OutElasticHalf",t[t.OutElasticQuarter=27]="OutElasticQuarter",t[t.InOutElastic=28]="InOutElastic",t[t.InBack=29]="InBack",t[t.OutBack=30]="OutBack",t[t.InOutBack=31]="InOutBack",t[t.InBounce=32]="InBounce",t[t.OutBounce=33]="OutBounce",t[t.InOutBounce=34]="InOutBounce",t[t.OutPow10=35]="OutPow10"})(ge||(ge={}));const Mt=2*Math.PI/.3,It=.3/4,mr=1.70158,Mr=mr*1.525,ct=1/2.75,Ir=Math.pow(2,-10),Yn=Math.pow(2,-11),aa=Math.pow(2,-10)*Math.sin((.5-It)*Mt),oa=Math.pow(2,-10)*Math.sin((.25-It)*Mt),Dn=Math.pow(2,-10)*Math.sin((1-It*1.5)*Mt/1.5),we=t=>r=>t(Zn(r)),sa=we(t=>t),la=we(t=>t*t),ua=we(t=>t*(2-t)),ca=we(t=>t<.5?t*t*2:--t*t*-2+1),fa=we(t=>t*t*t),da=we(t=>--t*t*t+1),ha=we(t=>t<.5?t*t*t*4:--t*t*t*4+1),ma=we(t=>t*t*t*t),pa=we(t=>1- --t*t*t*t),_a=we(t=>t<.5?t*t*t*t*8:--t*t*t*t*-8+1),ga=we(t=>t*t*t*t*t),va=we(t=>--t*t*t*t*t+1),ba=we(t=>t<.5?t*t*t*t*t*16:--t*t*t*t*t*16+1),wa=we(t=>1-Math.cos(t*Math.PI*.5)),Sa=we(t=>Math.sin(t*Math.PI*.5)),ka=we(t=>.5-.5*Math.cos(Math.PI*t)),Pa=we(t=>Math.pow(2,10*(t-1))+Ir*(t-1)),Ea=we(t=>-Math.pow(2,-10*t)+1+Ir*t),ya=we(t=>t<.5?.5*(Math.pow(2,20*t-10)+Ir*(2*t-1)):1-.5*(Math.pow(2,-20*t+10)+Ir*(-2*t+1))),Ba=we(t=>1-Math.sqrt(1-t*t)),xa=we(t=>Math.sqrt(1- --t*t)),Ma=we(t=>(t*=2)<1?.5-.5*Math.sqrt(1-t*t):.5*Math.sqrt(1-(t-=2)*t)+.5),Ia=we(t=>-Math.pow(2,-10+10*t)*Math.sin((1-It-t)*Mt)+Yn*(1-t)),Ta=we(t=>Math.pow(2,-10*t)*Math.sin((t-It)*Mt)+1-Yn*t),La=we(t=>Math.pow(2,-10*t)*Math.sin((.5*t-It)*Mt)+1-aa*t),Aa=we(t=>Math.pow(2,-10*t)*Math.sin((.25*t-It)*Mt)+1-oa*t),Da=we(t=>(t*=2)<1?-.5*(Math.pow(2,-10+10*t)*Math.sin((1-It*1.5-t)*Mt/1.5)-Dn*(1-t)):.5*(Math.pow(2,-10*--t)*Math.sin((t-It*1.5)*Mt/1.5)-Dn*t)+1),Fa=we(t=>t*t*((mr+1)*t-mr)),Oa=we(t=>--t*t*((mr+1)*t+mr)+1),Ra=we(t=>(t*=2)<1?.5*t*t*((Mr+1)*t-Mr):.5*((t-=2)*t*((Mr+1)*t+Mr)+2)),za=we(t=>(t=1-t,t<ct?1-7.5625*t*t:t<2*ct?1-(7.5625*(t-=1.5*ct)*t+.75):t<2.5*ct?1-(7.5625*(t-=2.25*ct)*t+.9375):1-(7.5625*(t-=2.625*ct)*t+.984375))),Wr=we(t=>t<ct?7.5625*t*t:t<2*ct?7.5625*(t-=1.5*ct)*t+.75:t<2.5*ct?7.5625*(t-=2.25*ct)*t+.9375:7.5625*(t-=2.625*ct)*t+.984375),Na=we(t=>t<.5?.5-.5*Wr(1-t*2):Wr((t-.5)*2)*.5+.5),Ua=we(t=>--t*Math.pow(t,10)+1);function Ga(t){switch(t){case ge.In:case ge.InQuad:return la;case ge.Out:case ge.OutQuad:return ua;case ge.InOutQuad:return ca;case ge.InCubic:return fa;case ge.OutCubic:return da;case ge.InOutCubic:return ha;case ge.InQuart:return ma;case ge.OutQuart:return pa;case ge.InOutQuart:return _a;case ge.InQuint:return ga;case ge.OutQuint:return va;case ge.InOutQuint:return ba;case ge.InSine:return wa;case ge.OutSine:return Sa;case ge.InOutSine:return ka;case ge.InExpo:return Pa;case ge.OutExpo:return Ea;case ge.InOutExpo:return ya;case ge.InCirc:return Ba;case ge.OutCirc:return xa;case ge.InOutCirc:return Ma;case ge.InElastic:return Ia;case ge.OutElastic:return Ta;case ge.OutElasticHalf:return La;case ge.OutElasticQuarter:return Aa;case ge.InOutElastic:return Da;case ge.InBack:return Fa;case ge.OutBack:return Oa;case ge.InOutBack:return Ra;case ge.InBounce:return za;case ge.OutBounce:return Wr;case ge.InOutBounce:return Na;case ge.OutPow10:return Ua}return sa}class Xr{constructor(r){let n,i,a,o,l,s,f;this.type=(n=r?.type)!==null&&n!==void 0?n:xe.None,this.parameter=(i=r?.parameter)!==null&&i!==void 0?i:xt.None,this.easing=(a=r?.easing)!==null&&a!==void 0?a:ge.None,this.startTime=(o=r?.startTime)!==null&&o!==void 0?o:0,this.endTime=(l=r?.endTime)!==null&&l!==void 0?l:0,this.startValue=(s=r?.startValue)!==null&&s!==void 0?s:null,this.endValue=(f=r?.endValue)!==null&&f!==void 0?f:null}get duration(){return this.endTime-this.startTime}getProgress(r){const n=ia(r,this.startTime,this.endTime);return Ga(this.easing)(n)}getValueAtProgress(r){const n=(o,l,s)=>l+o*(s-l),i=(o,l,s)=>l===s||o>=l&&o<s;if(typeof this.startValue=="number"){const o=this.startValue,l=this.endValue;return n(r,o,l)}if(this.startValue instanceof Me){const o=this.startValue,l=this.endValue;return new Me(n(r,o.floatX,l.floatX),n(r,o.floatY,l.floatY))}if(this.startValue instanceof Lt){const o=this.startValue,l=this.endValue;return new Lt(n(r,o.red,l.red),n(r,o.green,l.green),n(r,o.blue,l.blue),n(r,o.alpha,l.alpha))}const a=this.startTime+this.duration*r;if(typeof this.startValue=="boolean")return i(a,this.startTime,this.endTime);if(this.startValue instanceof He){const o=this.startValue,l=this.endValue;return i(a,this.startTime,this.endTime)?o:l}return this.endValue}getValueAtTime(r){return this.getValueAtProgress(this.getProgress(r))}equals(r){return this.type===r.type&&this.startTime===r.startTime&&this.endTime===r.endTime&&this.startValue===r.startValue&&this.endValue===r.endValue&&this.easing===r.easing&&this.parameter===r.parameter}}class St{constructor(){this._commands=[],this.startTime=1/0,this.endTime=-1/0}[Symbol.iterator](){const r=this.commands;let n=-1;return{next:()=>({value:r[++n],done:!(n in r)})}}get commands(){return this._commands.sort((r,n)=>r.startTime-n.startTime||r.endTime-n.endTime)}add(r,n,i,a,o,l,s){a<i&&([i,a]=[a,i],[o,l]=[l,o]),this._commands.push(new Xr({type:r,easing:n,startTime:i,endTime:a,startValue:o,endValue:l,parameter:s})),i<this.startTime&&(this.startValue=o,this.startTime=i),a>this.endTime&&(this.endValue=l,this.endTime=a)}get hasCommands(){return this._commands.length>0}}class Kr{constructor(){this.x=new St,this.y=new St,this.scale=new St,this.vectorScale=new St,this.rotation=new St,this.color=new St,this.alpha=new St,this.blendingParameters=new St,this.flipH=new St,this.flipV=new St,this._timelines=[this.x,this.y,this.scale,this.vectorScale,this.rotation,this.color,this.alpha,this.blendingParameters,this.flipH,this.flipV]}get timelines(){return this._timelines}get totalCommands(){return this._timelines.reduce((r,n)=>r+n.commands.length,0)}get commands(){return this._timelines.flatMap(r=>r.commands).sort((r,n)=>r.startTime-n.startTime||r.endTime-n.endTime)}get commandsStartTime(){let r=1/0;for(let n=0;n<this._timelines.length;++n)r=Math.min(r,this._timelines[n].startTime);return r}get commandsEndTime(){let r=-1/0;for(let n=0;n<this._timelines.length;++n)r=Math.max(r,this._timelines[n].endTime);return r}get commandsDuration(){return this.commandsEndTime-this.commandsStartTime}get startTime(){return this.commandsStartTime}get endTime(){return this.commandsEndTime}get duration(){return this.endTime-this.startTime}get hasCommands(){for(let r=0;r<this._timelines.length;++r)if(this._timelines[r].hasCommands)return!0;return!1}}class Xn extends Kr{constructor(r,n){super(),this.type=$t.Loop,this.loopStartTime=r||0,this.loopCount=n||0}get totalIterations(){return this.loopCount+1}get startTime(){return this.loopStartTime+this.commandsStartTime}get endTime(){return this.startTime+this.commandsDuration*this.totalIterations}unrollCommands(){const r=this.commands;if(r.length===0)return[];const{commandsDuration:n,totalIterations:i,loopStartTime:a}=this,o=new Array(i*r.length);for(let l=0;l<i;l++){const s=a+l*n;for(let f=0;f<r.length;f++){const v=l*r.length+f,S=r[f];o[v]=new Xr({...S,startTime:S.startTime+s,endTime:S.endTime+s})}}return o}}class Kn extends Kr{constructor(r,n,i,a){super(),this.type=$t.Trigger,this.triggerName=r||"",this.triggerStartTime=n||0,this.triggerEndTime=i||0,this.groupNumber=a||0}unrollCommands(){const r=this.commands;if(r.length===0)return[];const n=new Array(r.length);for(let i=0;i<r.length;i++)n[i]=new Xr({...r[i],startTime:r[i].startTime+this.triggerStartTime,endTime:r[i].endTime+this.triggerStartTime});return n}}class qr{constructor(r,n,i,a){this.startTime=1/0,this.endTime=-1/0,this.commands=[],this.timelineGroup=new Kr,this.loops=[],this.triggers=[],this.scale=new Me(1,1),this.color=new Lt,this.rotation=0,this.flipX=!1,this.flipY=!1,this.isAdditive=!1,this.filePath=r??"",this.origin=n??$e.TopLeft,this.anchor=i??ot.TopLeft,this.startPosition=a??new Me(0,0)}get startX(){return this.startPosition.floatX}set startX(r){this.startPosition.x=r}get startY(){return this.startPosition.floatY}set startY(r){this.startPosition.y=r}get duration(){return this.endTime-this.startTime}get hasCommands(){return this.timelineGroup.hasCommands||this.loops.some(r=>r.hasCommands)||this.triggers.some(r=>r.hasCommands)}get isDrawable(){return this.color.alpha>=.01&&this.hasCommands}addLoop(r,n){const i=new Xn(r,n);return this.loops.push(i),i}addTrigger(r,n,i,a){const o=new Kn(r,n,i,a);return this.triggers.push(o),o}updateCommands(){const r=[...this.timelineGroup.commands,...this.loops.flatMap(n=>n.unrollCommands())];return this.commands=r.sort((n,i)=>n.startTime-i.startTime),this.commands}adjustTimesToCommands(){let r=this.startTime,n=this.endTime;for(const i of this.commands)r=Math.min(r,i.startTime),n=Math.max(n,i.endTime);this.startTime=r,this.endTime=n}resetValuesToCommands(){const r={};for(const n of this.commands)r[n.type]||(this.setValueFromCommand(n,0),r[n.type]=!0)}setValueFromCommand(r,n){const i=r.getValueAtProgress(n);switch(r.type){case xe.Movement:this.startPosition.x=i.x,this.startPosition.y=i.y;break;case xe.MovementX:this.startPosition.x=i;break;case xe.MovementY:this.startPosition.y=i;break;case xe.Fade:this.color.alpha=i;break;case xe.Scale:this.scale.x=i,this.scale.y=i;break;case xe.VectorScale:this.scale.x=i.x,this.scale.y=i.y;break;case xe.Rotation:this.rotation=i;break;case xe.Color:this.color.red=i.red,this.color.green=i.green,this.color.blue=i.blue;break}if(r.type===xe.Parameter)switch(r.parameter){case xt.BlendingMode:this.isAdditive=i.rgbEquation===1;break;case xt.HorizontalFlip:this.flipX=i;break;case xt.VerticalFlip:this.flipY=i}}}class qn extends qr{constructor(r,n,i,a,o,l,s){super(r,n,i,a),this.frameCount=o??0,this.frameDelay=l??0,this.loopType=s??hr.LoopForever}}class Qn{get isDrawable(){return!0}constructor(r,n,i){this.filePath=r??"",this.startTime=n??0,this.volume=i??100}}class Jn{get isDrawable(){return!0}constructor(r,n){this.filePath=r??"",this.startTime=n??0}}class Ut{constructor(r){let n;this.visibleWhenPassing=!0,this.visibleWhenFailing=!0,this.elements=[],this.name=r.name,this.depth=r.depth,this.masking=(n=r.masking)!==null&&n!==void 0?n:!0}}class Va{constructor(){this.variables=new Map,this.colors=new Tr,this.useSkinSprites=!1,this.minimumLayerDepth=0,this.fileFormat=14,this._layers=new Map,this.addLayer(new Ut({name:"Video",depth:4,masking:!1})),this.addLayer(new Ut({name:"Background",depth:3})),this.addLayer(new Ut({name:"Fail",depth:2,visibleWhenPassing:!1})),this.addLayer(new Ut({name:"Pass",depth:1,visibleWhenFailing:!1})),this.addLayer(new Ut({name:"Foreground",depth:0})),this.addLayer(new Ut({name:"Overlay",depth:-2147483648}))}get layers(){return this._layers}get hasDrawable(){for(const r of this.layers.values())if(r.elements.find(n=>n.isDrawable))return!0;return!1}get hasVariables(){for(const r in this.variables)return!0;return!1}get earliestEventTime(){let r=1/0;return this._layers.forEach(n=>{const a=n.elements.reduce((o,l)=>Math.min(o,l.startTime),0);r=Math.min(a,r)}),r===1/0?null:r}get latestEventTime(){let r=-1/0;return this._layers.forEach(n=>{const a=n.elements.reduce((o,l)=>{let s;const f=l;return Math.max(o,(s=f?.endTime)!==null&&s!==void 0?s:l.startTime)},0);r=Math.max(a,r)}),r===-1/0?null:r}addLayer(r){this._layers.has(r.name)||this._layers.set(r.name,r)}getLayerByType(r){let n;return this.getLayerByName((n=ut[r])!==null&&n!==void 0?n:"Background")}getLayerByName(r){let n;const i=(n=this._layers.get(r))!==null&&n!==void 0?n:new Ut({name:r,depth:--this.minimumLayerDepth});return this._layers.has(r)||this._layers.set(r,i),i}}class Qr{constructor(){this.backgroundPath=null,this.breaks=[],this.storyboard=null}get isBackgroundReplaced(){if(!this.backgroundPath||!this.storyboard)return!1;const r=this.backgroundPath.trim().toLowerCase();return this.storyboard.getLayerByType(ut.Background).elements.some(i=>i.filePath.toLowerCase()===r)}clone(){const r=new Qr;return r.backgroundPath=this.backgroundPath,r.breaks=this.breaks,r.storyboard=this.storyboard,r}}let Ae;(function(t){t[t.None=0]="None",t[t.Normal=1]="Normal",t[t.Soft=2]="Soft",t[t.Drum=3]="Drum"})(Ae||(Ae={}));class Jr{constructor(){this.audioFilename="",this.overlayPosition="NoChange",this.skinPreference="",this.audioLeadIn=0,this.previewTime=-1,this.countdown=1,this.stackLeniency=.7,this.countdownOffset=0,this.sampleSet=Ae.Normal,this.letterboxInBreaks=!1,this.useSkinSprites=!1,this.epilepsyWarning=!1,this.specialStyle=!1,this.widescreenStoryboard=!1,this.samplesMatchPlaybackRate=!1}clone(){const r=new Jr;return r.audioFilename=this.audioFilename,this.audioHash&&(r.audioHash=this.audioHash),r.overlayPosition=this.overlayPosition,r.skinPreference=this.skinPreference,r.audioLeadIn=this.audioLeadIn,r.previewTime=this.previewTime,r.countdown=this.countdown,r.stackLeniency=this.stackLeniency,r.countdownOffset=this.countdownOffset,r.sampleSet=this.sampleSet,r.letterboxInBreaks=this.letterboxInBreaks,this.storyFireInFront&&(r.storyFireInFront=this.storyFireInFront),r.useSkinSprites=this.useSkinSprites,this.alwaysShowPlayfield&&(r.alwaysShowPlayfield=this.alwaysShowPlayfield),r.epilepsyWarning=this.epilepsyWarning,r.specialStyle=this.specialStyle,r.widescreenStoryboard=this.widescreenStoryboard,r.samplesMatchPlaybackRate=this.samplesMatchPlaybackRate,r}}class Cr{constructor(){this.title="Unknown Title",this.artist="Unknown Artist",this.creator="Unknown Creator",this.version="Normal",this.source="",this.tags=[],this.beatmapId=0,this.beatmapSetId=0,this._titleUnicode="Unknown Title",this._artistUnicode="Unknown Artist"}get titleUnicode(){return this._titleUnicode!=="Unknown Title"?this._titleUnicode:this.title}set titleUnicode(r){this._titleUnicode=r}get artistUnicode(){return this._artistUnicode!=="Unknown Artist"?this._artistUnicode:this.artist}set artistUnicode(r){this._artistUnicode=r}clone(){const r=new Cr;return r.title=this.title,r.titleUnicode=this.titleUnicode,r.artist=this.artist,r.artistUnicode=this.artistUnicode,r.creator=this.creator,r.version=this.version,r.source=this.source,r.tags=this.tags.slice(),r.beatmapId=this.beatmapId,r.beatmapSetId=this.beatmapSetId,r}}class Ar{constructor(r){this.group=r||null}attachGroup(r){this.group=r}dettachGroup(){this.group=null}get startTime(){return this.group?this.group.startTime:0}}class ja{constructor(r){this.controlPoints=[],this.startTime=r}add(r){const n=this.controlPoints.find(i=>i.pointType===r.pointType);n&&this.remove(n),r.attachGroup(this),this.controlPoints.push(r)}remove(r){const n=this.controlPoints.findIndex(i=>i.pointType===r.pointType);n!==-1&&(this.controlPoints.splice(n,1),r.dettachGroup())}}function Wa(t,r){let n=0,i,a=t.length-1;for(;n<=a;){if(i=n+(a-n>>1),t[i]===r)return i;t[i]<r?n=i+1:a=i-1}return~n}function Cn(t,r){if(!t.length||r<t[0].startTime)return-1;if(r>=t[t.length-1].startTime)return t.length-1;let n=0,i=t.length-2;for(;n<=i;){const a=n+(i-n>>1);if(t[a].startTime<r)n=a+1;else if(t[a].startTime>r)i=a-1;else return a}return n-1}function Jt(t,r){const n=Cn(t,r);return n===-1?null:t[n]}function Ha(t){const r=t.length,n=[];for(let i=0;i<r;i++){n[i]=1;for(let a=0;a<r;a++)i!==a&&(n[i]*=t[i].floatX-t[a].floatX);n[i]=1/n[i]}return n}function Za(t,r,n){if(t===null||t.length===0)throw new Error("points must contain at least one point");if(t.length!==r.length)throw new Error("points must contain exactly as many items as weights");let i=0,a=0;for(let o=0,l=t.length;o<l;++o){if(n===t[o].floatX)return t[o].floatY;const s=r[o]/(n-t[o].floatX);i+=s*t[o].floatY,a+=s}return i/a}class $n{static round(r,n=1){return n?this.roundToEven(r):this.roundAwayFromZero(r)}static roundToEven(r){return this.isAtMidPoint(r)?2*Math.round(r/2):Math.round(r)}static roundAwayFromZero(r){return this.isAtMidPoint(r)?r>0?Math.ceil(r):Math.floor(r):Math.round(r)}static isAtMidPoint(r){return Math.abs(.5-Math.abs(r-(r>>0)))<=this.PRECISION_ERROR}}$n.PRECISION_ERROR=1e-15;let Ve;(function(t){t[t.TimingPoint=0]="TimingPoint",t[t.DifficultyPoint=1]="DifficultyPoint",t[t.EffectPoint=2]="EffectPoint",t[t.SamplePoint=3]="SamplePoint"})(Ve||(Ve={}));class er extends Ar{constructor(){super(...arguments),this.pointType=Ve.DifficultyPoint,this.generateTicks=!0,this.isLegacy=!1,this._sliderVelocity=1,this.bpmMultiplier=1}get sliderVelocity(){return Lr(this._sliderVelocity,.1,10)}set sliderVelocity(r){this._sliderVelocity=r}isRedundant(r){return r!==null&&r.sliderVelocity===this.sliderVelocity&&r.generateTicks===this.generateTicks}equals(r){return r instanceof er&&this.sliderVelocity===r.sliderVelocity}}er.default=new er;class tr extends Ar{constructor(){super(...arguments),this.pointType=Ve.EffectPoint,this.kiai=!1,this.omitFirstBarLine=!1,this._scrollSpeed=1}get scrollSpeed(){return Lr(this._scrollSpeed,.1,10)}set scrollSpeed(r){this._scrollSpeed=r}isRedundant(r){return!this.omitFirstBarLine&&r!==null&&this.kiai===r.kiai&&this.omitFirstBarLine===r.omitFirstBarLine&&this.scrollSpeed===r.scrollSpeed}equals(r){return r instanceof tr&&this.kiai===r.kiai&&this.omitFirstBarLine===r.omitFirstBarLine&&this.scrollSpeed===r.scrollSpeed}}tr.default=new tr;class rr extends Ar{constructor(){super(...arguments),this.pointType=Ve.SamplePoint,this.sampleSet=Ae[Ae.Normal],this.customIndex=0,this.volume=100}isRedundant(r){return r!==null&&this.volume===r.volume&&this.customIndex===r.customIndex&&this.sampleSet===r.sampleSet}equals(r){return r instanceof rr&&this.volume===r.volume&&this.customIndex===r.customIndex&&this.sampleSet===r.sampleSet}}rr.default=new rr;let pr;(function(t){t[t.SimpleTriple=3]="SimpleTriple",t[t.SimpleQuadruple=4]="SimpleQuadruple"})(pr||(pr={}));class nr extends Ar{constructor(){super(...arguments),this.pointType=Ve.TimingPoint,this._beatLength=1e3,this.timeSignature=pr.SimpleQuadruple}get beatLength(){return Lr(this._beatLength,6,6e4)}set beatLength(r){this._beatLength=r}get bpm(){return 6e4/this.beatLength}isRedundant(){return!1}equals(r){return r instanceof nr&&this.timeSignature===r.timeSignature&&this.beatLength===r.beatLength}}nr.default=new nr;class $r{constructor(){this.groups=[],this.difficultyPoints=[],this.effectPoints=[],this.samplePoints=[],this.timingPoints=[]}get allPoints(){const r=[];return this.groups.forEach(n=>r.push(...n.controlPoints)),r}groupAt(r){let n=this.groups.find(i=>i.startTime===r);return n||(n=new ja(r),this.groups.push(n),this.groups.sort((i,a)=>i.startTime-a.startTime)),n}difficultyPointAt(r){const n=Jt(this.difficultyPoints,r),i=er.default;return n||i}effectPointAt(r){const n=Jt(this.effectPoints,r),i=tr.default;return n||i}samplePointAt(r){const n=Jt(this.samplePoints,r),i=rr.default;return n||i}timingPointAt(r){const n=Jt(this.timingPoints,r),i=this.timingPoints[0]||nr.default;return n||i}add(r,n){if(this.checkAlreadyExisting(n,r))return!1;const i=this.getCurrentList(r),a=Cn(i,n);return i.splice(a+1,0,r),this.groupAt(n).add(r),!0}getCurrentList(r){switch(r.pointType){case Ve.DifficultyPoint:return this.difficultyPoints;case Ve.EffectPoint:return this.effectPoints;case Ve.SamplePoint:return this.samplePoints;case Ve.TimingPoint:return this.timingPoints}throw new TypeError(`Unknown control point type: ${r.pointType}!`)}checkAlreadyExisting(r,n){let i=null;switch(n.pointType){case Ve.DifficultyPoint:i=this.difficultyPointAt(r);break;case Ve.EffectPoint:i=this.effectPointAt(r);break;case Ve.SamplePoint:i=Jt(this.samplePoints,r);break;case Ve.TimingPoint:i=Jt(this.timingPoints,r)}return n?.isRedundant(i)}remove(r,n){let i;switch(r.pointType){case Ve.DifficultyPoint:i=this.difficultyPoints;break;case Ve.EffectPoint:i=this.effectPoints;break;case Ve.SamplePoint:i=this.samplePoints;break;default:i=this.timingPoints}const a=i.findIndex(o=>o.startTime===r.startTime);return a===-1?!1:(i.splice(a,1),this.groupAt(n).remove(r),!0)}clear(){this.groups.length=0,this.difficultyPoints.length=0,this.effectPoints.length=0,this.samplePoints.length=0,this.timingPoints.length=0}clone(){const r=new $r;return r.groups=this.groups,r.difficultyPoints=this.difficultyPoints,r.effectPoints=this.effectPoints,r.samplePoints=this.samplePoints,r.timingPoints=this.timingPoints,r}}let Fe;(function(t){t[t.None=0]="None",t[t.Normal=1]="Normal",t[t.Whistle=2]="Whistle",t[t.Finish=4]="Finish",t[t.Clap=8]="Clap"})(Fe||(Fe={}));let Oe;(function(t){t[t.Normal=1]="Normal",t[t.Slider=2]="Slider",t[t.NewCombo=4]="NewCombo",t[t.Spinner=8]="Spinner",t[t.ComboSkip1=16]="ComboSkip1",t[t.ComboSkip2=32]="ComboSkip2",t[t.ComboSkip3=64]="ComboSkip3",t[t.ComboOffset=112]="ComboOffset",t[t.Hold=128]="Hold"})(Oe||(Oe={}));let et;(function(t){t.Catmull="C",t.Bezier="B",t.Linear="L",t.PerfectCurve="P"})(et||(et={}));let Fn;(function(t){t[t.Tick=1]="Tick",t[t.LegacyLastTick=2]="LegacyLastTick",t[t.Head=4]="Head",t[t.Tail=8]="Tail",t[t.Repeat=16]="Repeat"})(Fn||(Fn={}));class Bt{constructor(r,n,i,a){this.result=r,this.min=n,this.average=i,this.max=a}static map(r,n,i,a){return r>5?i+(a-i)*(r-5)/5:r<5?i-(i-n)*(5-r)/5:i}}let ye;(function(t){t[t.None=0]="None",t[t.Miss=1]="Miss",t[t.Meh=2]="Meh",t[t.Ok=3]="Ok",t[t.Good=4]="Good",t[t.Great=5]="Great",t[t.Perfect=6]="Perfect",t[t.SmallTickMiss=7]="SmallTickMiss",t[t.SmallTickHit=8]="SmallTickHit",t[t.LargeTickMiss=9]="LargeTickMiss",t[t.LargeTickHit=10]="LargeTickHit",t[t.SmallBonus=11]="SmallBonus",t[t.LargeBonus=12]="LargeBonus",t[t.IgnoreMiss=13]="IgnoreMiss",t[t.IgnoreHit=14]="IgnoreHit"})(ye||(ye={}));let jr;class At{constructor(){this._perfect=0,this._great=0,this._good=0,this._ok=0,this._meh=0,this._miss=0}_lowestSuccessfulHitResult(){for(let r=ye.Meh;r<=ye.Perfect;++r)if(this.isHitResultAllowed(r))return r;return ye.None}*getAllAvailableWindows(){for(let r=ye.Meh;r<=ye.Perfect;++r)this.isHitResultAllowed(r)&&(yield[r,this.windowFor(r)])}isHitResultAllowed(r){return!0}setDifficulty(r){for(const n of this._getRanges()){const i=Bt.map(r,n.min,n.average,n.max);switch(n.result){case ye.Miss:this._miss=i;break;case ye.Meh:this._meh=i;break;case ye.Ok:this._ok=i;break;case ye.Good:this._good=i;break;case ye.Great:this._great=i;break;case ye.Perfect:this._perfect=i;break}}}resultFor(r){r=Math.abs(r);for(let n=ye.Perfect;n>=ye.Miss;--n)if(this.isHitResultAllowed(n)&&r<=this.windowFor(n))return n;return ye.None}windowFor(r){switch(r){case ye.Perfect:return this._perfect;case ye.Great:return this._great;case ye.Good:return this._good;case ye.Ok:return this._ok;case ye.Meh:return this._meh;case ye.Miss:return this._miss;default:throw new Error("Unknown enum member")}}canBeHit(r){return r<=this.windowFor(this._lowestSuccessfulHitResult())}_getRanges(){return At._BASE_RANGES}}At._BASE_RANGES=[new Bt(ye.Perfect,22.4,19.4,13.9),new Bt(ye.Great,64,49,34),new Bt(ye.Good,97,82,67),new Bt(ye.Ok,127,112,97),new Bt(ye.Meh,151,136,121),new Bt(ye.Miss,188,173,158)];At.EmptyHitWindows=(jr=class ei extends At{isHitResultAllowed(r){switch(r){case ye.Perfect:case ye.Miss:return!0}return!1}_getRanges(){return ei._ranges}},jr._ranges=[new Bt(ye.Perfect,0,0,0),new Bt(ye.Miss,0,0,0)],jr);At.empty=new At.EmptyHitWindows;class Dr{constructor(){this.kiai=!1,this.nestedHitObjects=[],this.startTime=0,this.hitType=Oe.Normal,this.hitSound=Fe.Normal,this.samples=[],this.startPosition=new Me(0,0),this.hitWindows=new At}get startX(){return this.startPosition.floatX}set startX(r){this.startPosition.x=r}get startY(){return this.startPosition.floatY}set startY(r){this.startPosition.y=r}createNestedHitObjects(){this.nestedHitObjects=[]}applyDefaultsToSelf(r,n){let i;this.kiai=r.effectPointAt(this.startTime+1).kiai,(i=this.hitWindows)===null||i===void 0||i.setDifficulty(n.overallDifficulty)}applyDefaultsToNested(r,n){this.nestedHitObjects.forEach(i=>{i.applyDefaults(r,n)})}applyDefaults(r,n){this.applyDefaultsToSelf(r,n),this.nestedHitObjects=[],this.createNestedHitObjects(),this.nestedHitObjects.sort((i,a)=>i.startTime-a.startTime),this.applyDefaultsToNested(r,n)}clone(){const r=this.constructor,n=new r;return n.startPosition=this.startPosition.clone(),n.startTime=this.startTime,n.hitType=this.hitType,n.hitSound=this.hitSound,n.samples=this.samples.map(i=>i.clone()),n.kiai=this.kiai,n}}class Ke{static approximateBezier(r){return this.approximateBSpline(r)}static approximateBSpline(r,n=0){const i=[],a=r.length-1;if(a<0)return i;const o=[],l=[],s=r.slice();if(n>0&&n<a){for(let p=0;p<a-n;++p){const E=[s[p]];for(let m=0;m<n-1;++m){E[m+1]=s[p+1];for(let w=1;w<n-m;++w){const h=Math.min(w,a-n-p);s[p+w]=s[p+w].fscale(h).fadd(s[p+w+1]).fdivide(h+1)}}E[n]=s[p+1],o.push(E)}o.push(s.slice(a-n)),o.reverse()}else n=a,o.push(s);const f=[],v=[],S=v;for(;o.length>0;){const p=o.pop()||[];if(this._bezierIsFlatEnough(p)){this._bezierApproximate(p,i,f,v,n+1),l.push(p);continue}const E=l.pop()||[];this._bezierSubdivide(p,S,E,f,n+1);for(let m=0;m<n+1;++m)p[m]=S[m];o.push(E),o.push(p)}return i.push(r[a]),i}static approximateCatmull(r){const n=[],i=r.length;for(let a=0;a<i-1;a++){const o=a>0?r[a-1]:r[a],l=r[a],s=a<i-1?r[a+1]:l.fadd(l).fsubtract(o),f=a<i-2?r[a+2]:s.fadd(s).fsubtract(l);for(let v=0;v<Ke.CATMULL_DETAIL;v++)n.push(Ke._catmullFindPoint(o,l,s,f,Math.fround(Math.fround(v)/Ke.CATMULL_DETAIL))),n.push(Ke._catmullFindPoint(o,l,s,f,Math.fround(Math.fround(v+1)/Ke.CATMULL_DETAIL)))}return n}static approximateCircularArc(r){const n=this._circularArcProperties(r);if(!n.isValid)return this.approximateBezier(r);let i=2;if(2*n.radius>Ke.CIRCULAR_ARC_TOLERANCE){let o=Math.fround(Ke.CIRCULAR_ARC_TOLERANCE/n.radius);o=Math.fround(1-o),o=Math.fround(2*Math.fround(Math.acos(o)));const l=Math.ceil(Math.fround(n.thetaRange/o)),s=isFinite(l)?l:-(2**31);i=Math.max(2,s)}const a=[];for(let o=0;o<i;++o){const l=o/(i-1),s=n.thetaStart+n.direction*l*n.thetaRange,f=new Me(Math.fround(Math.cos(s)),Math.fround(Math.sin(s)));a.push(f.fscale(n.radius).fadd(n.centre))}return a}static _circularArcProperties(r){const n=r[0],i=r[1],a=r[2],o=Math.fround(Math.fround(i.floatY-n.floatY)*Math.fround(a.floatX-n.floatX)-Math.fround(i.floatX-n.floatX)*Math.fround(a.floatY-n.floatY));if(Math.abs(o)<Math.fround(.001))return new On;const l=Math.fround(2*Math.fround(Math.fround(n.floatX*i.fsubtract(a).floatY)+Math.fround(i.floatX*a.fsubtract(n).floatY)+Math.fround(a.floatX*n.fsubtract(i).floatY))),s=Math.fround(Math.fround(n.floatX*n.floatX)+Math.fround(n.floatY*n.floatY)),f=Math.fround(Math.fround(i.floatX*i.floatX)+Math.fround(i.floatY*i.floatY)),v=Math.fround(Math.fround(a.floatX*a.floatX)+Math.fround(a.floatY*a.floatY)),S=new Me(Math.fround(Math.fround(Math.fround(s*i.fsubtract(a).floatY)+Math.fround(f*a.fsubtract(n).floatY))+Math.fround(v*n.fsubtract(i).floatY)),Math.fround(Math.fround(Math.fround(s*a.fsubtract(i).floatX)+Math.fround(f*n.fsubtract(a).floatX))+Math.fround(v*i.fsubtract(n).floatX))).fdivide(l),p=n.fsubtract(S),E=a.fsubtract(S),m=p.flength(),w=Math.atan2(p.floatY,p.floatX);let h=Math.atan2(E.floatY,E.floatX);for(;h<w;)h+=2*Math.PI;let b=1,_=h-w,y=a.fsubtract(n);return y=new Me(y.floatY,-y.floatX),y.fdot(i.fsubtract(n))<0&&(b=-b,_=2*Math.PI-_),new On(w,_,b,m,S)}static approximateLinear(r){return r.slice()}static approximateLagrangePolynomial(r){const i=[],a=Ha(r);let o=r[0].floatX,l=r[0].floatX;for(let f=1,v=r.length;f<v;f++)o=Math.min(o,r[f].floatX),l=Math.max(l,r[f].floatX);const s=l-o;for(let f=0;f<51;f++){const v=o+s/50*f,S=Math.fround(Za(r,a,v));i.push(new Me(v,S))}return i}static _bezierIsFlatEnough(r){let n;for(let i=1,a=r.length;i<a-1;i++)if(n=r[i-1].fsubtract(r[i].fscale(2)).fadd(r[i+1]),n.flength()**2>Ke.BEZIER_TOLERANCE**2*4)return!1;return!0}static _bezierSubdivide(r,n,i,a,o){const l=a;for(let s=0;s<o;++s)l[s]=r[s];for(let s=0;s<o;++s){n[s]=l[0],i[o-s-1]=l[o-s-1];for(let f=0;f<o-s-1;f++)l[f]=l[f].fadd(l[f+1]).fdivide(2)}}static _bezierApproximate(r,n,i,a,o){const l=a,s=i;Ke._bezierSubdivide(r,l,s,i,o);for(let f=0;f<o-1;++f)l[o+f]=s[f+1];n.push(r[0]);for(let f=1;f<o-1;++f){const v=2*f,S=l[v-1].fadd(l[v].fscale(2)).fadd(l[v+1]).fscale(Math.fround(.25));n.push(S)}}static _catmullFindPoint(r,n,i,a,o){const l=Math.fround(o*o),s=Math.fround(o*l),f=[];for(let v=0;v<=1;++v){const S=v===0?r.floatX:r.floatY,p=v===0?n.floatX:n.floatY,E=v===0?i.floatX:i.floatY,m=v===0?a.floatX:a.floatY,w=Math.fround(2*p),h=Math.fround(E-S),b=Math.fround(2*S),_=Math.fround(5*p),y=Math.fround(4*E),T=Math.fround(3*p),D=Math.fround(3*E),A=Math.fround(h*o),H=Math.fround(b-_),U=Math.fround(H+y),K=Math.fround(U-m),R=Math.fround(K),Q=Math.fround(T-S),ae=Math.fround(Q-D),M=Math.fround(ae+m),V=Math.fround(R*l),d=Math.fround(M*s),W=Math.fround(w+A),de=Math.fround(W+V),q=Math.fround(de+d);f.push(Math.fround(Math.fround(.5)*q))}return new Me(f[0],f[1])}}Ke.BEZIER_TOLERANCE=Math.fround(.25);Ke.CIRCULAR_ARC_TOLERANCE=Math.fround(.1);Ke.CATMULL_DETAIL=50;class On{constructor(r,n,i,a,o){this.isValid=!!(r||n||i||a||o),this.thetaStart=r||0,this.thetaRange=n||0,this.direction=i||0,this.radius=a?Math.fround(a):0,this.centre=o||new Me(0,0)}get thetaEnd(){return this.thetaStart+this.thetaRange*this.direction}}class Hr{constructor(r,n){this.position=r||new Me(0,0),this.type=n||null}}class en{constructor(r,n,i){this._calculatedLength=0,this._calculatedPath=[],this._cumulativeLength=[],this._isCached=!1,this._curveType=r||et.Linear,this._controlPoints=n||[],this._expectedDistance=i||0}get curveType(){return this._curveType}set curveType(r){this._curveType=r,this.invalidate()}get controlPoints(){return this._controlPoints}set controlPoints(r){this._controlPoints=r,this.invalidate()}get expectedDistance(){return this._expectedDistance}set expectedDistance(r){this._expectedDistance=r,this.invalidate()}get distance(){return this._ensureValid(),this._cumulativeLength.length?this._cumulativeLength[this._cumulativeLength.length-1]:0}set distance(r){this.expectedDistance=r}get calculatedDistance(){return this._ensureValid(),this._calculatedLength}get path(){this._ensureValid();const r=[];for(let n=0;n<this._calculatedPath.length&&!(this._cumulativeLength[n]>=this.expectedDistance);n++)r.push(this._calculatedPath[n]);return r.push(this.positionAt(1)),r}get calculatedPath(){return this._ensureValid(),this._calculatedPath}invalidate(){this._calculatedLength=0,this._calculatedPath=[],this._cumulativeLength=[],this._isCached=!1}calculatePathToProgress(r,n,i){this._ensureValid();const a=this._progressToDistance(n),o=this._progressToDistance(i);let l=0;for(;l<this._calculatedPath.length&&this._cumulativeLength[l]<a;)++l;for(r=[this._interpolateVertices(l,a)];l<this._calculatedPath.length&&this._cumulativeLength[l++]<=o;)r.push(this._calculatedPath[l]);r.push(this._interpolateVertices(l,o))}progressAt(r,n){const i=r*n%1;return Math.trunc(r*n)%2?1-i:i}positionAt(r){this._ensureValid();const n=this._progressToDistance(r);return this._interpolateVertices(this._indexOfDistance(n),n)}curvePositionAt(r,n){return this.positionAt(this.progressAt(r,n))}clone(){const r=this._controlPoints.map(n=>new Hr(n.position.clone(),n.type));return new en(this._curveType,r,this._expectedDistance)}_ensureValid(){this._isCached||(this._calculatePath(),this._calculateLength(),this._isCached=!0)}_calculatePath(){this._calculatedPath=[];const r=this.controlPoints.length;if(r===0)return;const n=[];for(let a=0;a<r;a++)n[a]=this.controlPoints[a].position;let i=0;for(let a=0;a<r;++a){if(!this.controlPoints[a].type&&a<r-1)continue;const o=n.slice(i,a+1),l=this.controlPoints[i].type||et.Linear;for(const s of this._calculateSubPath(o,l)){const f=this._calculatedPath[this._calculatedPath.length-1];(this._calculatedPath.length===0||!f.equals(s))&&this._calculatedPath.push(s)}i=a}}_calculateSubPath(r,n){switch(n){case et.Linear:return Ke.approximateLinear(r);case et.PerfectCurve:{if(r.length!==3)break;const i=Ke.approximateCircularArc(r);if(i.length===0)break;return i}case et.Catmull:return Ke.approximateCatmull(r)}return Ke.approximateBezier(r)}_calculateLength(){this._calculatedLength=0,this._cumulativeLength=[0];for(let r=0,n=this._calculatedPath.length-1;r<n;++r){const i=this._calculatedPath[r+1].fsubtract(this._calculatedPath[r]);this._calculatedLength+=i.flength(),this._cumulativeLength.push(this._calculatedLength)}if(this.expectedDistance&&this._calculatedLength!==this.expectedDistance){const r=this.controlPoints,n=r[r.length-1],i=r[r.length-2];if(r.length>=2&&n.position.equals(i.position)&&this.expectedDistance>this._calculatedLength){this._cumulativeLength.push(this._calculatedLength);return}this._cumulativeLength.pop();let o=this._calculatedPath.length-1;if(this._calculatedLength>this.expectedDistance)for(;this._cumulativeLength.length>0&&this._cumulativeLength[this._cumulativeLength.length-1]>=this.expectedDistance;)this._cumulativeLength.pop(),this._calculatedPath.splice(o--,1);if(o<=0){this._cumulativeLength.push(0);return}const l=this._calculatedPath[o].fsubtract(this._calculatedPath[o-1]).fnormalize(),s=Math.fround(this.expectedDistance-this._cumulativeLength[this._cumulativeLength.length-1]);this._calculatedPath[o]=this._calculatedPath[o-1].fadd(l.fscale(s)),this._cumulativeLength.push(this.expectedDistance)}}_indexOfDistance(r){let n=Wa(this._cumulativeLength,r);return n<0&&(n=~n),n}_progressToDistance(r){return Zn(r)*this.distance}_interpolateVertices(r,n){if(this._calculatedPath.length===0)return new Me(0,0);if(r<=0)return this._calculatedPath[0];if(r>=this._calculatedPath.length)return this._calculatedPath[this._calculatedPath.length-1];const i=this._calculatedPath[r-1],a=this._calculatedPath[r],o=this._cumulativeLength[r-1],l=this._cumulativeLength[r];if(Math.abs(o-l)<.001)return i;const s=(n-o)/(l-o);return i.fadd(a.fsubtract(i).fscale(s))}}class Gt{constructor(){this.sampleSet=Ae[Ae.None],this.hitSound=Fe[Fe.Normal],this.customIndex=0,this.suffix="",this.volume=100,this.isLayered=!1,this.filename=""}clone(){const r=new Gt;return r.sampleSet=this.sampleSet,r.hitSound=this.hitSound,r.customIndex=this.customIndex,r.suffix=this.suffix,r.volume=this.volume,r.isLayered=this.isLayered,r.filename=this.filename,r}}class tn{constructor(){this.filename="",this.volume=100,this.normalSet=Ae.Normal,this.additionSet=Ae.Normal,this.customIndex=0}clone(){const r=new tn;return r.filename=this.filename,r.volume=this.volume,r.normalSet=this.normalSet,r.additionSet=this.additionSet,r.customIndex=this.customIndex,r}}class Ya{constructor(){this.general=new Jr,this.editor=new Yr,this.difficulty=new Vt,this.metadata=new Cr,this.colors=new Tr,this.events=new Qr,this.controlPoints=new $r,this.hitObjects=[],this.fileFormat=14,this.fileUpdateDate=new Date,this.originalMode=0}get mode(){return this.originalMode}get length(){if(!this.hitObjects.length)return 0;const r=this.hitObjects[0],n=this.hitObjects[this.hitObjects.length-1],i=n,a=r.startTime;return((i.endTime||n.startTime)-a)/this.difficulty.clockRate}get totalLength(){if(!this.hitObjects.length)return 0;const r=this.hitObjects[this.hitObjects.length-1];return(r.endTime||r.startTime)/this.difficulty.clockRate}get bpmMin(){const r=this.controlPoints.timingPoints.map(n=>n.bpm).filter(n=>n>=0);return r.length?r.reduce((i,a)=>Math.min(i,a),1/0)*this.difficulty.clockRate:60}get bpmMax(){const r=this.controlPoints.timingPoints.map(n=>n.bpm).filter(n=>n>=0);return r.length?r.reduce((i,a)=>Math.max(i,a),0)*this.difficulty.clockRate:60}get bpm(){let r,n,i;if(!this.controlPoints.timingPoints.length)return this.bpmMax;const a=this.controlPoints.timingPoints,o=this.hitObjects,l=a[a.length-1],s=o[o.length-1],f=s,v=(i=(n=(r=f?.endTime)!==null&&r!==void 0?r:s?.startTime)!==null&&n!==void 0?n:l?.startTime)!==null&&i!==void 0?i:0;let S=0,p=0;const E={};for(let w=0,h=a.length;w<h;++w){if(S=w===h-1?v:a[w+1].startTime,p=$n.round(a[w].beatLength*1e3)/1e3,a[w].startTime>v){E[p]=0;continue}E[p]||(E[p]=0),E[p]+=S-a[w].startTime}const m=Object.entries(E).sort((w,h)=>h[1]-w[1]);return 6e4/Number(m[0][0])*this.difficulty.clockRate}get totalBreakTime(){return(this.events.breaks||[]).reduce((r,n)=>r+n.duration,0)}get hittable(){return this.hitObjects.reduce((r,n)=>r+(n.hitType&Oe.Normal?1:0),0)}get slidable(){return this.hitObjects.reduce((r,n)=>r+(n.hitType&Oe.Slider?1:0),0)}get spinnable(){return this.hitObjects.reduce((r,n)=>r+(n.hitType&Oe.Spinner?1:0),0)}get holdable(){return this.hitObjects.reduce((r,n)=>r+(n.hitType&Oe.Hold?1:0),0)}clone(){const r=this.constructor,n=new r;return n.general=this.general.clone(),n.editor=this.editor.clone(),n.difficulty=this.difficulty.clone(),n.metadata=this.metadata.clone(),n.colors=this.colors.clone(),n.events=this.events.clone(),n.controlPoints=this.controlPoints.clone(),n.hitObjects=this.hitObjects.map(i=>i.clone()),n.originalMode=this.originalMode,n.fileFormat=this.fileFormat,this.base&&(n.base=this.base),n}}let kt;(function(t){t[t.None=0]="None",t[t.Kiai=1]="Kiai",t[t.OmitFirstBarLine=8]="OmitFirstBarLine"})(kt||(kt={}));class Xa{constructor(r,n){this.startTime=r,this.endTime=n}get duration(){return this.endTime-this.startTime}get hasEffect(){return this.duration>=650}contains(r){return this.startTime<=r&&r<=this.endTime}}let Rn;(function(t){t[t.None=0]="None",t[t.NoFail=1]="NoFail",t[t.Easy=2]="Easy",t[t.TouchDevice=4]="TouchDevice",t[t.Hidden=8]="Hidden",t[t.HardRock=16]="HardRock",t[t.SuddenDeath=32]="SuddenDeath",t[t.DoubleTime=64]="DoubleTime",t[t.Relax=128]="Relax",t[t.HalfTime=256]="HalfTime",t[t.Nightcore=512]="Nightcore",t[t.Flashlight=1024]="Flashlight",t[t.Autoplay=2048]="Autoplay",t[t.SpunOut=4096]="SpunOut",t[t.Relax2=8192]="Relax2",t[t.Perfect=16384]="Perfect",t[t.Key4=32768]="Key4",t[t.Key5=65536]="Key5",t[t.Key6=131072]="Key6",t[t.Key7=262144]="Key7",t[t.Key8=524288]="Key8",t[t.FadeIn=1048576]="FadeIn",t[t.Random=2097152]="Random",t[t.Cinema=4194304]="Cinema",t[t.Target=8388608]="Target",t[t.Key9=16777216]="Key9",t[t.KeyCoop=33554432]="KeyCoop",t[t.Key1=67108864]="Key1",t[t.Key3=134217728]="Key3",t[t.Key2=268435456]="Key2",t[t.ScoreV2=536870912]="ScoreV2",t[t.Mirror=1073741824]="Mirror",t[t.KeyMod=487555072]="KeyMod",t[t.DifficultyDecrease=258]="DifficultyDecrease",t[t.DifficultyIncrease=1616]="DifficultyIncrease"})(Rn||(Rn={}));let zn;(function(t){t[t.DifficultyReduction=0]="DifficultyReduction",t[t.DifficultyIncrease=1]="DifficultyIncrease",t[t.Conversion=2]="Conversion",t[t.Automation=3]="Automation",t[t.Fun=4]="Fun",t[t.System=5]="System"})(zn||(zn={}));let Nn;(function(t){t[t.None=0]="None",t[t.Left1=1]="Left1",t[t.Right1=2]="Right1",t[t.Left2=4]="Left2",t[t.Right2=8]="Right2",t[t.Smoke=16]="Smoke"})(Nn||(Nn={}));let Un;(function(t){t[t.F=-1]="F",t[t.D=0]="D",t[t.C=1]="C",t[t.B=2]="B",t[t.A=3]="A",t[t.S=4]="S",t[t.SH=5]="SH",t[t.X=6]="X",t[t.XH=7]="XH"})(Un||(Un={}));let Gn;(function(t){t[t.Unknown=0]="Unknown",t[t.BD=1]="BD",t[t.BE=2]="BE",t[t.BF=3]="BF",t[t.BG=4]="BG",t[t.BA=5]="BA",t[t.BB=6]="BB",t[t.WF=7]="WF",t[t.BL=8]="BL",t[t.BM=9]="BM",t[t.BN=10]="BN",t[t.BO=11]="BO",t[t.BH=12]="BH",t[t.BI=13]="BI",t[t.BJ=14]="BJ",t[t.BT=15]="BT",t[t.JM=16]="JM",t[t.BV=17]="BV",t[t.BW=18]="BW",t[t.WS=19]="WS",t[t.BQ=20]="BQ",t[t.BR=21]="BR",t[t.BS=22]="BS",t[t.JE=23]="JE",t[t.BY=24]="BY",t[t.BZ=25]="BZ",t[t.RU=26]="RU",t[t.RW=27]="RW",t[t.RS=28]="RS",t[t.TL=29]="TL",t[t.RE=30]="RE",t[t.TM=31]="TM",t[t.TJ=32]="TJ",t[t.RO=33]="RO",t[t.TK=34]="TK",t[t.GW=35]="GW",t[t.GU=36]="GU",t[t.GT=37]="GT",t[t.GS=38]="GS",t[t.GR=39]="GR",t[t.GQ=40]="GQ",t[t.GP=41]="GP",t[t.JP=42]="JP",t[t.GY=43]="GY",t[t.GG=44]="GG",t[t.GF=45]="GF",t[t.GE=46]="GE",t[t.GD=47]="GD",t[t.GB=48]="GB",t[t.GA=49]="GA",t[t.SV=50]="SV",t[t.GN=51]="GN",t[t.GM=52]="GM",t[t.GL=53]="GL",t[t.GI=54]="GI",t[t.GH=55]="GH",t[t.OM=56]="OM",t[t.TN=57]="TN",t[t.JO=58]="JO",t[t.HR=59]="HR",t[t.HT=60]="HT",t[t.HU=61]="HU",t[t.HK=62]="HK",t[t.HN=63]="HN",t[t.HM=64]="HM",t[t.VE=65]="VE",t[t.PR=66]="PR",t[t.PS=67]="PS",t[t.PW=68]="PW",t[t.PT=69]="PT",t[t.SJ=70]="SJ",t[t.PY=71]="PY",t[t.IQ=72]="IQ",t[t.PA=73]="PA",t[t.PF=74]="PF",t[t.PG=75]="PG",t[t.PE=76]="PE",t[t.PK=77]="PK",t[t.PH=78]="PH",t[t.PN=79]="PN",t[t.PL=80]="PL",t[t.PM=81]="PM",t[t.ZM=82]="ZM",t[t.EH=83]="EH",t[t.EE=84]="EE",t[t.EG=85]="EG",t[t.ZA=86]="ZA",t[t.EC=87]="EC",t[t.IT=88]="IT",t[t.VN=89]="VN",t[t.SB=90]="SB",t[t.ET=91]="ET",t[t.SO=92]="SO",t[t.ZW=93]="ZW",t[t.SA=94]="SA",t[t.ES=95]="ES",t[t.ER=96]="ER",t[t.ME=97]="ME",t[t.MD=98]="MD",t[t.MG=99]="MG",t[t.MF=100]="MF",t[t.MA=101]="MA",t[t.MC=102]="MC",t[t.UZ=103]="UZ",t[t.MM=104]="MM",t[t.ML=105]="ML",t[t.MO=106]="MO",t[t.MN=107]="MN",t[t.MH=108]="MH",t[t.MK=109]="MK",t[t.MU=110]="MU",t[t.MT=111]="MT",t[t.MW=112]="MW",t[t.MV=113]="MV",t[t.MQ=114]="MQ",t[t.MP=115]="MP",t[t.MS=116]="MS",t[t.MR=117]="MR",t[t.IM=118]="IM",t[t.UG=119]="UG",t[t.TZ=120]="TZ",t[t.MY=121]="MY",t[t.MX=122]="MX",t[t.IL=123]="IL",t[t.FR=124]="FR",t[t.IO=125]="IO",t[t.SH=126]="SH",t[t.FI=127]="FI",t[t.FJ=128]="FJ",t[t.FK=129]="FK",t[t.FM=130]="FM",t[t.FO=131]="FO",t[t.NI=132]="NI",t[t.NL=133]="NL",t[t.NO=134]="NO",t[t.NA=135]="NA",t[t.VU=136]="VU",t[t.NC=137]="NC",t[t.NE=138]="NE",t[t.NF=139]="NF",t[t.NG=140]="NG",t[t.NZ=141]="NZ",t[t.NP=142]="NP",t[t.NR=143]="NR",t[t.NU=144]="NU",t[t.CK=145]="CK",t[t.XK=146]="XK",t[t.CI=147]="CI",t[t.CH=148]="CH",t[t.CO=149]="CO",t[t.CN=150]="CN",t[t.CM=151]="CM",t[t.CL=152]="CL",t[t.CC=153]="CC",t[t.CA=154]="CA",t[t.CG=155]="CG",t[t.CF=156]="CF",t[t.CD=157]="CD",t[t.CZ=158]="CZ",t[t.CY=159]="CY",t[t.CX=160]="CX",t[t.CR=161]="CR",t[t.CW=162]="CW",t[t.CV=163]="CV",t[t.CU=164]="CU",t[t.SZ=165]="SZ",t[t.SY=166]="SY",t[t.SX=167]="SX",t[t.KG=168]="KG",t[t.KE=169]="KE",t[t.SS=170]="SS",t[t.SR=171]="SR",t[t.KI=172]="KI",t[t.KH=173]="KH",t[t.KN=174]="KN",t[t.KM=175]="KM",t[t.ST=176]="ST",t[t.SK=177]="SK",t[t.KR=178]="KR",t[t.SI=179]="SI",t[t.KP=180]="KP",t[t.KW=181]="KW",t[t.SN=182]="SN",t[t.SM=183]="SM",t[t.SL=184]="SL",t[t.SC=185]="SC",t[t.KZ=186]="KZ",t[t.KY=187]="KY",t[t.SG=188]="SG",t[t.SE=189]="SE",t[t.SD=190]="SD",t[t.DO=191]="DO",t[t.DM=192]="DM",t[t.DJ=193]="DJ",t[t.DK=194]="DK",t[t.VG=195]="VG",t[t.DE=196]="DE",t[t.YE=197]="YE",t[t.DZ=198]="DZ",t[t.US=199]="US",t[t.UY=200]="UY",t[t.YT=201]="YT",t[t.UM=202]="UM",t[t.LB=203]="LB",t[t.LC=204]="LC",t[t.LA=205]="LA",t[t.TV=206]="TV",t[t.TW=207]="TW",t[t.TT=208]="TT",t[t.TR=209]="TR",t[t.LK=210]="LK",t[t.LI=211]="LI",t[t.LV=212]="LV",t[t.TO=213]="TO",t[t.LT=214]="LT",t[t.LU=215]="LU",t[t.LR=216]="LR",t[t.LS=217]="LS",t[t.TH=218]="TH",t[t.TF=219]="TF",t[t.TG=220]="TG",t[t.TD=221]="TD",t[t.TC=222]="TC",t[t.LY=223]="LY",t[t.VA=224]="VA",t[t.VC=225]="VC",t[t.AE=226]="AE",t[t.AD=227]="AD",t[t.AG=228]="AG",t[t.AF=229]="AF",t[t.AI=230]="AI",t[t.VI=231]="VI",t[t.IS=232]="IS",t[t.IR=233]="IR",t[t.AM=234]="AM",t[t.AL=235]="AL",t[t.AO=236]="AO",t[t.AQ=237]="AQ",t[t.AS=238]="AS",t[t.AR=239]="AR",t[t.AU=240]="AU",t[t.AT=241]="AT",t[t.AW=242]="AW",t[t.IN=243]="IN",t[t.AX=244]="AX",t[t.AZ=245]="AZ",t[t.IE=246]="IE",t[t.ID=247]="ID",t[t.UA=248]="UA",t[t.QA=249]="QA",t[t.MZ=250]="MZ"})(Gn||(Gn={}));var Ka=function(){var t=1,r=2,n=3,i=typeof setImmediate=="function"?setImmediate:setTimeout,a=4294967296,o=[4294967295,-a],l=[0,-9223372036854776e3],s=[0,0],f=[1,0];function v(e,u){postMessage({action:n,cbn:u,result:e})}function S(e){var u=[];return u[e-1]=void 0,u}function p(e,u){return w(e[0]+u[0],e[1]+u[1])}function E(e,u){return y(~~Math.max(Math.min(e[1]/a,2147483647),-2147483648)&~~Math.max(Math.min(u[1]/a,2147483647),-2147483648),_(e)&_(u))}function m(e,u){var g,k;return e[0]==u[0]&&e[1]==u[1]?0:(g=e[1]<0,k=u[1]<0,g&&!k?-1:!g&&k?1:U(e,u)[1]<0?-1:1)}function w(e,u){var g,k;for(u%=18446744073709552e3,e%=18446744073709552e3,g=u%a,k=Math.floor(e/a)*a,u=u-g+k,e=e-k+g;e<0;)e+=a,u-=a;for(;e>4294967295;)e-=a,u+=a;for(u=u%18446744073709552e3;u>9223372032559809e3;)u-=18446744073709552e3;for(;u<-9223372036854776e3;)u+=18446744073709552e3;return[e,u]}function h(e,u){return e[0]==u[0]&&e[1]==u[1]}function b(e){return e>=0?[e,0]:[e+a,-a]}function _(e){return e[0]>=2147483648?~~Math.max(Math.min(e[0]-a,2147483647),-2147483648):~~Math.max(Math.min(e[0],2147483647),-2147483648)}function y(e,u){var g,k;return g=e*a,k=u,u<0&&(k+=a),[k,g]}function T(e){return e<=30?1<<e:T(30)*T(e-30)}function D(e,u){var g,k,x,I;if(u&=63,h(e,l))return u?s:e;if(e[1]<0)throw new Error("Neg");return I=T(u),k=e[1]*I%18446744073709552e3,x=e[0]*I,g=x-x%a,k+=g,x-=g,k>=9223372036854776e3&&(k-=18446744073709552e3),[x,k]}function A(e,u){var g;return u&=63,g=T(u),w(Math.floor(e[0]/g),e[1]/g)}function H(e,u){var g;return u&=63,g=A(e,u),e[1]<0&&(g=p(g,D([2,0],63-u))),g}function U(e,u){return w(e[0]-u[0],e[1]-u[1])}function K(e,u){return e.buf=u,e.pos=0,e.count=u.length,e}function R(e){return e.pos>=e.count?-1:e.buf[e.pos++]&255}function Q(e,u,g,k){return e.pos>=e.count?-1:(k=Math.min(k,e.count-e.pos),de(e.buf,e.pos,u,g,k),e.pos+=k,k)}function ae(e){return e.buf=S(32),e.count=0,e}function M(e){var u=e.buf;return u.length=e.count,u}function V(e,u){e.buf[e.count++]=u<<24>>24}function d(e,u,g,k){de(u,g,e.buf,e.count,k),e.count+=k}function W(e,u,g,k,x){var I;for(I=u;I<g;++I)k[x++]=e.charCodeAt(I)}function de(e,u,g,k,x){for(var I=0;I<x;++I)g[k+I]=e[u+I]}function q(e,u){_i(u,1<<e.s),u._numFastBytes=e.f,gi(u,e.m),u._numLiteralPosStateBits=0,u._numLiteralContextBits=3,u._posStateBits=2,u._posStateMask=3}function me(e,u,g,k,x){var I,G;if(m(k,o)<0)throw new Error("invalid length "+k);for(e.length_0=k,I=fi({}),q(x,I),I._writeEndMark=typeof Ka.disableEndMark>"u",vi(I,g),G=0;G<64;G+=8)V(g,_(A(k,G))&255);e.chunker=(I._needReleaseMFStream=0,I._inStream=u,I._finished=0,ci(I),I._rangeEncoder.Stream=g,mi(I),on(I),an(I),I._lenEncoder._tableSize=I._numFastBytes+1-2,hn(I._lenEncoder,1<<I._posStateBits),I._repMatchLenEncoder._tableSize=I._numFastBytes+1-2,hn(I._repMatchLenEncoder,1<<I._posStateBits),I.nowPos64=s,ce({},I))}function C(e,u,g){return e.output=ae({}),me(e,K({},u),e.output,b(u.length),g),e}function he(e,u,g){var k,x="",I,G=[],re,se;for(I=0;I<5;++I){if(re=R(u),re==-1)throw new Error("truncated input");G[I]=re<<24>>24}if(k=Ue({}),!ir(k,G))throw new Error("corrupted input");for(I=0;I<64;I+=8){if(re=R(u),re==-1)throw new Error("truncated input");re=re.toString(16),re.length==1&&(re="0"+re),x=re+""+x}/^0+$|^f+$/i.test(x)?e.length_0=o:(se=parseInt(x,16),se>4294967295?e.length_0=o:e.length_0=b(se)),e.chunker=lt(k,u,g,e.length_0)}function z(e,u){return e.output=ae({}),he(e,K({},u),e.output),e}function O(e,u,g,k){var x;e._keepSizeBefore=u,e._keepSizeAfter=g,x=u+g+k,(e._bufferBase==null||e._blockSize!=x)&&(e._bufferBase=null,e._blockSize=x,e._bufferBase=S(e._blockSize)),e._pointerToLastSafePosition=e._blockSize-g}function ie(e,u){return e._bufferBase[e._bufferOffset+e._pos+u]}function te(e,u,g,k){var x,I;for(e._streamEndWasReached&&e._pos+u+k>e._streamPos&&(k=e._streamPos-(e._pos+u)),++g,I=e._bufferOffset+e._pos+u,x=0;x<k&&e._bufferBase[I+x]==e._bufferBase[I+x-g];++x);return x}function ee(e){return e._streamPos-e._pos}function Re(e){var u,g,k;for(k=e._bufferOffset+e._pos-e._keepSizeBefore,k>0&&--k,g=e._bufferOffset+e._streamPos-k,u=0;u<g;++u)e._bufferBase[u]=e._bufferBase[k+u];e._bufferOffset-=k}function Ze(e){var u;++e._pos,e._pos>e._posLimit&&(u=e._bufferOffset+e._pos,u>e._pointerToLastSafePosition&&Re(e),ve(e))}function ve(e){var u,g,k;if(!e._streamEndWasReached)for(;;){if(k=-e._bufferOffset+e._blockSize-e._streamPos,!k)return;if(u=Q(e._stream,e._bufferBase,e._bufferOffset+e._streamPos,k),u==-1){e._posLimit=e._streamPos,g=e._bufferOffset+e._posLimit,g>e._pointerToLastSafePosition&&(e._posLimit=e._pointerToLastSafePosition-e._bufferOffset),e._streamEndWasReached=1;return}e._streamPos+=u,e._streamPos>=e._pos+e._keepSizeAfter&&(e._posLimit=e._streamPos-e._keepSizeAfter)}}function Se(e,u){e._bufferOffset+=u,e._posLimit-=u,e._pos-=u,e._streamPos-=u}var ze=function(){var e,u,g,k=[];for(e=0;e<256;++e){for(g=e,u=0;u<8;++u)g&1?g=g>>>1^-306674912:g>>>=1;k[e]=g}return k}();function Ne(e,u,g,k,x){var I,G,re;u<1073741567&&(e._cutValue=16+(k>>1),re=~~((u+g+k+x)/2)+256,O(e,u+g,k+x,re),e._matchMaxLen=k,I=u+1,e._cyclicBufferSize!=I&&(e._son=S((e._cyclicBufferSize=I)*2)),G=65536,e.HASH_ARRAY&&(G=u-1,G|=G>>1,G|=G>>2,G|=G>>4,G|=G>>8,G>>=1,G|=65535,G>16777216&&(G>>=1),e._hashMask=G,++G,G+=e.kFixHashSize),G!=e._hashSizeSum&&(e._hash=S(e._hashSizeSum=G)))}function st(e,u){var g,k,x,I,G,re,se,oe,le,Ie,_e,be,Ye,ue,ke,je,Pe,ht,Qe,mt,vt;if(e._pos+e._matchMaxLen<=e._streamPos)ue=e._matchMaxLen;else if(ue=e._streamPos-e._pos,ue<e.kMinMatchCheck)return c(e),0;for(Pe=0,ke=e._pos>e._cyclicBufferSize?e._pos-e._cyclicBufferSize:0,k=e._bufferOffset+e._pos,je=1,oe=0,le=0,e.HASH_ARRAY?(vt=ze[e._bufferBase[k]&255]^e._bufferBase[k+1]&255,oe=vt&1023,vt^=(e._bufferBase[k+2]&255)<<8,le=vt&65535,Ie=(vt^ze[e._bufferBase[k+3]&255]<<5)&e._hashMask):Ie=e._bufferBase[k]&255^(e._bufferBase[k+1]&255)<<8,x=e._hash[e.kFixHashSize+Ie]||0,e.HASH_ARRAY&&(I=e._hash[oe]||0,G=e._hash[1024+le]||0,e._hash[oe]=e._pos,e._hash[1024+le]=e._pos,I>ke&&e._bufferBase[e._bufferOffset+I]==e._bufferBase[k]&&(u[Pe++]=je=2,u[Pe++]=e._pos-I-1),G>ke&&e._bufferBase[e._bufferOffset+G]==e._bufferBase[k]&&(G==I&&(Pe-=2),u[Pe++]=je=3,u[Pe++]=e._pos-G-1,I=G),Pe!=0&&I==x&&(Pe-=2,je=1)),e._hash[e.kFixHashSize+Ie]=e._pos,Qe=(e._cyclicBufferPos<<1)+1,mt=e._cyclicBufferPos<<1,be=Ye=e.kNumHashDirectBytes,e.kNumHashDirectBytes!=0&&x>ke&&e._bufferBase[e._bufferOffset+x+e.kNumHashDirectBytes]!=e._bufferBase[k+e.kNumHashDirectBytes]&&(u[Pe++]=je=e.kNumHashDirectBytes,u[Pe++]=e._pos-x-1),g=e._cutValue;;){if(x<=ke||g--==0){e._son[Qe]=e._son[mt]=0;break}if(se=e._pos-x,re=(se<=e._cyclicBufferPos?e._cyclicBufferPos-se:e._cyclicBufferPos-se+e._cyclicBufferSize)<<1,ht=e._bufferOffset+x,_e=be<Ye?be:Ye,e._bufferBase[ht+_e]==e._bufferBase[k+_e]){for(;++_e!=ue&&e._bufferBase[ht+_e]==e._bufferBase[k+_e];);if(je<_e&&(u[Pe++]=je=_e,u[Pe++]=se-1,_e==ue)){e._son[mt]=e._son[re],e._son[Qe]=e._son[re+1];break}}(e._bufferBase[ht+_e]&255)<(e._bufferBase[k+_e]&255)?(e._son[mt]=x,mt=re+1,x=e._son[mt],Ye=_e):(e._son[Qe]=x,Qe=re,x=e._son[Qe],be=_e)}return c(e),Pe}function it(e){e._bufferOffset=0,e._pos=0,e._streamPos=0,e._streamEndWasReached=0,ve(e),e._cyclicBufferPos=0,Se(e,-1)}function c(e){var u;++e._cyclicBufferPos>=e._cyclicBufferSize&&(e._cyclicBufferPos=0),Ze(e),e._pos==1073741823&&(u=e._pos-e._cyclicBufferSize,j(e._son,e._cyclicBufferSize*2,u),j(e._hash,e._hashSizeSum,u),Se(e,u))}function j(e,u,g){var k,x;for(k=0;k<u;++k)x=e[k]||0,x<=g?x=0:x-=g,e[k]=x}function N(e,u){e.HASH_ARRAY=u>2,e.HASH_ARRAY?(e.kNumHashDirectBytes=0,e.kMinMatchCheck=4,e.kFixHashSize=66560):(e.kNumHashDirectBytes=2,e.kMinMatchCheck=3,e.kFixHashSize=0)}function B(e,u){var g,k,x,I,G,re,se,oe,le,Ie,_e,be,Ye,ue,ke,je,Pe;do{if(e._pos+e._matchMaxLen<=e._streamPos)be=e._matchMaxLen;else if(be=e._streamPos-e._pos,be<e.kMinMatchCheck){c(e);continue}for(Ye=e._pos>e._cyclicBufferSize?e._pos-e._cyclicBufferSize:0,k=e._bufferOffset+e._pos,e.HASH_ARRAY?(Pe=ze[e._bufferBase[k]&255]^e._bufferBase[k+1]&255,re=Pe&1023,e._hash[re]=e._pos,Pe^=(e._bufferBase[k+2]&255)<<8,se=Pe&65535,e._hash[1024+se]=e._pos,oe=(Pe^ze[e._bufferBase[k+3]&255]<<5)&e._hashMask):oe=e._bufferBase[k]&255^(e._bufferBase[k+1]&255)<<8,x=e._hash[e.kFixHashSize+oe],e._hash[e.kFixHashSize+oe]=e._pos,ke=(e._cyclicBufferPos<<1)+1,je=e._cyclicBufferPos<<1,Ie=_e=e.kNumHashDirectBytes,g=e._cutValue;;){if(x<=Ye||g--==0){e._son[ke]=e._son[je]=0;break}if(G=e._pos-x,I=(G<=e._cyclicBufferPos?e._cyclicBufferPos-G:e._cyclicBufferPos-G+e._cyclicBufferSize)<<1,ue=e._bufferOffset+x,le=Ie<_e?Ie:_e,e._bufferBase[ue+le]==e._bufferBase[k+le]){for(;++le!=be&&e._bufferBase[ue+le]==e._bufferBase[k+le];);if(le==be){e._son[je]=e._son[I],e._son[ke]=e._son[I+1];break}}(e._bufferBase[ue+le]&255)<(e._bufferBase[k+le]&255)?(e._son[je]=x,je=I+1,x=e._son[je],_e=le):(e._son[ke]=x,ke=I,x=e._son[ke],Ie=le)}c(e)}while(--u!=0)}function P(e,u,g){var k=e._pos-u-1;for(k<0&&(k+=e._windowSize);g!=0;--g)k>=e._windowSize&&(k=0),e._buffer[e._pos++]=e._buffer[k++],e._pos>=e._windowSize&&Z(e)}function L(e,u){(e._buffer==null||e._windowSize!=u)&&(e._buffer=S(u)),e._windowSize=u,e._pos=0,e._streamPos=0}function Z(e){var u=e._pos-e._streamPos;u&&(d(e._stream,e._buffer,e._streamPos,u),e._pos>=e._windowSize&&(e._pos=0),e._streamPos=e._pos)}function Y(e,u){var g=e._pos-u-1;return g<0&&(g+=e._windowSize),e._buffer[g]}function F(e,u){e._buffer[e._pos++]=u,e._pos>=e._windowSize&&Z(e)}function $(e){Z(e),e._stream=null}function ne(e){return e-=2,e<4?e:3}function J(e){return e<4?0:e<10?e-3:e-6}function ce(e,u){return e.encoder=u,e.decoder=null,e.alive=1,e}function Te(e,u){return e.decoder=u,e.encoder=null,e.alive=1,e}function pe(e){if(!e.alive)throw new Error("bad state");return e.encoder?Dt(e):tt(e),e.alive}function tt(e){var u=Ft(e.decoder);if(u==-1)throw new Error("corrupted input");e.inBytesProcessed=o,e.outBytesProcessed=e.decoder.nowPos64,(u||m(e.decoder.outSize,s)>=0&&m(e.decoder.nowPos64,e.decoder.outSize)>=0)&&(Z(e.decoder.m_OutWindow),$(e.decoder.m_OutWindow),e.decoder.m_RangeDecoder.Stream=null,e.alive=0)}function Dt(e){ui(e.encoder,e.encoder.processedInSize,e.encoder.processedOutSize,e.encoder.finished),e.inBytesProcessed=e.encoder.processedInSize[0],e.encoder.finished[0]&&(pi(e.encoder),e.alive=0)}function lt(e,u,g,k){return e.m_RangeDecoder.Stream=u,$(e.m_OutWindow),e.m_OutWindow._stream=g,Wt(e),e.state=0,e.rep0=0,e.rep1=0,e.rep2=0,e.rep3=0,e.outSize=k,e.nowPos64=s,e.prevByte=0,Te({},e)}function Ft(e){var u,g,k,x,I,G;if(G=_(e.nowPos64)&e.m_PosStateMask,!rt(e.m_RangeDecoder,e.m_IsMatchDecoders,(e.state<<4)+G))u=Ht(e.m_LiteralDecoder,_(e.nowPos64),e.prevByte),e.state<7?e.prevByte=ai(u,e.m_RangeDecoder):e.prevByte=oi(u,e.m_RangeDecoder,Y(e.m_OutWindow,e.rep0)),F(e.m_OutWindow,e.prevByte),e.state=J(e.state),e.nowPos64=p(e.nowPos64,f);else{if(rt(e.m_RangeDecoder,e.m_IsRepDecoders,e.state))k=0,rt(e.m_RangeDecoder,e.m_IsRepG0Decoders,e.state)?(rt(e.m_RangeDecoder,e.m_IsRepG1Decoders,e.state)?(rt(e.m_RangeDecoder,e.m_IsRepG2Decoders,e.state)?(g=e.rep3,e.rep3=e.rep2):g=e.rep2,e.rep2=e.rep1):g=e.rep1,e.rep1=e.rep0,e.rep0=g):rt(e.m_RangeDecoder,e.m_IsRep0LongDecoders,(e.state<<4)+G)||(e.state=e.state<7?9:11,k=1),k||(k=br(e.m_RepLenDecoder,e.m_RangeDecoder,G)+2,e.state=e.state<7?8:11);else if(e.rep3=e.rep2,e.rep2=e.rep1,e.rep1=e.rep0,k=2+br(e.m_LenDecoder,e.m_RangeDecoder,G),e.state=e.state<7?7:10,I=kr(e.m_PosSlotDecoder[ne(k)],e.m_RangeDecoder),I>=4){if(x=(I>>1)-1,e.rep0=(2|I&1)<<x,I<14)e.rep0+=Ii(e.m_PosDecoders,e.rep0-I-1,e.m_RangeDecoder,x);else if(e.rep0+=Di(e.m_RangeDecoder,x-4)<<4,e.rep0+=Mi(e.m_PosAlignDecoder,e.m_RangeDecoder),e.rep0<0)return e.rep0==-1?1:-1}else e.rep0=I;if(m(b(e.rep0),e.nowPos64)>=0||e.rep0>=e.m_DictionarySizeCheck)return-1;P(e.m_OutWindow,e.rep0,k),e.nowPos64=p(e.nowPos64,b(k)),e.prevByte=Y(e.m_OutWindow,0)}return 0}function Ue(e){e.m_OutWindow={},e.m_RangeDecoder={},e.m_IsMatchDecoders=S(192),e.m_IsRepDecoders=S(12),e.m_IsRepG0Decoders=S(12),e.m_IsRepG1Decoders=S(12),e.m_IsRepG2Decoders=S(12),e.m_IsRep0LongDecoders=S(192),e.m_PosSlotDecoder=S(4),e.m_PosDecoders=S(114),e.m_PosAlignDecoder=or({},4),e.m_LenDecoder=wr({}),e.m_RepLenDecoder=wr({}),e.m_LiteralDecoder={};for(var u=0;u<4;++u)e.m_PosSlotDecoder[u]=or({},6);return e}function Wt(e){e.m_OutWindow._streamPos=0,e.m_OutWindow._pos=0,Le(e.m_IsMatchDecoders),Le(e.m_IsRep0LongDecoders),Le(e.m_IsRepDecoders),Le(e.m_IsRepG0Decoders),Le(e.m_IsRepG1Decoders),Le(e.m_IsRepG2Decoders),Le(e.m_PosDecoders),ii(e.m_LiteralDecoder);for(var u=0;u<4;++u)Le(e.m_PosSlotDecoder[u].Models);ar(e.m_LenDecoder),ar(e.m_RepLenDecoder),Le(e.m_PosAlignDecoder.Models),Fi(e.m_RangeDecoder)}function ir(e,u){var g,k,x,I,G,re,se;if(u.length<5)return 0;for(se=u[0]&255,x=se%9,re=~~(se/9),I=re%5,G=~~(re/5),g=0,k=0;k<4;++k)g+=(u[1+k]&255)<<k*8;return g>99999999||!gr(e,x,I,G)?0:dt(e,g)}function dt(e,u){return u<0?0:(e.m_DictionarySize!=u&&(e.m_DictionarySize=u,e.m_DictionarySizeCheck=Math.max(e.m_DictionarySize,1),L(e.m_OutWindow,Math.max(e.m_DictionarySizeCheck,4096))),1)}function gr(e,u,g,k){if(u>8||g>4||k>4)return 0;Ot(e.m_LiteralDecoder,g,u);var x=1<<k;return vr(e.m_LenDecoder,x),vr(e.m_RepLenDecoder,x),e.m_PosStateMask=x-1,1}function vr(e,u){for(;e.m_NumPosStates<u;++e.m_NumPosStates)e.m_LowCoder[e.m_NumPosStates]=or({},3),e.m_MidCoder[e.m_NumPosStates]=or({},3)}function br(e,u,g){if(!rt(u,e.m_Choice,0))return kr(e.m_LowCoder[g],u);var k=8;return rt(u,e.m_Choice,1)?k+=8+kr(e.m_HighCoder,u):k+=kr(e.m_MidCoder[g],u),k}function wr(e){return e.m_Choice=S(2),e.m_LowCoder=S(16),e.m_MidCoder=S(16),e.m_HighCoder=or({},8),e.m_NumPosStates=0,e}function ar(e){Le(e.m_Choice);for(var u=0;u<e.m_NumPosStates;++u)Le(e.m_LowCoder[u].Models),Le(e.m_MidCoder[u].Models);Le(e.m_HighCoder.Models)}function Ot(e,u,g){var k,x;if(!(e.m_Coders!=null&&e.m_NumPrevBits==g&&e.m_NumPosBits==u))for(e.m_NumPosBits=u,e.m_PosMask=(1<<u)-1,e.m_NumPrevBits=g,x=1<<e.m_NumPrevBits+e.m_NumPosBits,e.m_Coders=S(x),k=0;k<x;++k)e.m_Coders[k]=si({})}function Ht(e,u,g){return e.m_Coders[((u&e.m_PosMask)<<e.m_NumPrevBits)+((g&255)>>>8-e.m_NumPrevBits)]}function ii(e){var u,g;for(g=1<<e.m_NumPrevBits+e.m_NumPosBits,u=0;u<g;++u)Le(e.m_Coders[u].m_Decoders)}function ai(e,u){var g=1;do g=g<<1|rt(u,e.m_Decoders,g);while(g<256);return g<<24>>24}function oi(e,u,g){var k,x,I=1;do if(x=g>>7&1,g<<=1,k=rt(u,e.m_Decoders,(1+x<<8)+I),I=I<<1|k,x!=k){for(;I<256;)I=I<<1|rt(u,e.m_Decoders,I);break}while(I<256);return I<<24>>24}function si(e){return e.m_Decoders=S(768),e}var Zt=function(){var e,u,g,k=2,x=[0,1];for(g=2;g<22;++g)for(u=1<<(g>>1)-1,e=0;e<u;++e,++k)x[k]=g<<24>>24;return x}();function nn(e,u){var g,k,x,I;e._optimumEndIndex=u,x=e._optimum[u].PosPrev,k=e._optimum[u].BackPrev;do e._optimum[u].Prev1IsChar&&(pn(e._optimum[x]),e._optimum[x].PosPrev=x-1,e._optimum[u].Prev2&&(e._optimum[x-1].Prev1IsChar=0,e._optimum[x-1].PosPrev=e._optimum[u].PosPrev2,e._optimum[x-1].BackPrev=e._optimum[u].BackPrev2)),I=x,g=k,k=e._optimum[I].BackPrev,x=e._optimum[I].PosPrev,e._optimum[I].BackPrev=g,e._optimum[I].PosPrev=u,u=I;while(u>0);return e.backRes=e._optimum[0].BackPrev,e._optimumCurrentIndex=e._optimum[0].PosPrev,e._optimumCurrentIndex}function li(e){e._state=0,e._previousByte=0;for(var u=0;u<4;++u)e._repDistances[u]=0}function ui(e,u,g,k){var x,I,G,re,se,oe,le,Ie,_e,be,Ye,ue,ke,je,Pe;if(u[0]=s,g[0]=s,k[0]=1,e._inStream&&(e._matchFinder._stream=e._inStream,it(e._matchFinder),e._needReleaseMFStream=1,e._inStream=null),!e._finished){if(e._finished=1,je=e.nowPos64,h(e.nowPos64,s)){if(!ee(e._matchFinder)){zr(e,_(e.nowPos64));return}Nr(e),ke=_(e.nowPos64)&e._posStateMask,Ge(e._rangeEncoder,e._isMatch,(e._state<<4)+ke,0),e._state=J(e._state),G=ie(e._matchFinder,-e._additionalOffset),mn(Xt(e._literalEncoder,_(e.nowPos64),e._previousByte),e._rangeEncoder,G),e._previousByte=G,--e._additionalOffset,e.nowPos64=p(e.nowPos64,f)}if(!ee(e._matchFinder)){zr(e,_(e.nowPos64));return}for(;;){if(le=di(e,_(e.nowPos64)),be=e.backRes,ke=_(e.nowPos64)&e._posStateMask,I=(e._state<<4)+ke,le==1&&be==-1)Ge(e._rangeEncoder,e._isMatch,I,0),G=ie(e._matchFinder,-e._additionalOffset),Pe=Xt(e._literalEncoder,_(e.nowPos64),e._previousByte),e._state<7?mn(Pe,e._rangeEncoder,G):(_e=ie(e._matchFinder,-e._repDistances[0]-1-e._additionalOffset),yi(Pe,e._rangeEncoder,_e,G)),e._previousByte=G,e._state=J(e._state);else{if(Ge(e._rangeEncoder,e._isMatch,I,1),be<4){if(Ge(e._rangeEncoder,e._isRep,e._state,1),be?(Ge(e._rangeEncoder,e._isRepG0,e._state,1),be==1?Ge(e._rangeEncoder,e._isRepG1,e._state,0):(Ge(e._rangeEncoder,e._isRepG1,e._state,1),Ge(e._rangeEncoder,e._isRepG2,e._state,be-2))):(Ge(e._rangeEncoder,e._isRepG0,e._state,0),le==1?Ge(e._rangeEncoder,e._isRep0Long,I,0):Ge(e._rangeEncoder,e._isRep0Long,I,1)),le==1?e._state=e._state<7?9:11:(Gr(e._repMatchLenEncoder,e._rangeEncoder,le-2,ke),e._state=e._state<7?8:11),re=e._repDistances[be],be!=0){for(oe=be;oe>=1;--oe)e._repDistances[oe]=e._repDistances[oe-1];e._repDistances[0]=re}}else{for(Ge(e._rangeEncoder,e._isRep,e._state,0),e._state=e._state<7?7:10,Gr(e._lenEncoder,e._rangeEncoder,le-2,ke),be-=4,ue=Ur(be),Ie=ne(le),lr(e._posSlotEncoder[Ie],e._rangeEncoder,ue),ue>=4&&(se=(ue>>1)-1,x=(2|ue&1)<<se,Ye=be-x,ue<14?Li(e._posEncoders,x-ue-1,e._rangeEncoder,se,Ye):(gn(e._rangeEncoder,Ye>>4,se-4),_n(e._posAlignEncoder,e._rangeEncoder,Ye&15),++e._alignPriceCount)),re=be,oe=3;oe>=1;--oe)e._repDistances[oe]=e._repDistances[oe-1];e._repDistances[0]=re,++e._matchPriceCount}e._previousByte=ie(e._matchFinder,le-1-e._additionalOffset)}if(e._additionalOffset-=le,e.nowPos64=p(e.nowPos64,b(le)),!e._additionalOffset){if(e._matchPriceCount>=128&&on(e),e._alignPriceCount>=16&&an(e),u[0]=e.nowPos64,g[0]=Oi(e._rangeEncoder),!ee(e._matchFinder)){zr(e,_(e.nowPos64));return}if(m(U(e.nowPos64,je),[4096,0])>=0){e._finished=0,k[0]=0;return}}}}}function ci(e){var u,g;e._matchFinder||(u={},g=4,e._matchFinderType||(g=2),N(u,g),e._matchFinder=u),Pi(e._literalEncoder,e._numLiteralPosStateBits,e._numLiteralContextBits),!(e._dictionarySize==e._dictionarySizePrev&&e._numFastBytesPrev==e._numFastBytes)&&(Ne(e._matchFinder,e._dictionarySize,4096,e._numFastBytes,274),e._dictionarySizePrev=e._dictionarySize,e._numFastBytesPrev=e._numFastBytes)}function fi(e){var u;for(e._repDistances=S(4),e._optimum=[],e._rangeEncoder={},e._isMatch=S(192),e._isRep=S(12),e._isRepG0=S(12),e._isRepG1=S(12),e._isRepG2=S(12),e._isRep0Long=S(192),e._posSlotEncoder=[],e._posEncoders=S(114),e._posAlignEncoder=sr({},4),e._lenEncoder=dn({}),e._repMatchLenEncoder=dn({}),e._literalEncoder={},e._matchDistances=[],e._posSlotPrices=[],e._distancesPrices=[],e._alignPrices=S(16),e.reps=S(4),e.repLens=S(4),e.processedInSize=[s],e.processedOutSize=[s],e.finished=[0],e.properties=S(5),e.tempPrices=S(128),e._longestMatchLength=0,e._matchFinderType=1,e._numDistancePairs=0,e._numFastBytesPrev=-1,e.backRes=0,u=0;u<4096;++u)e._optimum[u]={};for(u=0;u<4;++u)e._posSlotEncoder[u]=sr({},6);return e}function an(e){for(var u=0;u<16;++u)e._alignPrices[u]=Ti(e._posAlignEncoder,u);e._alignPriceCount=0}function on(e){var u,g,k,x,I,G,re,se;for(x=4;x<128;++x)G=Ur(x),k=(G>>1)-1,u=(2|G&1)<<k,e.tempPrices[x]=Ai(e._posEncoders,u-G-1,k,x-u);for(I=0;I<4;++I){for(g=e._posSlotEncoder[I],re=I<<6,G=0;G<e._distTableSize;++G)e._posSlotPrices[re+G]=Pr(g,G);for(G=14;G<e._distTableSize;++G)e._posSlotPrices[re+G]+=(G>>1)-1-4<<6;for(se=I*128,x=0;x<4;++x)e._distancesPrices[se+x]=e._posSlotPrices[re+x];for(;x<128;++x)e._distancesPrices[se+x]=e._posSlotPrices[re+Ur(x)]+e.tempPrices[x]}e._matchPriceCount=0}function zr(e,u){un(e),bi(e,u&e._posStateMask);for(var g=0;g<5;++g)Vr(e._rangeEncoder)}function di(e,u){var g,k,x,I,G,re,se,oe,le,Ie,_e,be,Ye,ue,ke,je,Pe,ht,Qe,mt,vt,at,Kt,yr,pt,bt,wt,nt,Pt,We,fe,Tt,zt,Je,Ce,Sn,_t,cr,Nt,Et,qt,fr,Ee,Xe,Qt,kn,Pn,En,yn,Bn;if(e._optimumEndIndex!=e._optimumCurrentIndex)return Ye=e._optimum[e._optimumCurrentIndex].PosPrev-e._optimumCurrentIndex,e.backRes=e._optimum[e._optimumCurrentIndex].BackPrev,e._optimumCurrentIndex=e._optimum[e._optimumCurrentIndex].PosPrev,Ye;if(e._optimumCurrentIndex=e._optimumEndIndex=0,e._longestMatchWasFound?(be=e._longestMatchLength,e._longestMatchWasFound=0):be=Nr(e),wt=e._numDistancePairs,pt=ee(e._matchFinder)+1,pt<2)return e.backRes=-1,1;for(pt>273&&(pt=273),Et=0,le=0;le<4;++le)e.reps[le]=e._repDistances[le],e.repLens[le]=te(e._matchFinder,-1,e.reps[le],273),e.repLens[le]>e.repLens[Et]&&(Et=le);if(e.repLens[Et]>=e._numFastBytes)return e.backRes=Et,Ye=e.repLens[Et],ln(e,Ye-1),Ye;if(be>=e._numFastBytes)return e.backRes=e._matchDistances[wt-1]+4,ln(e,be-1),be;if(se=ie(e._matchFinder,-1),Pe=ie(e._matchFinder,-e._repDistances[0]-1-1),be<2&&se!=Pe&&e.repLens[Et]<2)return e.backRes=-1,1;if(e._optimum[0].State=e._state,Je=u&e._posStateMask,e._optimum[1].Price=Be[e._isMatch[(e._state<<4)+Je]>>>2]+Sr(Xt(e._literalEncoder,u,e._previousByte),e._state>=7,Pe,se),pn(e._optimum[1]),ht=Be[2048-e._isMatch[(e._state<<4)+Je]>>>2],Nt=ht+Be[2048-e._isRep[e._state]>>>2],Pe==se&&(qt=Nt+hi(e,e._state,Je),qt<e._optimum[1].Price&&(e._optimum[1].Price=qt,xi(e._optimum[1]))),_e=be>=e.repLens[Et]?be:e.repLens[Et],_e<2)return e.backRes=e._optimum[1].BackPrev,1;e._optimum[1].PosPrev=0,e._optimum[0].Backs0=e.reps[0],e._optimum[0].Backs1=e.reps[1],e._optimum[0].Backs2=e.reps[2],e._optimum[0].Backs3=e.reps[3],Ie=_e;do e._optimum[Ie--].Price=268435455;while(Ie>=2);for(le=0;le<4;++le)if(cr=e.repLens[le],!(cr<2)){Sn=Nt+Yt(e,le,e._state,Je);do I=Sn+Rt(e._repMatchLenEncoder,cr-2,Je),fe=e._optimum[cr],I<fe.Price&&(fe.Price=I,fe.PosPrev=0,fe.BackPrev=le,fe.Prev1IsChar=0);while(--cr>=2)}if(yr=ht+Be[e._isRep[e._state]>>>2],Ie=e.repLens[0]>=2?e.repLens[0]+1:2,Ie<=be){for(nt=0;Ie>e._matchDistances[nt];)nt+=2;for(;oe=e._matchDistances[nt+1],I=yr+sn(e,oe,Ie,Je),fe=e._optimum[Ie],I<fe.Price&&(fe.Price=I,fe.PosPrev=0,fe.BackPrev=oe+4,fe.Prev1IsChar=0),!(Ie==e._matchDistances[nt]&&(nt+=2,nt==wt));++Ie);}for(g=0;;){if(++g,g==_e)return nn(e,g);if(Qe=Nr(e),wt=e._numDistancePairs,Qe>=e._numFastBytes)return e._longestMatchLength=Qe,e._longestMatchWasFound=1,nn(e,g);if(++u,zt=e._optimum[g].PosPrev,e._optimum[g].Prev1IsChar?(--zt,e._optimum[g].Prev2?(Ee=e._optimum[e._optimum[g].PosPrev2].State,e._optimum[g].BackPrev2<4?Ee=Ee<7?8:11:Ee=Ee<7?7:10):Ee=e._optimum[zt].State,Ee=J(Ee)):Ee=e._optimum[zt].State,zt==g-1?e._optimum[g].BackPrev?Ee=J(Ee):Ee=Ee<7?9:11:(e._optimum[g].Prev1IsChar&&e._optimum[g].Prev2?(zt=e._optimum[g].PosPrev2,Tt=e._optimum[g].BackPrev2,Ee=Ee<7?8:11):(Tt=e._optimum[g].BackPrev,Tt<4?Ee=Ee<7?8:11:Ee=Ee<7?7:10),We=e._optimum[zt],Tt<4?Tt?Tt==1?(e.reps[0]=We.Backs1,e.reps[1]=We.Backs0,e.reps[2]=We.Backs2,e.reps[3]=We.Backs3):Tt==2?(e.reps[0]=We.Backs2,e.reps[1]=We.Backs0,e.reps[2]=We.Backs1,e.reps[3]=We.Backs3):(e.reps[0]=We.Backs3,e.reps[1]=We.Backs0,e.reps[2]=We.Backs1,e.reps[3]=We.Backs2):(e.reps[0]=We.Backs0,e.reps[1]=We.Backs1,e.reps[2]=We.Backs2,e.reps[3]=We.Backs3):(e.reps[0]=Tt-4,e.reps[1]=We.Backs0,e.reps[2]=We.Backs1,e.reps[3]=We.Backs2)),e._optimum[g].State=Ee,e._optimum[g].Backs0=e.reps[0],e._optimum[g].Backs1=e.reps[1],e._optimum[g].Backs2=e.reps[2],e._optimum[g].Backs3=e.reps[3],re=e._optimum[g].Price,se=ie(e._matchFinder,-1),Pe=ie(e._matchFinder,-e.reps[0]-1-1),Je=u&e._posStateMask,k=re+Be[e._isMatch[(Ee<<4)+Je]>>>2]+Sr(Xt(e._literalEncoder,u,ie(e._matchFinder,-2)),Ee>=7,Pe,se),at=e._optimum[g+1],mt=0,k<at.Price&&(at.Price=k,at.PosPrev=g,at.BackPrev=-1,at.Prev1IsChar=0,mt=1),ht=re+Be[2048-e._isMatch[(Ee<<4)+Je]>>>2],Nt=ht+Be[2048-e._isRep[Ee]>>>2],Pe==se&&!(at.PosPrev<g&&!at.BackPrev)&&(qt=Nt+(Be[e._isRepG0[Ee]>>>2]+Be[e._isRep0Long[(Ee<<4)+Je]>>>2]),qt<=at.Price&&(at.Price=qt,at.PosPrev=g,at.BackPrev=0,at.Prev1IsChar=0,mt=1)),bt=ee(e._matchFinder)+1,bt=4095-g<bt?4095-g:bt,pt=bt,!(pt<2)){if(pt>e._numFastBytes&&(pt=e._numFastBytes),!mt&&Pe!=se&&(Qt=Math.min(bt-1,e._numFastBytes),ke=te(e._matchFinder,0,e.reps[0],Qt),ke>=2)){for(Xe=J(Ee),Ce=u+1&e._posStateMask,Kt=k+Be[2048-e._isMatch[(Xe<<4)+Ce]>>>2]+Be[2048-e._isRep[Xe]>>>2],Pt=g+1+ke;_e<Pt;)e._optimum[++_e].Price=268435455;I=Kt+(kn=Rt(e._repMatchLenEncoder,ke-2,Ce),kn+Yt(e,0,Xe,Ce)),fe=e._optimum[Pt],I<fe.Price&&(fe.Price=I,fe.PosPrev=g+1,fe.BackPrev=0,fe.Prev1IsChar=1,fe.Prev2=0)}for(fr=2,_t=0;_t<4;++_t)if(ue=te(e._matchFinder,-1,e.reps[_t],pt),!(ue<2)){je=ue;do{for(;_e<g+ue;)e._optimum[++_e].Price=268435455;I=Nt+(Pn=Rt(e._repMatchLenEncoder,ue-2,Je),Pn+Yt(e,_t,Ee,Je)),fe=e._optimum[g+ue],I<fe.Price&&(fe.Price=I,fe.PosPrev=g,fe.BackPrev=_t,fe.Prev1IsChar=0)}while(--ue>=2);if(ue=je,_t||(fr=ue+1),ue<bt&&(Qt=Math.min(bt-1-ue,e._numFastBytes),ke=te(e._matchFinder,ue,e.reps[_t],Qt),ke>=2)){for(Xe=Ee<7?8:11,Ce=u+ue&e._posStateMask,x=Nt+(En=Rt(e._repMatchLenEncoder,ue-2,Je),En+Yt(e,_t,Ee,Je))+Be[e._isMatch[(Xe<<4)+Ce]>>>2]+Sr(Xt(e._literalEncoder,u+ue,ie(e._matchFinder,ue-1-1)),1,ie(e._matchFinder,ue-1-(e.reps[_t]+1)),ie(e._matchFinder,ue-1)),Xe=J(Xe),Ce=u+ue+1&e._posStateMask,vt=x+Be[2048-e._isMatch[(Xe<<4)+Ce]>>>2],Kt=vt+Be[2048-e._isRep[Xe]>>>2],Pt=ue+1+ke;_e<g+Pt;)e._optimum[++_e].Price=268435455;I=Kt+(yn=Rt(e._repMatchLenEncoder,ke-2,Ce),yn+Yt(e,0,Xe,Ce)),fe=e._optimum[g+Pt],I<fe.Price&&(fe.Price=I,fe.PosPrev=g+ue+1,fe.BackPrev=0,fe.Prev1IsChar=1,fe.Prev2=1,fe.PosPrev2=g,fe.BackPrev2=_t)}}if(Qe>pt){for(Qe=pt,wt=0;Qe>e._matchDistances[wt];wt+=2);e._matchDistances[wt]=Qe,wt+=2}if(Qe>=fr){for(yr=ht+Be[e._isRep[Ee]>>>2];_e<g+Qe;)e._optimum[++_e].Price=268435455;for(nt=0;fr>e._matchDistances[nt];)nt+=2;for(ue=fr;;++ue)if(G=e._matchDistances[nt+1],I=yr+sn(e,G,ue,Je),fe=e._optimum[g+ue],I<fe.Price&&(fe.Price=I,fe.PosPrev=g,fe.BackPrev=G+4,fe.Prev1IsChar=0),ue==e._matchDistances[nt]){if(ue<bt&&(Qt=Math.min(bt-1-ue,e._numFastBytes),ke=te(e._matchFinder,ue,G,Qt),ke>=2)){for(Xe=Ee<7?7:10,Ce=u+ue&e._posStateMask,x=I+Be[e._isMatch[(Xe<<4)+Ce]>>>2]+Sr(Xt(e._literalEncoder,u+ue,ie(e._matchFinder,ue-1-1)),1,ie(e._matchFinder,ue-(G+1)-1),ie(e._matchFinder,ue-1)),Xe=J(Xe),Ce=u+ue+1&e._posStateMask,vt=x+Be[2048-e._isMatch[(Xe<<4)+Ce]>>>2],Kt=vt+Be[2048-e._isRep[Xe]>>>2],Pt=ue+1+ke;_e<g+Pt;)e._optimum[++_e].Price=268435455;I=Kt+(Bn=Rt(e._repMatchLenEncoder,ke-2,Ce),Bn+Yt(e,0,Xe,Ce)),fe=e._optimum[g+Pt],I<fe.Price&&(fe.Price=I,fe.PosPrev=g+ue+1,fe.BackPrev=0,fe.Prev1IsChar=1,fe.Prev2=1,fe.PosPrev2=g,fe.BackPrev2=G+4)}if(nt+=2,nt==wt)break}}}}}function sn(e,u,g,k){var x,I=ne(g);return u<128?x=e._distancesPrices[I*128+u]:x=e._posSlotPrices[(I<<6)+wi(u)]+e._alignPrices[u&15],x+Rt(e._lenEncoder,g-2,k)}function Yt(e,u,g,k){var x;return u?(x=Be[2048-e._isRepG0[g]>>>2],u==1?x+=Be[e._isRepG1[g]>>>2]:(x+=Be[2048-e._isRepG1[g]>>>2],x+=ur(e._isRepG2[g],u-2))):(x=Be[e._isRepG0[g]>>>2],x+=Be[2048-e._isRep0Long[(g<<4)+k]>>>2]),x}function hi(e,u,g){return Be[e._isRepG0[u]>>>2]+Be[e._isRep0Long[(u<<4)+g]>>>2]}function mi(e){li(e),Ri(e._rangeEncoder),Le(e._isMatch),Le(e._isRep0Long),Le(e._isRep),Le(e._isRepG0),Le(e._isRepG1),Le(e._isRepG2),Le(e._posEncoders),Ei(e._literalEncoder);for(var u=0;u<4;++u)Le(e._posSlotEncoder[u].Models);cn(e._lenEncoder,1<<e._posStateBits),cn(e._repMatchLenEncoder,1<<e._posStateBits),Le(e._posAlignEncoder.Models),e._longestMatchWasFound=0,e._optimumEndIndex=0,e._optimumCurrentIndex=0,e._additionalOffset=0}function ln(e,u){u>0&&(B(e._matchFinder,u),e._additionalOffset+=u)}function Nr(e){var u=0;return e._numDistancePairs=st(e._matchFinder,e._matchDistances),e._numDistancePairs>0&&(u=e._matchDistances[e._numDistancePairs-2],u==e._numFastBytes&&(u+=te(e._matchFinder,u-1,e._matchDistances[e._numDistancePairs-1],273-u))),++e._additionalOffset,u}function un(e){e._matchFinder&&e._needReleaseMFStream&&(e._matchFinder._stream=null,e._needReleaseMFStream=0)}function pi(e){un(e),e._rangeEncoder.Stream=null}function _i(e,u){e._dictionarySize=u;for(var g=0;u>1<<g;++g);e._distTableSize=g*2}function gi(e,u){var g=e._matchFinderType;e._matchFinderType=u,e._matchFinder&&g!=e._matchFinderType&&(e._dictionarySizePrev=-1,e._matchFinder=null)}function vi(e,u){e.properties[0]=(e._posStateBits*5+e._numLiteralPosStateBits)*9+e._numLiteralContextBits<<24>>24;for(var g=0;g<4;++g)e.properties[1+g]=e._dictionarySize>>8*g<<24>>24;d(u,e.properties,0,5)}function bi(e,u){if(e._writeEndMark){Ge(e._rangeEncoder,e._isMatch,(e._state<<4)+u,1),Ge(e._rangeEncoder,e._isRep,e._state,0),e._state=e._state<7?7:10,Gr(e._lenEncoder,e._rangeEncoder,0,u);var g=ne(2);lr(e._posSlotEncoder[g],e._rangeEncoder,63),gn(e._rangeEncoder,67108863,26),_n(e._posAlignEncoder,e._rangeEncoder,15)}}function Ur(e){return e<2048?Zt[e]:e<2097152?Zt[e>>10]+20:Zt[e>>20]+40}function wi(e){return e<131072?Zt[e>>6]+12:e<134217728?Zt[e>>16]+32:Zt[e>>26]+52}function Si(e,u,g,k){g<8?(Ge(u,e._choice,0,0),lr(e._lowCoder[k],u,g)):(g-=8,Ge(u,e._choice,0,1),g<8?(Ge(u,e._choice,1,0),lr(e._midCoder[k],u,g)):(Ge(u,e._choice,1,1),lr(e._highCoder,u,g-8)))}function ki(e){e._choice=S(2),e._lowCoder=S(16),e._midCoder=S(16),e._highCoder=sr({},8);for(var u=0;u<16;++u)e._lowCoder[u]=sr({},3),e._midCoder[u]=sr({},3);return e}function cn(e,u){Le(e._choice);for(var g=0;g<u;++g)Le(e._lowCoder[g].Models),Le(e._midCoder[g].Models);Le(e._highCoder.Models)}function fn(e,u,g,k,x){var I,G,re,se,oe;for(I=Be[e._choice[0]>>>2],G=Be[2048-e._choice[0]>>>2],re=G+Be[e._choice[1]>>>2],se=G+Be[2048-e._choice[1]>>>2],oe=0,oe=0;oe<8;++oe){if(oe>=g)return;k[x+oe]=I+Pr(e._lowCoder[u],oe)}for(;oe<16;++oe){if(oe>=g)return;k[x+oe]=re+Pr(e._midCoder[u],oe-8)}for(;oe<g;++oe)k[x+oe]=se+Pr(e._highCoder,oe-8-8)}function Gr(e,u,g,k){Si(e,u,g,k),--e._counters[k]==0&&(fn(e,k,e._tableSize,e._prices,k*272),e._counters[k]=e._tableSize)}function dn(e){return ki(e),e._prices=[],e._counters=[],e}function Rt(e,u,g){return e._prices[g*272+u]}function hn(e,u){for(var g=0;g<u;++g)fn(e,g,e._tableSize,e._prices,g*272),e._counters[g]=e._tableSize}function Pi(e,u,g){var k,x;if(!(e.m_Coders!=null&&e.m_NumPrevBits==g&&e.m_NumPosBits==u))for(e.m_NumPosBits=u,e.m_PosMask=(1<<u)-1,e.m_NumPrevBits=g,x=1<<e.m_NumPrevBits+e.m_NumPosBits,e.m_Coders=S(x),k=0;k<x;++k)e.m_Coders[k]=Bi({})}function Xt(e,u,g){return e.m_Coders[((u&e.m_PosMask)<<e.m_NumPrevBits)+((g&255)>>>8-e.m_NumPrevBits)]}function Ei(e){var u,g=1<<e.m_NumPrevBits+e.m_NumPosBits;for(u=0;u<g;++u)Le(e.m_Coders[u].m_Encoders)}function mn(e,u,g){var k,x,I=1;for(x=7;x>=0;--x)k=g>>x&1,Ge(u,e.m_Encoders,I,k),I=I<<1|k}function yi(e,u,g,k){var x,I,G,re,se=1,oe=1;for(I=7;I>=0;--I)x=k>>I&1,re=oe,se&&(G=g>>I&1,re+=1+G<<8,se=G==x),Ge(u,e.m_Encoders,re,x),oe=oe<<1|x}function Bi(e){return e.m_Encoders=S(768),e}function Sr(e,u,g,k){var x,I=1,G=7,re,se=0;if(u){for(;G>=0;--G)if(re=g>>G&1,x=k>>G&1,se+=ur(e.m_Encoders[(1+re<<8)+I],x),I=I<<1|x,re!=x){--G;break}}for(;G>=0;--G)x=k>>G&1,se+=ur(e.m_Encoders[I],x),I=I<<1|x;return se}function pn(e){e.BackPrev=-1,e.Prev1IsChar=0}function xi(e){e.BackPrev=0,e.Prev1IsChar=0}function or(e,u){return e.NumBitLevels=u,e.Models=S(1<<u),e}function kr(e,u){var g,k=1;for(g=e.NumBitLevels;g!=0;--g)k=(k<<1)+rt(u,e.Models,k);return k-(1<<e.NumBitLevels)}function Mi(e,u){var g,k,x=1,I=0;for(k=0;k<e.NumBitLevels;++k)g=rt(u,e.Models,x),x<<=1,x+=g,I|=g<<k;return I}function Ii(e,u,g,k){var x,I,G=1,re=0;for(I=0;I<k;++I)x=rt(g,e,u+G),G<<=1,G+=x,re|=x<<I;return re}function sr(e,u){return e.NumBitLevels=u,e.Models=S(1<<u),e}function lr(e,u,g){var k,x,I=1;for(x=e.NumBitLevels;x!=0;)--x,k=g>>>x&1,Ge(u,e.Models,I,k),I=I<<1|k}function Pr(e,u){var g,k,x=1,I=0;for(k=e.NumBitLevels;k!=0;)--k,g=u>>>k&1,I+=ur(e.Models[x],g),x=(x<<1)+g;return I}function _n(e,u,g){var k,x,I=1;for(x=0;x<e.NumBitLevels;++x)k=g&1,Ge(u,e.Models,I,k),I=I<<1|k,g>>=1}function Ti(e,u){var g,k,x=1,I=0;for(k=e.NumBitLevels;k!=0;--k)g=u&1,u>>>=1,I+=ur(e.Models[x],g),x=x<<1|g;return I}function Li(e,u,g,k,x){var I,G,re=1;for(G=0;G<k;++G)I=x&1,Ge(g,e,u+re,I),re=re<<1|I,x>>=1}function Ai(e,u,g,k){var x,I,G=1,re=0;for(I=g;I!=0;--I)x=k&1,k>>>=1,re+=Be[((e[u+G]-x^-x)&2047)>>>2],G=G<<1|x;return re}function rt(e,u,g){var k,x=u[g];return k=(e.Range>>>11)*x,(e.Code^-2147483648)<(k^-2147483648)?(e.Range=k,u[g]=x+(2048-x>>>5)<<16>>16,e.Range&-16777216||(e.Code=e.Code<<8|R(e.Stream),e.Range<<=8),0):(e.Range-=k,e.Code-=k,u[g]=x-(x>>>5)<<16>>16,e.Range&-16777216||(e.Code=e.Code<<8|R(e.Stream),e.Range<<=8),1)}function Di(e,u){var g,k,x=0;for(g=u;g!=0;--g)e.Range>>>=1,k=e.Code-e.Range>>>31,e.Code-=e.Range&k-1,x=x<<1|1-k,e.Range&-16777216||(e.Code=e.Code<<8|R(e.Stream),e.Range<<=8);return x}function Fi(e){e.Code=0,e.Range=-1;for(var u=0;u<5;++u)e.Code=e.Code<<8|R(e.Stream)}function Le(e){for(var u=e.length-1;u>=0;--u)e[u]=1024}var Be=function(){var e,u,g,k,x=[];for(u=8;u>=0;--u)for(k=1<<9-u-1,e=1<<9-u,g=k;g<e;++g)x[g]=(u<<6)+(e-g<<6>>>9-u-1);return x}();function Ge(e,u,g,k){var x,I=u[g];x=(e.Range>>>11)*I,k?(e.Low=p(e.Low,E(b(x),[4294967295,0])),e.Range-=x,u[g]=I-(I>>>5)<<16>>16):(e.Range=x,u[g]=I+(2048-I>>>5)<<16>>16),e.Range&-16777216||(e.Range<<=8,Vr(e))}function gn(e,u,g){for(var k=g-1;k>=0;--k)e.Range>>>=1,(u>>>k&1)==1&&(e.Low=p(e.Low,b(e.Range))),e.Range&-16777216||(e.Range<<=8,Vr(e))}function Oi(e){return p(p(b(e._cacheSize),e._position),[4,0])}function Ri(e){e._position=s,e.Low=s,e.Range=-1,e._cacheSize=1,e._cache=0}function Vr(e){var u,g=_(H(e.Low,32));if(g!=0||m(e.Low,[4278190080,0])<0){e._position=p(e._position,b(e._cacheSize)),u=e._cache;do V(e.Stream,u+g),u=255;while(--e._cacheSize!=0);e._cache=_(e.Low)>>>24}++e._cacheSize,e.Low=D(E(e.Low,[16777215,0]),8)}function ur(e,u){return Be[((e-u^-u)&2047)>>>2]}function vn(e){for(var u=0,g=0,k,x,I,G=e.length,re=[],se=[];u<G;++u,++g){if(k=e[u]&255,k&128)if((k&224)==192){if(u+1>=G||(x=e[++u]&255,(x&192)!=128))return e;se[g]=(k&31)<<6|x&63}else if((k&240)==224){if(u+2>=G||(x=e[++u]&255,(x&192)!=128)||(I=e[++u]&255,(I&192)!=128))return e;se[g]=(k&15)<<12|(x&63)<<6|I&63}else return e;else{if(!k)return e;se[g]=k}g==16383&&(re.push(String.fromCharCode.apply(String,se)),g=-1)}return g>0&&(se.length=g,re.push(String.fromCharCode.apply(String,se))),re.join("")}function bn(e){var u,g=[],k,x=0,I,G=e.length;if(typeof e=="object")return e;for(W(e,0,G,g,0),I=0;I<G;++I)u=g[I],u>=1&&u<=127?++x:!u||u>=128&&u<=2047?x+=2:x+=3;for(k=[],x=0,I=0;I<G;++I)u=g[I],u>=1&&u<=127?k[x++]=u<<24>>24:!u||u>=128&&u<=2047?(k[x++]=(192|u>>6&31)<<24>>24,k[x++]=(128|u&63)<<24>>24):(k[x++]=(224|u>>12&15)<<24>>24,k[x++]=(128|u>>6&63)<<24>>24,k[x++]=(128|u&63)<<24>>24);return k}function Er(e){return e[1]+e[0]}function zi(e,u,g,k){var x={},I,G,re=typeof g>"u"&&typeof k>"u";if(typeof g!="function"&&(G=g,g=k=0),k=k||function(oe){if(!(typeof G>"u"))return v(oe,G)},g=g||function(oe,le){if(!(typeof G>"u"))return postMessage({action:t,cbn:G,result:oe,error:le})},re){for(x.c=C({},bn(e),wn(u));pe(x.c.chunker););return M(x.c.output)}try{x.c=C({},bn(e),wn(u)),k(0)}catch(oe){return g(null,oe)}function se(){try{for(var oe,le=new Date().getTime();pe(x.c.chunker);)if(I=Er(x.c.chunker.inBytesProcessed)/Er(x.c.length_0),new Date().getTime()-le>200)return k(I),i(se,0),0;k(1),oe=M(x.c.output),i(g.bind(null,oe),0)}catch(Ie){g(null,Ie)}}i(se,0)}function Ni(e,u,g){var k={},x,I,G,re,se=typeof u>"u"&&typeof g>"u";if(typeof u!="function"&&(I=u,u=g=0),g=g||function(le){if(!(typeof I>"u"))return v(G?le:-1,I)},u=u||function(le,Ie){if(!(typeof I>"u"))return postMessage({action:r,cbn:I,result:le,error:Ie})},se){for(k.d=z({},e);pe(k.d.chunker););return vn(M(k.d.output))}try{k.d=z({},e),re=Er(k.d.length_0),G=re>-1,g(0)}catch(le){return u(null,le)}function oe(){try{for(var le,Ie=0,_e=new Date().getTime();pe(k.d.chunker);)if(++Ie%1e3==0&&new Date().getTime()-_e>200)return G&&(x=Er(k.d.chunker.decoder.nowPos64)/re,g(x)),i(oe,0),0;g(1),le=vn(M(k.d.output)),i(u.bind(null,le),0)}catch(be){u(null,be)}}i(oe,0)}var wn=function(){var e=[{s:16,f:64,m:0},{s:20,f:64,m:0},{s:19,f:64,m:1},{s:20,f:64,m:1},{s:21,f:128,m:1},{s:22,f:128,m:1},{s:23,f:128,m:1},{s:24,f:255,m:1},{s:25,f:255,m:1}];return function(u){return e[u-1]||e[6]}}();return{compress:zi,decompress:Ni}}();class X{static parseInt(r,n=this.MAX_PARSE_VALUE,i=!1){return this._getValue(parseInt(r),n,i)}static parseFloat(r,n=this.MAX_PARSE_VALUE,i=!1){return this._getValue(parseFloat(r),n,i)}static parseEnum(r,n){const i=n.trim(),a=parseInt(i);if(a in r)return a;if(i in r)return r[i];throw new Error("Unknown enum value!")}static parseByte(r){const n=parseInt(r);if(n<0)throw new Error("Value must be greater than 0!");if(n>255)throw new Error("Value must be less than 255!");return this._getValue(n)}static _getValue(r,n=this.MAX_PARSE_VALUE,i=!1){if(r<-n)throw new Error("Value is too low!");if(r>n)throw new Error("Value is too high!");if(!i&&Number.isNaN(r))throw new Error("Not a number");return r}}X.MAX_COORDINATE_VALUE=131072;X.MAX_PARSE_VALUE=2147483647;class qa{static handleLine(r,n){const[i,...a]=r.split(":"),o=a.join(":").trim().split(",").map(s=>X.parseByte(s));if(o.length!==3&&o.length!==4)throw new Error(`Color specified in incorrect format (should be R,G,B or R,G,B,A): ${o.join(",")}`);const l=new Lt(o[0],o[1],o[2],o[3]);this.addColor(l,n,i.trim())}static addColor(r,n,i){if(i==="SliderTrackOverride"){n.colors.sliderTrackColor=r;return}if(i==="SliderBorder"){n.colors.sliderBorderColor=r;return}i.startsWith("Combo")&&n.colors.comboColors.push(r)}}class Qa{static handleLine(r,n){const[i,...a]=r.split(":"),o=a.join(":").trim();switch(i.trim()){case"CircleSize":n.difficulty.circleSize=X.parseFloat(o);break;case"HPDrainRate":n.difficulty.drainRate=X.parseFloat(o);break;case"OverallDifficulty":n.difficulty.overallDifficulty=X.parseFloat(o);break;case"ApproachRate":n.difficulty.approachRate=X.parseFloat(o);break;case"SliderMultiplier":n.difficulty.sliderMultiplier=X.parseFloat(o);break;case"SliderTickRate":n.difficulty.sliderTickRate=X.parseFloat(o)}}}class Ja{static handleLine(r,n){const[i,...a]=r.split(":"),o=a.join(":").trim();switch(i.trim()){case"Bookmarks":n.editor.bookmarks=o.split(",").map(l=>+l);break;case"DistanceSpacing":n.editor.distanceSpacing=Math.max(0,X.parseFloat(o));break;case"BeatDivisor":n.editor.beatDivisor=X.parseInt(o);break;case"GridSize":n.editor.gridSize=X.parseInt(o);break;case"TimelineZoom":n.editor.timelineZoom=Math.max(0,X.parseFloat(o))}}}class ti{static handleLine(r,n){const i=this._getDepth(r);switch(i>0&&(r=r.substring(i)),i<2&&this._storyboardSprite&&(this._timelineGroup=this._storyboardSprite.timelineGroup),i){case 0:return this._handleElement(r,n);case 1:return this._handleCompoundOrCommand(r);case 2:return this._handleCommand(r)}}static _handleElement(r,n){let i;const a=r.split(","),o=this.parseEventType(a[0]);switch(!((i=this._storyboardSprite)===null||i===void 0)&&i.hasCommands&&(this._storyboardSprite.updateCommands(),this._storyboardSprite.adjustTimesToCommands(),this._storyboardSprite.resetValuesToCommands()),o){case qe.Video:{const l=n.getLayerByType(ut.Video),s=X.parseInt(a[1]),f=a[2].replace(/"/g,"");l.elements.push(new Jn(f,s));return}case qe.Sprite:{const l=n.getLayerByType(this.parseLayerType(a[1])),s=this.parseOrigin(a[2]),f=this.convertOrigin(s),v=a[3].replace(/"/g,""),S=X.parseFloat(a[4],X.MAX_COORDINATE_VALUE),p=X.parseFloat(a[5],X.MAX_COORDINATE_VALUE);this._storyboardSprite=new qr(v,s,f,new Me(S,p)),l.elements.push(this._storyboardSprite);return}case qe.Animation:{const l=n.getLayerByType(this.parseLayerType(a[1])),s=this.parseOrigin(a[2]),f=this.convertOrigin(s),v=a[3].replace(/"/g,""),S=X.parseFloat(a[4],X.MAX_COORDINATE_VALUE),p=X.parseFloat(a[5],X.MAX_COORDINATE_VALUE),E=X.parseInt(a[6]);let m=X.parseFloat(a[7]);n.fileFormat<6&&(m=Math.round(.015*m)*1.186*(1e3/60));const w=this.parseLoopType(a[8]);this._storyboardSprite=new qn(v,s,f,new Me(S,p),E,m,w),l.elements.push(this._storyboardSprite);return}case qe.Sample:{const l=X.parseFloat(a[1]),s=n.getLayerByType(this.parseLayerType(a[2])),f=a[3].replace(/"/g,""),v=a.length>4?X.parseInt(a[4]):100,S=new Qn(f,l,v);s.elements.push(S)}}}static _handleCompoundOrCommand(r){let n,i;const a=r.split(",");switch(a[0]){case $t.Trigger:{this._timelineGroup=(n=this._storyboardSprite)===null||n===void 0?void 0:n.addTrigger(a[1],a.length>2?X.parseFloat(a[2]):-1/0,a.length>3?X.parseFloat(a[3]):1/0,a.length>4?X.parseInt(a[4]):0);return}case $t.Loop:{this._timelineGroup=(i=this._storyboardSprite)===null||i===void 0?void 0:i.addLoop(X.parseFloat(a[1]),Math.max(0,X.parseInt(a[2])-1));return}default:this._handleCommand(r)}}static _handleCommand(r){let n,i,a,o,l,s,f,v,S;const p=r.split(","),E=p[0],m=X.parseInt(p[1]),w=X.parseInt(p[2]),h=X.parseInt(p[3]||p[2]);switch(E){case xe.Fade:{const b=X.parseFloat(p[4]),_=p.length>5?X.parseFloat(p[5]):b;(n=this._timelineGroup)===null||n===void 0||n.alpha.add(E,m,w,h,b,_);return}case xe.Scale:{const b=X.parseFloat(p[4]),_=p.length>5?X.parseFloat(p[5]):b;(i=this._timelineGroup)===null||i===void 0||i.scale.add(E,m,w,h,b,_);return}case xe.VectorScale:{const b=X.parseFloat(p[4]),_=X.parseFloat(p[5]),y=p.length>6?X.parseFloat(p[6]):b,T=p.length>7?X.parseFloat(p[7]):_;(a=this._timelineGroup)===null||a===void 0||a.vectorScale.add(E,m,w,h,new Me(b,_),new Me(y,T));return}case xe.Rotation:{const b=X.parseFloat(p[4]),_=p.length>5?X.parseFloat(p[5]):b;(o=this._timelineGroup)===null||o===void 0||o.rotation.add(E,m,w,h,b,_);return}case xe.Movement:{const b=X.parseFloat(p[4]),_=X.parseFloat(p[5]),y=p.length>6?X.parseFloat(p[6]):b,T=p.length>7?X.parseFloat(p[7]):_;(l=this._timelineGroup)===null||l===void 0||l.x.add(xe.MovementX,m,w,h,b,y),(s=this._timelineGroup)===null||s===void 0||s.y.add(xe.MovementY,m,w,h,_,T);return}case xe.MovementX:{const b=X.parseFloat(p[4]),_=p.length>5?X.parseFloat(p[5]):b;(f=this._timelineGroup)===null||f===void 0||f.x.add(E,m,w,h,b,_);return}case xe.MovementY:{const b=X.parseFloat(p[4]),_=p.length>5?X.parseFloat(p[5]):b;(v=this._timelineGroup)===null||v===void 0||v.y.add(E,m,w,h,b,_);return}case xe.Color:{const b=X.parseFloat(p[4]),_=X.parseFloat(p[5]),y=X.parseFloat(p[6]),T=p.length>7?X.parseFloat(p[7]):b,D=p.length>8?X.parseFloat(p[8]):_,A=p.length>9?X.parseFloat(p[9]):y;(S=this._timelineGroup)===null||S===void 0||S.color.add(E,m,w,h,new Lt(b,_,y,1),new Lt(T,D,A,1));return}case xe.Parameter:return this._handleParameterCommand(p)}throw new Error(`Unknown command type: ${E}`)}static _handleParameterCommand(r){let n,i,a;const o=xe.Parameter,l=X.parseInt(r[1]),s=X.parseInt(r[2]),f=X.parseInt(r[3]||r[2]),v=r[4];switch(v){case xt.BlendingMode:{const S=He.Additive,p=s===f?He.Additive:He.Inherit;(n=this._timelineGroup)===null||n===void 0||n.blendingParameters.add(o,l,s,f,S,p,v);return}case xt.HorizontalFlip:(i=this._timelineGroup)===null||i===void 0||i.flipH.add(o,l,s,f,!0,s===f,v);return;case xt.VerticalFlip:{(a=this._timelineGroup)===null||a===void 0||a.flipV.add(o,l,s,f,!0,s===f,v);return}}throw new Error(`Unknown parameter type: ${v}`)}static parseEventType(r){if(r.startsWith(" ")||r.startsWith("_"))return qe.StoryboardCommand;try{return X.parseEnum(qe,r)}catch{throw new Error(`Unknown event type: ${r}`)}}static parseLayerType(r){try{return X.parseEnum(ut,r)}catch{throw new Error(`Unknown layer type: ${r}`)}}static parseOrigin(r){try{return X.parseEnum($e,r)}catch{return $e.TopLeft}}static convertOrigin(r){switch(r){case $e.TopLeft:return ot.TopLeft;case $e.TopCentre:return ot.TopCentre;case $e.TopRight:return ot.TopRight;case $e.CentreLeft:return ot.CentreLeft;case $e.Centre:return ot.Centre;case $e.CentreRight:return ot.CentreRight;case $e.BottomLeft:return ot.BottomLeft;case $e.BottomCentre:return ot.BottomCentre;case $e.BottomRight:return ot.BottomRight}return ot.TopLeft}static parseLoopType(r){try{return X.parseEnum(hr,r)}catch{return hr.LoopForever}}static _getDepth(r){let n=0;for(const i of r){if(i!==" "&&i!=="_")break;++n}return n}}class Ca{static handleLine(r,n,i,a){const o=r.split(",").map((s,f)=>f?s.trim():s);switch(ti.parseEventType(o[0])){case qe.Background:n.events.backgroundPath=o[2].replace(/"/g,"");break;case qe.Break:{const s=X.parseFloat(o[1])+a,f=Math.max(s,X.parseFloat(o[2])+a),v=new Xa(s,f);n.events.breaks||(n.events.breaks=[]),n.events.breaks.push(v);break}case qe.Video:case qe.Sample:case qe.Sprite:case qe.Animation:case qe.StoryboardCommand:i&&i.push(r)}}}class $a{static handleLine(r,n,i){const[a,...o]=r.split(":"),l=o.join(":").trim();switch(a.trim()){case"AudioFilename":n.general.audioFilename=l;break;case"AudioHash":n.general.audioHash=l;break;case"OverlayPosition":n.general.overlayPosition=l;break;case"SkinPreference":n.general.skinPreference=l;break;case"AudioLeadIn":n.general.audioLeadIn=X.parseInt(l);break;case"PreviewTime":n.general.previewTime=X.parseInt(l)+i;break;case"Countdown":n.general.countdown=X.parseInt(l);break;case"StackLeniency":n.general.stackLeniency=X.parseFloat(l);break;case"Mode":n.originalMode=X.parseInt(l);break;case"CountdownOffset":n.general.countdownOffset=X.parseInt(l);break;case"SampleSet":n.general.sampleSet=Ae[l];break;case"LetterboxInBreaks":n.general.letterboxInBreaks=l==="1";break;case"StoryFireInFront":n.general.storyFireInFront=l==="1";break;case"UseSkinSprites":n.general.useSkinSprites=l==="1";break;case"AlwaysShowPlayfield":n.general.alwaysShowPlayfield=l==="1";break;case"EpilepsyWarning":n.general.epilepsyWarning=l==="1";break;case"SpecialStyle":n.general.specialStyle=l==="1";break;case"WidescreenStoryboard":n.general.widescreenStoryboard=l==="1";break;case"SamplesMatchPlaybackRate":n.general.samplesMatchPlaybackRate=l==="1"}}}class eo extends Dr{constructor(){super(...arguments),this.isNewCombo=!1,this.comboOffset=0}clone(){const r=super.clone();return r.isNewCombo=this.isNewCombo,r.comboOffset=this.comboOffset,r}}class to extends Dr{constructor(){super(...arguments),this.endTime=0,this.nodeSamples=[]}get duration(){return this.endTime-this.startTime}clone(){const r=super.clone();return r.endTime=this.endTime,r.nestedHitObjects=this.nestedHitObjects.map(n=>n.clone()),r.nodeSamples=this.nodeSamples.map(n=>n.map(i=>i.clone())),r}}class Fr extends Dr{constructor(){super(...arguments),this.repeats=0,this.velocity=1,this.path=new en,this.legacyLastTickOffset=36,this.nodeSamples=[],this.isNewCombo=!1,this.comboOffset=0}get duration(){return this.spans*this.spanDuration}get endTime(){return this.startTime+this.duration}get spans(){return this.repeats+1}set spans(r){this.repeats=r-1}get spanDuration(){return this.distance/this.velocity}get distance(){return this.path.distance}set distance(r){this.path.distance=r}applyDefaultsToSelf(r,n){super.applyDefaultsToSelf(r,n);const i=r.timingPointAt(this.startTime),a=r.difficultyPointAt(this.startTime),o=Fr.BASE_SCORING_DISTANCE*n.sliderMultiplier*a.sliderVelocity;this.velocity=o/i.beatLength}clone(){const r=super.clone();return r.legacyLastTickOffset=this.legacyLastTickOffset,r.nodeSamples=this.nodeSamples.map(n=>n.map(i=>i.clone())),r.velocity=this.velocity,r.repeats=this.repeats,r.path=this.path.clone(),r.isNewCombo=this.isNewCombo,r.comboOffset=this.comboOffset,r}}Fr.BASE_SCORING_DISTANCE=100;class ro extends Dr{constructor(){super(...arguments),this.endTime=0,this.isNewCombo=!1,this.comboOffset=0}get duration(){return this.endTime-this.startTime}clone(){const r=super.clone();return r.endTime=this.endTime,r.isNewCombo=this.isNewCombo,r.comboOffset=this.comboOffset,r}}let ft;(function(t){t.Beatmap=".osu",t.Storyboard=".osb",t.Replay=".osr"})(ft||(ft={}));let gt;(function(t){t[t.FileFormat=0]="FileFormat",t[t.Section=1]="Section",t[t.Empty=2]="Empty",t[t.Data=3]="Data",t[t.Break=4]="Break"})(gt||(gt={}));let De;(function(t){t.General="General",t.Editor="Editor",t.Metadata="Metadata",t.Difficulty="Difficulty",t.Events="Events",t.TimingPoints="TimingPoints",t.Colours="Colours",t.HitObjects="HitObjects",t.Variables="Variables",t.Fonts="Fonts",t.CatchTheBeat="CatchTheBeat",t.Mania="Mania"})(De||(De={}));const Ct=function(){throw new Error("Filesystem operations are not available in a browser environment")};class no{static encodeColors(r){const n=r.colors;if(Object.keys(n).length===1&&!n.comboColors.length)return"";const i=["[Colours]"];return n.comboColors.forEach((a,o)=>{i.push(`Combo${o+1}:${a}`)}),n.sliderTrackColor&&i.push(`SliderTrackOverride:${n.sliderTrackColor}`),n.sliderBorderColor&&i.push(`SliderBorder:${n.sliderBorderColor}`),i.join(`
`)}}class io{static encodeDifficultySection(r){const n=["[Difficulty]"],i=r.difficulty;return n.push(`HPDrainRate:${i.drainRate}`),n.push(`CircleSize:${i.circleSize}`),n.push(`OverallDifficulty:${i.overallDifficulty}`),n.push(`ApproachRate:${i.approachRate}`),n.push(`SliderMultiplier:${i.sliderMultiplier}`),n.push(`SliderTickRate:${i.sliderTickRate}`),n.join(`
`)}}class ao{static encodeEditorSection(r){const n=["[Editor]"],i=r.editor;return n.push(`Bookmarks:${i.bookmarks.join(",")}`),n.push(`DistanceSpacing:${i.distanceSpacing}`),n.push(`BeatDivisor:${i.beatDivisor}`),n.push(`GridSize:${i.gridSize}`),n.push(`TimelineZoom:${i.timelineZoom}`),n.join(`
`)}}class Vn{static encodeEventSection(r){const n=[];return n.push("[Events]"),n.push("//Background and Video events"),n.push(this.encodeVideos(r)),n.push(this.encodeStoryboard(r)),n.join(`
`)}static encodeVideos(r){const n=[],i=r.getLayerByType(ut.Video);return i.elements.length>0&&n.push(this.encodeStoryboardLayer(i)),n.join(`
`)}static encodeStoryboard(r){const n=[];n.push("//Storyboard Layer 0 (Background)");const i=r.getLayerByType(ut.Background);i.elements.length>0&&n.push(this.encodeStoryboardLayer(i)),n.push("//Storyboard Layer 1 (Fail)");const a=r.getLayerByType(ut.Fail);a.elements.length>0&&n.push(this.encodeStoryboardLayer(a)),n.push("//Storyboard Layer 2 (Pass)");const o=r.getLayerByType(ut.Pass);o.elements.length>0&&n.push(this.encodeStoryboardLayer(o)),n.push("//Storyboard Layer 3 (Foreground)");const l=r.getLayerByType(ut.Foreground);l.elements.length>0&&n.push(this.encodeStoryboardLayer(l)),n.push("//Storyboard Layer 4 (Overlay)");const s=r.getLayerByType(ut.Overlay);return s.elements.length>0&&n.push(this.encodeStoryboardLayer(s)),n.join(`
`)}static encodeStoryboardLayer(r){const n=[];return r.elements.forEach(i=>{let a,o,l;n.push(this.encodeStoryboardElement(i,r.name));const s=i;(a=s?.loops)===null||a===void 0||a.forEach(f=>{f.commands.length>0&&(n.push(this.encodeCompound(f)),n.push(this.encodeTimelineGroup(f,2)))}),((o=s?.timelineGroup)===null||o===void 0?void 0:o.commands.length)>0&&n.push(this.encodeTimelineGroup(s.timelineGroup)),(l=s?.triggers)===null||l===void 0||l.forEach(f=>{f.commands.length>0&&(n.push(this.encodeCompound(f)),n.push(this.encodeTimelineGroup(f,2)))})}),n.join(`
`)}static encodeStoryboardElement(r,n){return r instanceof qn?["Animation",n,$e[r.origin],`"${r.filePath}"`,r.startPosition,r.frameCount,r.frameDelay,r.loopType].join(","):r instanceof qr?["Sprite",n,$e[r.origin],`"${r.filePath}"`,r.startPosition].join(","):r instanceof Qn?["Sample",r.startTime,n,`"${r.filePath}"`,r.volume].join(","):r instanceof Jn?["Video",r.startTime,r.filePath,"0,0"].join(","):""}static encodeCompound(r,n=1){const i="".padStart(n," ");return r instanceof Xn?i+[r.type,r.loopStartTime,r.totalIterations].join(","):r instanceof Kn?i+[r.type,r.triggerName,r.triggerStartTime,r.triggerEndTime,r.groupNumber].join(","):""}static encodeTimelineGroup(r,n=1){const i="".padStart(n," "),a=[],o=r.commands;let l=!1;for(let s=0;s<o.length;++s){if(l){l=!1;continue}if(s<o.length-1){const f=o[s],v=o[s+1],S=f.type===xe.MovementX,p=v.type===xe.MovementY,E=f.easing===v.easing,m=f.startTime===v.startTime,w=f.endTime===v.endTime;if(S&&p&&(E&&m&&w)){a.push(i+this.encodeMoveCommand(f,v)),l=!0;continue}}a.push(i+this.encodeCommand(o[s]))}return a.join(`
`)}static encodeMoveCommand(r,n){const i=[xe.Movement,r.easing,r.startTime,r.startTime!==r.endTime?r.endTime:"",r.startValue,n.startValue],a=r.startValue===r.endValue,o=n.startValue===n.endValue;return(!a||!o)&&i.push(`${r.endValue},${n.endValue}`),i.join(",")}static encodeCommand(r){return[r.type,r.easing,r.startTime,r.startTime!==r.endTime?r.endTime:"",this._encodeCommandParams(r)].join(",")}static _encodeCommandParams(r){if(r.type===xe.Parameter)return r.parameter;if(r.type===xe.Color){const n=l=>`${l.red},${l.green},${l.blue}`,i=r,a=i.startValue,o=i.endValue;return this._areValuesEqual(r)?n(a):n(a)+","+n(o)}return this._areValuesEqual(r)?`${r.startValue}`:`${r.startValue},${r.endValue}`}static _areValuesEqual(r){if(r.type===xe.VectorScale){const n=r;return n.startValue.equals(n.endValue)}if(r.type===xe.Color){const n=r;return n.startValue.equals(n.endValue)}return r.startValue===r.endValue}}class oo{static encodeEventSection(r){const n=[],i=r.events;return n.push("[Events]"),n.push("//Background and Video events"),i.backgroundPath&&n.push(`0,0,"${i.backgroundPath}",0,0`),i.storyboard&&n.push(Vn.encodeVideos(i.storyboard)),n.push("//Break Periods"),i.breaks&&i.breaks.length>0&&i.breaks.forEach(a=>{n.push(`${qe[qe.Break]},${a.startTime},${a.endTime}`)}),i.storyboard&&n.push(Vn.encodeStoryboard(i.storyboard)),n.join(`
`)}}class so{static encodeGeneralSection(r){const n=["[General]"],i=r.general;return n.push(`AudioFilename:${i.audioFilename}`),n.push(`AudioLeadIn:${i.audioLeadIn}`),i.audioHash&&n.push(`AudioHash:${i.audioHash}`),n.push(`PreviewTime:${i.previewTime}`),n.push(`Countdown:${i.countdown}`),n.push(`SampleSet:${Ae[i.sampleSet]}`),n.push(`StackLeniency:${i.stackLeniency}`),n.push(`Mode:${r.mode}`),n.push(`LetterboxInBreaks:${+i.letterboxInBreaks}`),i.storyFireInFront&&n.push(`StoryFireInFront:${+i.storyFireInFront}`),n.push(`UseSkinSprites:${+i.useSkinSprites}`),i.alwaysShowPlayfield&&n.push(`AlwaysShowPlayfield:${+i.alwaysShowPlayfield}`),n.push(`OverlayPosition:${i.overlayPosition}`),n.push(`SkinPreference:${i.skinPreference}`),n.push(`EpilepsyWarning:${+i.epilepsyWarning}`),n.push(`CountdownOffset:${i.countdownOffset}`),n.push(`SpecialStyle:${+i.specialStyle}`),n.push(`WidescreenStoryboard:${+i.widescreenStoryboard}`),n.push(`SamplesMatchPlaybackRate:${+i.samplesMatchPlaybackRate}`),n.join(`
`)}}class lo{static encodeHitObjects(r){const n=["[HitObjects]"];return r.difficulty,r.hitObjects.forEach(a=>{const o=[],s=a.startPosition,f=new Me(s?s.x:256,s?s.y:192);o.push(f.toString()),o.push(a.startTime.toString()),o.push(a.hitType.toString()),o.push(a.hitSound.toString());const v=[];if(a.hitType&Oe.Slider){const _=a;v.push(this.encodePathData(_,f))}else if(a.hitType&Oe.Spinner){const _=a;v.push(this.encodeEndTimeData(_))}else if(a.hitType&Oe.Hold){const _=a;v.push(this.encodeEndTimeData(_))}const S=[],p=a.samples.find(_=>_.hitSound===Fe[Fe.Normal]),E=a.samples.find(_=>_.hitSound!==Fe[Fe.Normal]);let m=Ae.None,w=Ae.None;p&&(m=Ae[p.sampleSet]),E&&(w=Ae[E.sampleSet]),S[0]=m.toString(),S[1]=w.toString(),S[2]=a.samples[0].customIndex.toString(),S[3]=a.samples[0].volume.toString(),S[4]=a.samples[0].filename,v.push(S.join(":"));const h=o.join(","),b=a.hitType&Oe.Hold?v.join(":"):v.join(",");n.push([h,b].join(","))}),n.join(`
`)}static encodePathData(r,n){const i=[];let a;r.path.controlPoints.forEach((f,v)=>{if(f.type!==null){let S=f.type!==a||f.type===et.PerfectCurve;if(v>1){const p=n.add(r.path.controlPoints[v-1].position),E=n.add(r.path.controlPoints[v-2].position);~~p.x===~~E.x&&~~p.y===~~E.y&&(S=!0)}S?(i.push(r.path.curveType),a=f.type):i.push(`${n.x+f.position.x}:${n.y+f.position.y}`)}v!==0&&i.push(`${n.x+f.position.x}:${n.y+f.position.y}`)});const o=[];o.push(i.join("|")),o.push((r.repeats+1).toString()),o.push(r.distance.toString());const l=[],s=[];return r.nodeSamples.forEach((f,v)=>{l[v]=Fe.None,s[v]=[Ae.None,Ae.None],f.forEach((S,p)=>{p===0?s[v][0]=Ae[S.sampleSet]:(l[v]|=Fe[S.hitSound],s[v][1]=Ae[S.sampleSet])})}),o.push(l.join("|")),o.push(s.map(f=>f.join(":")).join("|")),o.join(",")}static encodeEndTimeData(r){return r.endTime.toString()}}class uo{static encodeMetadataSection(r){const n=["[Metadata]"],i=r.metadata;return n.push(`Title:${i.title}`),n.push(`TitleUnicode:${i.titleUnicode}`),n.push(`Artist:${i.artist}`),n.push(`ArtistUnicode:${i.artistUnicode}`),n.push(`Creator:${i.creator}`),n.push(`Version:${i.version}`),n.push(`Source:${i.source}`),n.push(`Tags:${i.tags.join(" ")}`),n.push(`BeatmapID:${i.beatmapId}`),n.push(`BeatmapSetID:${i.beatmapSetId}`),n.join(`
`)}}class Or{static encodeControlPoints(r){const n=["[TimingPoints]"];return r.controlPoints.groups.forEach(i=>{i.controlPoints.find(l=>l.beatLength)&&n.push(this.encodeGroup(i,!0)),n.push(this.encodeGroup(i))}),n.join(`
`)}static encodeGroup(r,n=!1){const{difficultyPoint:i,effectPoint:a,samplePoint:o,timingPoint:l}=this.updateActualPoints(r),s=r.startTime;let f=-100;i!==null&&(f/=i.sliderVelocity);let v=Ae.None,S=0,p=100;o!==null&&(v=Ae[o.sampleSet],S=o.customIndex,p=o.volume);let E=kt.None;if(a!==null){const h=a.kiai?kt.Kiai:kt.None,b=a.omitFirstBarLine?kt.OmitFirstBarLine:kt.None;E|=h|b}let m=pr.SimpleQuadruple,w=0;return n&&l!==null&&(f=l.beatLength,m=l.timeSignature,w=1),[s,f,m,v,S,p,w,E].join(",")}static updateActualPoints(r){let n=null;return r.controlPoints.forEach(i=>{i.pointType===Ve.DifficultyPoint&&!i.isRedundant(this.lastDifficultyPoint)&&(this.lastDifficultyPoint=i),i.pointType===Ve.EffectPoint&&!i.isRedundant(this.lastEffectPoint)&&(this.lastEffectPoint=i),i.pointType===Ve.SamplePoint&&!i.isRedundant(this.lastSamplePoint)&&(this.lastSamplePoint=i),i.pointType===Ve.TimingPoint&&(n=i)}),{timingPoint:n,difficultyPoint:this.lastDifficultyPoint,effectPoint:this.lastEffectPoint,samplePoint:this.lastSamplePoint}}}Or.lastDifficultyPoint=null;Or.lastEffectPoint=null;Or.lastSamplePoint=null;const co=new TextDecoder;function Zr(t){return typeof t=="string"?t:co.decode(t)}class Rr{async encodeToPath(r,n){r.endsWith(ft.Beatmap)||(r+=ft.Beatmap);try{await Ct(Ct(r),{recursive:!0}),await Ct(r,await this.encodeToString(n))}catch(i){const a=i.message||i;throw new Error(`Failed to encode a beatmap: ${a}`)}}encodeToString(r){let n;return r?.fileFormat?[`osu file format v${(n=r.fileFormat)!==null&&n!==void 0?n:Rr.FIRST_LAZER_VERSION}`,so.encodeGeneralSection(r),ao.encodeEditorSection(r),uo.encodeMetadataSection(r),io.encodeDifficultySection(r),oo.encodeEventSection(r),Or.encodeControlPoints(r),no.encodeColors(r),lo.encodeHitObjects(r)].join(`

`)+`
`:""}}Rr.FIRST_LAZER_VERSION=128;class rn{static handleLine(r,n,i){const a=r.split(",").map(f=>f.trim()),o=X.parseInt(a[3]),l=this.createHitObject(o);l.startX=X.parseInt(a[0],X.MAX_COORDINATE_VALUE),l.startY=X.parseInt(a[1],X.MAX_COORDINATE_VALUE),l.startTime=X.parseFloat(a[2])+i,l.hitType=o,l.hitSound=X.parseInt(a[4]);const s=new tn;this.addExtras(a.slice(5),l,s,i,n.fileFormat),this.addComboOffset(l,n),l.samples.length===0&&(l.samples=this.convertSoundType(l.hitSound,s)),n.hitObjects.push(l)}static addComboOffset(r,n){const i=n.originalMode===0,a=n.originalMode===2;if(!i&&!a)return;const o=r,l=Math.trunc((r.hitType&Oe.ComboOffset)>>4),s=!!(r.hitType&Oe.NewCombo);(r.hitType&Oe.Normal||r.hitType&Oe.Slider)&&(o.isNewCombo=s||this._forceNewCombo,o.comboOffset=l+this._extraComboOffset,this._forceNewCombo=!1,this._extraComboOffset=0),r.hitType&Oe.Spinner&&(this._forceNewCombo=n.fileFormat<=8||s||!1,this._extraComboOffset+=l)}static addExtras(r,n,i,a,o){if(n.hitType&Oe.Normal&&r.length>0&&this.readCustomSampleBanks(r[0],i),n.hitType&Oe.Slider)return this.addSliderExtras(r,n,i,o);if(n.hitType&Oe.Spinner)return this.addSpinnerExtras(r,n,i,a);if(n.hitType&Oe.Hold)return this.addHoldExtras(r,n,i,a)}static addSliderExtras(r,n,i,a){const o=r[0],l=n.startPosition,s=X.parseInt(r[1]);if(n.repeats>9e3)throw new Error("Repeat count is way too high");if(n.repeats=Math.max(0,s-1),n.path.controlPoints=this.convertPathString(o,l,a),n.path.curveType=n.path.controlPoints[0].type,r.length>2){const f=X.parseFloat(r[2],X.MAX_COORDINATE_VALUE);n.path.expectedDistance=Math.max(0,f)}r.length>5&&this.readCustomSampleBanks(r[5],i),n.samples=this.convertSoundType(n.hitSound,i),n.nodeSamples=this.getSliderNodeSamples(r,n,i)}static addSpinnerExtras(r,n,i,a){n.endTime=X.parseInt(r[0])+a,r.length>1&&this.readCustomSampleBanks(r[1],i)}static addHoldExtras(r,n,i,a){if(n.endTime=n.startTime,r.length>0&&r[0]){const o=r[0].split(":");n.endTime=Math.max(n.endTime,X.parseFloat(o[0]))+a,this.readCustomSampleBanks(o.slice(1).join(":"),i)}}static getSliderNodeSamples(r,n,i){const a=n.repeats+2,o=[];for(let f=0;f<a;++f)o.push(i.clone());if(r.length>4&&r[4].length>0){const f=r[4].split("|");for(let v=0;v<a&&!(v>=f.length);++v)this.readCustomSampleBanks(f[v],o[v])}const l=[];for(let f=0;f<a;++f)l.push(n.hitSound);if(r.length>3&&r[3].length>0){const f=r[3].split("|");for(let v=0;v<a&&!(v>=f.length);++v)l[v]=parseInt(f[v])||Fe.None}const s=[];for(let f=0;f<a;f++)s.push(this.convertSoundType(l[f],o[f]));return s}static convertPathString(r,n,i){const a=r.split("|").map(v=>v.trim()),o=[];let l=0,s=0,f=!0;for(;++s<a.length;){if(a[s].length>1)continue;const v=a.slice(l,s),S=s<a.length-1?a[s+1]:null,p=this.convertPoints(v,S,f,n,i);for(const E of p)o.push(...E);l=s,f=!1}if(s>l){const v=a.slice(l,s),S=this.convertPoints(v,null,f,n,i);for(const p of S)o.push(...p)}return o}static*convertPoints(r,n,i,a,o){const l=i?1:0,s=n!==null?1:0,f=[];l===1&&(f[0]=new Hr);for(let w=1;w<r.length;++w)f[l+w-1]=E(r[w],a);n!==null&&(f[f.length-1]=E(n,a));let v=this.convertPathType(r[0]);v===et.PerfectCurve&&(f.length!==3?v=et.Bezier:m(f)&&(v=et.Linear)),f[0].type=v;let S=0,p=0;for(;++p<f.length-s;){if(!f[p].position.equals(f[p-1].position))continue;const w=o<Rr.FIRST_LAZER_VERSION;v===et.Catmull&&p>1&&w||p!==f.length-s-1&&(f[p-1].type=v,yield f.slice(S,p),S=p+1)}p>S&&(yield f.slice(S,p));function E(w,h){const b=w.split(":").map(y=>Math.trunc(X.parseFloat(y,X.MAX_COORDINATE_VALUE))),_=new Me(b[0],b[1]).fsubtract(h);return new Hr(_)}function m(w){const h=(w[1].position.y-w[0].position.y)*(w[2].position.x-w[0].position.x),b=(w[1].position.x-w[0].position.x)*(w[2].position.y-w[0].position.y);return Math.abs(h-b)<.001}}static convertPathType(r){switch(r){default:case"C":return et.Catmull;case"B":return et.Bezier;case"L":return et.Linear;case"P":return et.PerfectCurve}}static readCustomSampleBanks(r,n){if(!r)return;const i=r.split(":");n.normalSet=X.parseInt(i[0]),n.additionSet=X.parseInt(i[1]),n.additionSet===Ae.None&&(n.additionSet=n.normalSet),i.length>2&&(n.customIndex=X.parseInt(i[2])),i.length>3&&(n.volume=Math.max(0,X.parseInt(i[3]))),n.filename=i.length>4?i[4]:""}static convertSoundType(r,n){if(n.filename){const a=new Gt;return a.filename=n.filename,a.volume=n.volume,[a]}const i=[new Gt];if(i[0].hitSound=Fe[Fe.Normal],i[0].sampleSet=Ae[n.normalSet],i[0].isLayered=r!==Fe.None&&!(r&Fe.Normal),r&Fe.Finish){const a=new Gt;a.hitSound=Fe[Fe.Finish],i.push(a)}if(r&Fe.Whistle){const a=new Gt;a.hitSound=Fe[Fe.Whistle],i.push(a)}if(r&Fe.Clap){const a=new Gt;a.hitSound=Fe[Fe.Clap],i.push(a)}return i.forEach((a,o)=>{a.sampleSet=o!==0?Ae[n.additionSet]:Ae[n.normalSet],a.volume=n.volume,a.customIndex=0,n.customIndex>=2&&(a.customIndex=n.customIndex)}),i}static createHitObject(r){if(r&Oe.Normal)return new eo;if(r&Oe.Slider)return new Fr;if(r&Oe.Spinner)return new ro;if(r&Oe.Hold)return new to;throw new Error(`Unknown hit object type: ${r}!`)}}rn._forceNewCombo=!1;rn._extraComboOffset=0;class fo{static handleLine(r,n){const[i,...a]=r.split(":"),o=a.join(":").trim();switch(i.trim()){case"Title":n.metadata.title=o;break;case"TitleUnicode":n.metadata.titleUnicode=o;break;case"Artist":n.metadata.artist=o;break;case"ArtistUnicode":n.metadata.artistUnicode=o;break;case"Creator":n.metadata.creator=o;break;case"Version":n.metadata.version=o;break;case"Source":n.metadata.source=o;break;case"Tags":n.metadata.tags=o.split(" ");break;case"BeatmapID":n.metadata.beatmapId=X.parseInt(o);break;case"BeatmapSetID":n.metadata.beatmapSetId=X.parseInt(o)}}}class _r{static handleLine(r,n,i){this.controlPoints=n.controlPoints;const a=r.split(",");let o=pr.SimpleQuadruple,l=Ae[Ae.None],s=0,f=100,v=!0,S=kt.None;if(a.length>2)switch(a.length){default:case 8:S=X.parseInt(a[7]);case 7:v=a[6]==="1";case 6:f=X.parseInt(a[5]);case 5:s=X.parseInt(a[4]);case 4:l=Ae[X.parseInt(a[3])];case 3:o=X.parseInt(a[2])}if(o<1)throw new Error("The numerator of a time signature must be positive.");const p=X.parseFloat(a[0])+i,E=X.parseFloat(a[1],X.MAX_PARSE_VALUE,!0);let m=1,w=1;if(E<0&&(w=100/-E,m=Math.min(Math.fround(-E),1e4),m=Math.max(10,m)/100),v&&Number.isNaN(E))throw new Error("Beat length cannot be NaN in a timing control point");if(v){const y=new nr;y.beatLength=E,y.timeSignature=o,this.addControlPoint(y,p,!0)}const h=new er;h.bpmMultiplier=m,h.sliderVelocity=w,h.generateTicks=!Number.isNaN(E),h.isLegacy=!0,this.addControlPoint(h,p,v);const b=new tr;b.kiai=(S&kt.Kiai)>0,b.omitFirstBarLine=(S&kt.OmitFirstBarLine)>0,(n.originalMode===1||n.originalMode===3)&&(b.scrollSpeed=w),this.addControlPoint(b,p,v);const _=new rr;_.sampleSet=l,_.customIndex=s,_.volume=f,this.addControlPoint(_,p,v)}static addControlPoint(r,n,i){n!==this.pendingTime&&this.flushPendingPoints(),i?this.pendingPoints.unshift(r):this.pendingPoints.push(r),this.pendingTime=n}static flushPendingPoints(){const r=this.pendingTime,n=this.pendingPoints,i=this.controlPoints,a=this.pendingTypes;let o=n.length;for(;--o>=0;)a.includes(n[o].pointType)||(a.push(n[o].pointType),i.add(n[o],r));this.pendingPoints=[],this.pendingTypes=[]}}_r.pendingTime=0;_r.pendingTypes=[];_r.pendingPoints=[];class ho{static handleLine(r,n){const[i,...a]=r.split(":").map(l=>l.trim()),o=a.join(" ");switch(i){case"UseSkinSprites":n.useSkinSprites=o==="1"}}}class jn{static handleLine(r,n){if(!r.startsWith("$"))return;const i=r.split("=");i.length===2&&n.set(i[0],i[1].trimEnd())}static decodeVariables(r,n){return!r.includes("$")||!n.size||n.forEach((i,a)=>{r=r.replace(a,i)}),r}}class mo{async _getFileBuffer(r){try{await Ct(r)}catch{throw new Error("File doesn't exist!")}try{return await Ct(r)}catch{throw new Error("File can't be read!")}}async _getFileUpdateDate(r){try{return(await Ct(r)).mtime}catch{throw new Error("Failed to get last file update date!")}}}class po extends Map{constructor(){super(...arguments),this.currentSection=null}get(r){let n;return(n=super.get(r))!==null&&n!==void 0?n:!1}set(r,n=!0){return super.set(r,n)}reset(){return this.forEach((r,n,i)=>{i.set(n,!0)}),this.currentSection=null,this}get hasEnabledSections(){for(const r of this.values())if(r)return!0;return!1}get isSectionEnabled(){return this.currentSection?this.get(this.currentSection):!1}}class ri extends mo{constructor(){super(...arguments),this._lines=null,this._foundFirstNonEmptyLine=!1,this._sectionMap=new po}_getLines(r){let n=null;if(r.constructor===Array&&(n=r),!n||!n.length)throw new Error("Data not found!");return n}_parseLine(r,n){if(!this._foundFirstNonEmptyLine&&r.includes("osu file format v")){const i=r.trim();try{return i.startsWith("osu file format v")&&(n.fileFormat=X.parseInt(i.split("v")[1])),gt.FileFormat}catch{throw new Error("Wrong file format version!")}}if(!this._foundFirstNonEmptyLine&&!this._isEmptyLine(r)&&(this._foundFirstNonEmptyLine=!0),this._shouldSkipLine(r))return gt.Empty;if(r=this._preprocessLine(r),r.startsWith("[")&&r.endsWith("]")){const i=r.slice(1,-1);return this._sectionMap.currentSection&&(this._sectionMap.set(this._sectionMap.currentSection,!1),this._sectionMap.currentSection=null),this._sectionMap.hasEnabledSections?(i in De&&(this._sectionMap.currentSection=i),gt.Section):gt.Break}if(!this._sectionMap.isSectionEnabled)return gt.Empty;try{return this._parseSectionData(r,n),gt.Data}catch{return gt.Empty}}_parseSectionData(r,n){const i=n;this._sectionMap.currentSection===De.Colours&&i?.colors&&qa.handleLine(r,i)}_preprocessLine(r){return this._sectionMap.currentSection!==De.Metadata&&(r=this._stripComments(r)),r.trimEnd()}_shouldSkipLine(r){return this._isEmptyLine(r)||r.startsWith("//")}_isEmptyLine(r){return typeof r!="string"||!r}_stripComments(r){const n=r.indexOf("//");return n>0?r.substring(0,n):r}_reset(){this._sectionMap.reset(),this._lines=null,this._foundFirstNonEmptyLine=!1}_setEnabledSections(r){this._sectionMap.set(De.Colours,r?.parseColours)}}class _o extends ri{constructor(){super(...arguments),this._variables=new Map}async decodeFromPath(r,n){if(!r.endsWith(ft.Beatmap)&&!r.endsWith(ft.Storyboard))throw new Error(`Wrong format of the first file! Only ${ft.Beatmap} and ${ft.Storyboard} files are supported!`);if(typeof n=="string"&&!n.endsWith(ft.Storyboard))throw new Error(`Wrong format of the second file! Only ${ft.Storyboard} files are supported as a second argument!`);try{const i=await this._getFileBuffer(r),a=typeof n=="string"?await this._getFileBuffer(r):void 0;return this.decodeFromBuffer(i,a)}catch(i){const a=i.message||i;throw new Error(`Failed to decode a storyboard: '${a}'`)}}decodeFromBuffer(r,n){const i=Zr(r),a=n?Zr(n):void 0;return this.decodeFromString(i,a)}decodeFromString(r,n){typeof r!="string"&&(r=String(r)),typeof n!="string"&&typeof n<"u"&&(n=String(n));const i=r.split(/\r?\n/),a=n?.split(/\r?\n/);return this.decodeFromLines(i,a)}decodeFromLines(r,n){const i=new Va;this._reset(),this._setEnabledSections(),this._lines=[...this._getLines(r),...n?this._getLines(n):[]];for(let a=0;a<this._lines.length&&this._parseLine(this._lines[a],i)!==gt.Break;++a);return i.variables=this._variables,i}_parseSectionData(r,n){switch(this._sectionMap.currentSection){case De.General:return ho.handleLine(r,n);case De.Events:return ti.handleLine(r,n);case De.Variables:return jn.handleLine(r,this._variables)}super._parseSectionData(r,n)}_setEnabledSections(){super._setEnabledSections(),this._sectionMap.set(De.General),this._sectionMap.set(De.Variables),this._sectionMap.set(De.Events)}_preprocessLine(r){return r=jn.decodeVariables(r,this._variables),super._preprocessLine(r)}_reset(){super._reset(),this._sectionMap.currentSection=De.Events}}class ni extends ri{constructor(){super(...arguments),this._offset=0,this._sbLines=null}async decodeFromPath(r,n){if(!r.endsWith(ft.Beatmap))throw new Error(`Wrong file format! Only ${ft.Beatmap} files are supported!`);try{const i=await this._getFileBuffer(r),a=this.decodeFromBuffer(i,n);return a.fileUpdateDate=await this._getFileUpdateDate(r),a}catch(i){const a=i.message||i;throw new Error(`Failed to decode a beatmap: ${a}`)}}decodeFromBuffer(r,n){return this.decodeFromString(Zr(r),n)}decodeFromString(r,n){return r=typeof r!="string"?String(r):r,this.decodeFromLines(r.split(/\r?\n/),n)}decodeFromLines(r,n){const i=new Ya;this._reset(),this._lines=this._getLines(r),this._setEnabledSections(typeof n!="boolean"?n:{}),this._sbLines=this._shouldParseStoryboard(n)?[]:null;for(let a=0;a<this._lines.length&&this._parseLine(this._lines[a],i)!==gt.Break;++a);_r.flushPendingPoints();for(let a=0;a<i.hitObjects.length;++a)i.hitObjects[a].applyDefaults(i.controlPoints,i.difficulty);if(i.hitObjects.sort((a,o)=>a.startTime-o.startTime),this._sbLines&&this._sbLines.length){const a=new _o;i.events.storyboard=a.decodeFromLines(this._sbLines),i.events.storyboard.useSkinSprites=i.general.useSkinSprites,i.events.storyboard.colors=i.colors,i.events.storyboard.fileFormat=i.fileFormat}return i}_parseSectionData(r,n){switch(this._sectionMap.currentSection){case De.General:return $a.handleLine(r,n,this._offset);case De.Editor:return Ja.handleLine(r,n);case De.Metadata:return fo.handleLine(r,n);case De.Difficulty:return Qa.handleLine(r,n);case De.Events:return Ca.handleLine(r,n,this._sbLines,this._offset);case De.TimingPoints:return _r.handleLine(r,n,this._offset);case De.HitObjects:return rn.handleLine(r,n,this._offset)}super._parseSectionData(r,n)}_setEnabledSections(r){super._setEnabledSections(r),this._sectionMap.set(De.General,r?.parseGeneral),this._sectionMap.set(De.Editor,r?.parseEditor),this._sectionMap.set(De.Metadata,r?.parseMetadata),this._sectionMap.set(De.Difficulty,r?.parseDifficulty),this._sectionMap.set(De.Events,r?.parseEvents),this._sectionMap.set(De.TimingPoints,r?.parseTimingPoints),this._sectionMap.set(De.HitObjects,r?.parseHitObjects)}_shouldParseStoryboard(r){let n,i;const a=r,o=(n=a?.parseStoryboard)!==null&&n!==void 0?n:r,l=typeof o=="boolean"?o:!0;return((i=a?.parseEvents)!==null&&i!==void 0?i:!0)&&l}}ni.EARLY_VERSION_TIMING_OFFSET=24;var go=jt("<audio class=w-full controls>"),vo=jt('<div class="flex flex-col gap-2">'),bo=jt('<div class="flex flex-col gap-2"><div>Add beatmaps:</div><input type=file accept=.osz>'),wo=jt("<div>"),So=jt("<div><i>No mania difficulties"),ko=jt("<div>'s "),Po=jt('<div class="opacity-60 text-sm">');const Eo=new Set,Bo={dockPanel(){const{state:t,setState:r}=xn(In),n=()=>t().modes.tap_mania;return yt(Yi,{vertical:!0,get children(){return yt(Zi,{get dr_tools_active(){return n().editing_define_rect??!1},setDrToolsActive:i=>{n().editing_define_rect=i?!0:void 0,r()}})}})},sidePanel(t){const{state:r,setState:n}=xn(In),i=()=>r().modes.tap_mania,a=Gi(()=>i().loaded_map?.difficulty_ref),o=Vi(()=>i().loaded_map?.difficulty_ref.audio_url??"");return yt(ea,{collapsible:"tap!mania",get children(){return[yt(Tn,{get when(){return i().loaded_map!=null},get children(){var l=go();return Xi(s=>{i().audio_el=s,Ki(()=>{i().audio_el==s&&(i().audio_el=void 0)})},l),qi(()=>Qi(l,"src",o())),l}}),yt(Tn,{get when(){return!!i().loaded_sets?.length},get children(){var l=vo();return dr(l,yt(Ln,{get each(){return i().loaded_sets??[]},children:s=>[(()=>{var f=wo();return dr(f,()=>s.title),f})(),yt(Ln,{get each(){return s.difficulties},get fallback(){return So()},children:f=>yt(Ji,{get active(){return a(f)},onclick:()=>{i().loaded_map?.difficulty_ref==f?(i().loaded_map=void 0,n()):(i().loaded_map={difficulty_ref:f},n())},get children(){return[(()=>{var v=ko(),S=v.firstChild;return dr(v,()=>f.mapauthor,S),dr(v,()=>f.title,null),v})(),(()=>{var v=Po();return dr(v,()=>f.subtitle),v})()]}})})]})),l}}),(()=>{var l=bo(),s=l.firstChild,f=s.nextSibling;return f.addEventListener("change",v=>{const S=v.currentTarget,p=S.files;if(p==null||p.length!==1)return;const E=p[0];(async()=>{const m=await E.arrayBuffer(),h=(await ra.loadAsync(m)).files,b=Object.values(h).filter(A=>A.name.endsWith(".osu")),_=new ni;let y=new Map,T=[];for(const A of b){const H=await A.async("uint8array"),U=_.decodeFromBuffer(H,{parseGeneral:!0,parseEditor:!1,parseMetadata:!0,parseDifficulty:!1,parseEvents:!1,parseTimingPoints:!1,parseHitObjects:!0,parseStoryboard:!1,parseColours:!1});if(U.mode!==3)continue;const K=U.general.audioFilename;let R=y.get(K);if(R==null){const Q=h[K];if(Q==null)R="ERROR";else{const ae=await Q.async("blob");R=URL.createObjectURL(ae),y.set(K,R),Eo.add(R)}}U.hitObjects,T.push({title:U.metadata.version,subtitle:U.metadata.artistUnicode+" - "+U.metadata.titleUnicode,mapauthor:U.metadata.creator,hitobjects:U.hitObjects.map(Q=>[Q.startTime,Q.startX]).sort((Q,ae)=>Q[0]-ae[0]),audio_url:R})}(i().loaded_sets??=[]).push({title:E.name,difficulties:T}),n()})().catch(Ci).finally(()=>{S.files===p&&(S.value="")})}),l})(),yt($i,{})]}})},render({state:t,imev:r,frame:n}){const{ctx:i}=r,a=t.modes.tap_mania,o=ji(t,n,r,{enable_resize:a.editing_define_rect??!1}),l={before_time:1e3,after_time:100};if(a.loaded_map!=null&&a.audio_el!=null){const s=a.audio_el.currentTime*1e3,f=s-l.after_time,v=s,S=s+l.before_time,p=l.before_time+l.after_time,E=Wn(a.loaded_map.difficulty_ref.hitobjects,b=>b[0],f,S),m=b=>1-(b-f)/p,w=o([0,m(v)]),h=o([1,m(v)]);i.beginPath(),i.moveTo(...w),i.lineTo(...h),i.stroke();for(const[b,_]of E){const y=m(b),T=o([_/512,y]),D=10/n.scale;b<v?i.globalAlpha=.3:i.globalAlpha=1,i.fillRect(...Wi.add(T,[-D/2,-D/2]),D,D)}i.globalAlpha=1}},previewer(t){const r=Mn(t),n=([o,l])=>Hi(t.define_rect,{grid:r},[o,l]),i={before_time:1e3,after_time:100},a=t.modes.tap_mania;if(a.loaded_map!=null&&a.audio_el!=null){const o=a.audio_el.currentTime*1e3,l=o-i.after_time,s=o+i.before_time,f=i.before_time+i.after_time,v=Wn(a.loaded_map.difficulty_ref.hitobjects,E=>E[0],l,s),S=E=>1-(E-l)/f,p=[];for(const[E,m]of v){const w=S(E),h=n([m/512,w]),b=Mn(t).targetPt(h);b!=null&&p.push(b)}return p.flatMap(E=>[E,{delay_ms:100}])}return[]}};function Wn(t,r,n,i){const a=[];let o=0,l=t.length-1;for(;o<=l;){const s=Math.floor((o+l)/2);r(t[s])<n?o=s+1:l=s-1}for(;o<t.length&&r(t[o])<=i;)a.push(t[o]),o++;return a}export{Bo as default};
