import{e as B,b as P,v as n,N as A,aw as L,Z as S,ax as N,a7 as V,a1 as Z,a4 as E,G as F}from"./index-AM_KDpRB.js";var H=F("<div>Delay After");const W=.06,J={config:{supports_line_thickness:!0,npe:!0,override_grid:"Glove v12c",force_hand_preview:!0,requires_device:!0},sidePanel(){const{state:t,setState:s}=B(S),e=()=>t().modes.find_hidden;return P(E,{collapsible:"Find Hidden",get children(){return[P(N,{get children(){return[H(),P(V,{unit:"ms",decimals:0,step:1,min:0,max:1e5,get value(){return e().delay_after_ms},setValue:d=>{e().delay_after_ms=d,s()}})]}}),P(Z,{onClick:()=>{e().sequence=[],e().game_state=void 0,s()},label:"Restart Game",icon:"restart_alt"})]}})},onDeactivate(t){const s=t.modes.find_hidden;s.sequence=[],s.game_state=void 0},renderCamera({state:t,setState:s,ctx:e,size:d,hand_center:f,hand_mirrored:h,hand_rotation:o}){const c=t.modes.find_hidden;d[0]!==0&&d[1]!==0&&(c.game_info??={hand_center:f,hand_mirrored:h,hand_rotation:o,size:d,ctx:e},c.game_info.hand_center=f,c.game_info.ctx=e,c.game_info.hand_mirrored=h,c.game_info.hand_rotation=o,c.game_state??=$(t,s,c.game_info),c.game_state.next())},sequencer:function*(t,s){const e=t.modes.find_hidden,d=e.sequence;e.sequence=[];for(const f of d)yield f}};function D(t,s,e){return t*(e-s)+s}function*$(t,s,e){const d=t.modes.find_hidden;function f(){const v=[i,i],y=n.sub(e.size,[i,i]);if(_=[D(Math.random(),v[0],y[0]),D(Math.random(),v[1],y[1])],g>5){const a=g-5-1,l=Math.random()*Math.PI*2;r=n.rotateRad([a/250*h,0],l)}i*=.99,x*=.999,C=Math.max(0,1-g/10),g+=1;const b=[],M=A(t);let u=[1/0,1/0],p=[-1/0,-1/0];for(let a=0;a<M.max_pts;a++){const l=M.ptCenter(a);b.push({pos:l,index:a}),u=[Math.min(u[0],l[0]),Math.min(u[1],l[1])],p=[Math.max(p[0],l[0]),Math.max(p[1],l[1])]}let m=n.add(u,n.div(n.sub(p,u),[2,2]));const z=n.sub(p,u);m=n.add(m,n.mul(n.rotateRad([c[0]*(e.hand_mirrored?-1:1),c[1]],e.hand_rotation*(e.hand_mirrored?1:-1)),n.div(z,[2,2]))),b.sort((a,l)=>{const w=Math.atan2(a.pos[1]-m[1],a.pos[0]-m[0]),R=Math.atan2(l.pos[1]-m[1],l.pos[0]-m[0]);return w-R});const k=b.flatMap((a,l,w)=>[a.index,{delay_ms:1/w.length*200}]),q=[];for(const a of k)q.push(a);d.sequence.push(q),t.play=!1,s(),t.play=!0,t.repeat=!1,s()}const h=Math.min(e.size[0],e.size[1]),o=e.ctx;let c=[0,0],i=W*h,x=i*2,_=n.div(e.size,[2,2]),r=[0,0],g=1,C=1,G=Date.now();for(;;){yield;let v=Date.now();const y=(v-G)/1e3;if(G=v,e.hand_center!=null&&(o.strokeStyle="red",o.lineWidth=h/100,o.beginPath(),o.arc(...e.hand_center,x,0,2*Math.PI),o.stroke()),o.fillStyle="red",o.beginPath(),o.arc(..._,i,0,2*Math.PI),o.globalAlpha=C,o.fill(),o.globalAlpha=1,e.hand_center!=null){const I=n.distance(e.hand_center,_),b=n.normalize(n.sub(_,e.hand_center));c=b,I<i+x&&f();const M=[.5,.5],u=n.rotateRad(n.mul(b,[e.hand_mirrored?-1:1,1]),e.hand_rotation*(e.hand_mirrored?1:-1)),p=n.add(M,n.mul(u,[-1,-1])),m=n.add(M,u),z=Math.min(1,Math.max(0,I-(i+x))/h),k={points:[{pos:p,next_control_offset:[0,0],prev_control_offset:[0,0]},{pos:m,next_control_offset:[0,0],prev_control_offset:[0,0]}],duration:z*.2+.1,easing_function:"ease_in"};if(t.play===!1){A(t);const q=L(t,k,A(t).define_rect_scaler),a=[];for(const l of q)a.push(l);a.length>0&&(d.sequence.push(a),d.delay_after_ms>0&&d.sequence.push({delay:d.delay_after_ms})),t.play=!1,s(),t.play=!0,t.repeat=!1,s()}}_[0]<i&&(r=[Math.abs(r[0]),r[1]]),_[1]<i&&(r=[r[0],Math.abs(r[1])]),_[0]>e.size[0]-i&&(r=[-Math.abs(r[0]),r[1]]),_[1]>e.size[1]-i&&(r=[r[0],-Math.abs(r[1])]),_=n.add(_,n.mul(r,[y,y]))}}export{J as default};
